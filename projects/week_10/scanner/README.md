# 01_xss_scanner.py

이 코드는 **웹 애플리케이션의 XSS(교차 사이트 스크립팅) 취약점을 소스 코드 분석과 실제 공격 시뮬레이션으로 점검하는 하이브리드 스캐너**입니다.

이 코드의 역할은 다음과 같습니다.

1. **정적 분석 (Whitebox):** HTML 파일 내에서 XSS 취약 태그(`th:utext`)나 인라인 표현식을 찾아냅니다.
2. **공격 시뮬레이션 (Blackbox):** 게시판(Stored), 검색창(Reflected), DOM 영역에 실제 스크립트를 주입하여 공격 성공 여부를 테스트합니다.
3. **보안 설정 점검:** 브라우저 보안 헤더인 CSP(Content-Security-Policy)가 설정되어 있는지 확인합니다.
4. **결과 리포팅:** 발견된 취약점 유형에 따라 HTML 이스케이프 처리나 CSP 설정 같은 대응 방안을 제시합니다.

# 02_sqli_scanner.py

이 코드는 **웹 애플리케이션의 SQL Injection(SQL 삽입) 취약점을 소스 코드 분석과 실제 쿼리 주입으로 점검하는 하이브리드 스캐너**입니다.

이 코드의 역할은 다음과 같습니다.

1. **MyBatis 매퍼 분석 (Whitebox):** XML 파일 내 SQL 쿼리에서 입력값을 직접 문자열로 치환하는 위험한 패턴(`${}`)을 찾아냅니다.
2. **로그인 우회 시도 (Blackbox):** 로그인 폼에 `OR '1'='1`과 같은 우회 패턴을 주입하여 비밀번호 없이 로그인이 가능한지 확인합니다.
3. **데이터 및 에러 유발 (Blackbox):** 검색어와 URL 파라미터에 SQL 특수문자를 주입하여 DB 에러가 노출되거나 쿼리가 조작되는지 검사합니다.
4. **대응 방안 제시:** 취약점이 발견되면 PreparedStatement(`#{}`) 사용이나 에러 메시지 숨김 처리를 권고합니다.

# 03_os_command_injection_scanner.py

이 코드는 **웹 애플리케이션의 OS Command Injection(운영체제 명령어 삽입) 취약점을 소스 코드 분석과 동적 테스트를 통해 점검하는 하이브리드 스캐너**입니다.

이 코드의 역할은 다음과 같습니다.

1. **명령어 실행 코드 분석 (Whitebox):** 자바 소스 코드에서 `Runtime.exec()`, `ProcessBuilder` 등 시스템 명령어 실행 함수에 사용자 입력이 필터링 없이 연결되는 위험한 패턴을 찾아냅니다.
2. **명령어 인젝션 테스트 (Blackbox):** `/admin/system/ping` 같은 엔드포인트에 Windows(`127.0.0.1 & ipconfig`) 및 Linux(`127.0.0.1 | ifconfig`) 명령어 인젝션 페이로드를 전송하여, 시스템 명령어가 실행되는지 확인합니다.
3. **Blind Injection 진단 (Blackbox):** `sleep 5`, `timeout 5` 같은 시간 지연 명령어를 주입하여, 응답 시간 차이를 통해 명령어 실행 여부를 간접적으로 확인합니다.
4. **대응 방안 제시:** 취약점 발견 시 Runtime.exec() 사용 금지, 사용자 입력 화이트리스트 검증, 명령어 하드코딩 등의 보안 조치를 권고합니다.



# 04_csrf_scanner.py

이 코드는 **웹 애플리케이션의 CSRF(크로스 사이트 요청 위조) 취약점을 동적 테스트를 통해 점검하는 스캐너**입니다.

이 코드의 역할은 다음과 같습니다.

1. **CSRF 토큰 발급 확인:** 회원 정보 수정이나 글쓰기 같은 중요한 폼 페이지에서 난수화된 보안 토큰(`_csrf`)이 정상적으로 발급되고 있는지 확인합니다.
2. **비정상 요청 테스트:** 보안 토큰 없이 중요한 정보를 수정하는 POST 요청을 강제로 전송하여, 서버가 이를 차단하는지 테스트합니다.
3. **SameSite 쿠키 점검:** 쿠키 설정에 외부 사이트의 요청을 제한하는 `SameSite` 속성이 적용되어 있는지 검사합니다.
4. **대응 방안 제시:** 취약점이 발견되면 CSRF 토큰 활성화나 쿠키 속성 강화(Strict/Lax) 등의 보안 조치를 권고합니다.

# 05_password_policy_scanner.py

이 코드는 **웹 애플리케이션의 인증 정책이 취약한지 확인하기 위해 약한 비밀번호 사용과 무차별 대입 공격(Brute Force)을 테스트하는 스캐너**입니다.

이 코드의 역할은 다음과 같습니다.

1. **약한 비밀번호 허용 테스트:** 회원가입 페이지를 찾아 '1234', 'password' 같은 단순한 비밀번호로 가입이 성공하는지 점검합니다.
2. **무차별 대입 방어 테스트:** 로그인 페이지에 반복적인 실패 요청을 보냈을 때, 서버가 이를 차단(Rate Limiting)하거나 계정을 잠그는지 확인합니다.
3. **대응 방안 제시:** 취약점이 발견되면 비밀번호 복잡도 강제 설정이나 로그인 시도 횟수 제한 기능을 권고합니다.

# 06_access_control_scanner.py

이 코드는 **웹 애플리케이션의 인증(Authentication) 및 인가(Authorization) 취약점을 통합적으로 점검하는 하이브리드 스캐너**입니다.

이 코드의 역할은 다음과 같습니다.

1. **인증 우회 진단:**
* **Whitebox:** 로그인 처리 쿼리 내 SQL Injection 패턴 검사 및 컨트롤러의 세션 체크 로직 누락을 확인합니다.
* **Blackbox:** 실제 SQL Injection 구문으로 로그인 시도 및 비로그인 상태로 보호된 페이지 접근 가능 여부를 테스트합니다.


2. **권한 상승 진단 (Privilege Escalation):**
* **수직적 권한 상승:** 일반 사용자 계정으로 관리자 페이지(`/admin/*`)에 접근할 수 있는지 확인합니다.
* **수평적 권한 상승:** 본인 계정으로 다른 사용자의 데이터(예: 리포트)를 조회할 수 있는지 확인합니다.


3. **IDOR (부적절한 직접 객체 참조) 진단:** URL 파라미터의 ID 값(예: `id=1`)을 변조하여 타인의 게시글이나 정보를 열람할 수 있는지 테스트합니다.
4. **대응 방안 제시:** 취약점 발견 시 Spring Security 적용, 세션 검증 로직 추가, 객체 소유권 확인 등의 보안 조치를 권고합니다.

# 07_password_reset_scanner.py

이 코드는 **웹 애플리케이션의 비밀번호 복구 절차의 보안성을 점검하는 하이브리드 스캐너** 입니다.

이 코드의 역할은 다음과 같습니다.

1. **보안 토큰 코드 분석 (Whitebox)**
소스 코드에서 UUID나 SecureRandom 같은 안전한 난수 생성기와 만료 시간 설정이 있는지 확인합니다.

2. **복구 기능 탐지 (Blackbox)**
/password/reset 등 흔한 경로를 스캔하여 비밀번호 찾기 페이지가 존재하는지 파악합니다.

3. **토큰 검증 여부 확인 (Blackbox)**
복구 페이지에 인증 토큰이나 코드 입력란이 존재하는지 검사하여, 단순 정보만으로 재설정이 가능한지 테스트합니다.

4. **보안 질문 우회 시도 (Blackbox)**
 취약한 보안 질문(예: 정답이 아이디와 동일)을 통해 재설정 프로세스를 우회할 수 있는지 점검합니다.

# 08_session_management_scanner.py

이 코드는 **웹 애플리케이션의 세션 관리 메커니즘이 안전하게 구현되었는지 점검하는 하이브리드 스캐너**입니다.

이 코드의 역할은 다음과 같습니다.

1. **세션 설정 검사 (Whitebox):** 설정 파일(`application.properties`)을 분석하여 세션 타임아웃이 너무 길게 설정되어 있지 않은지 확인합니다.
2. **로그아웃 기능 검증 (Blackbox):** 로그아웃을 수행한 뒤, 기존 세션 쿠키를 이용해 다시 로그인된 페이지에 접근할 수 있는지(세션 무효화 여부) 테스트합니다.
3. **세션 고정 공격 진단 (Blackbox):** 로그인 전과 후의 세션 ID가 동일하게 유지되는지 확인하여, 공격자가 세션을 가로챌 수 있는 '세션 고정(Session Fixation)' 취약점을 점검합니다.
4. **쿠키 보안 플래그 확인 (Blackbox):** 발급된 세션 쿠키에 자바스크립트 접근을 막는 `HttpOnly` 속성 등이 올바르게 설정되어 있는지 검사합니다.


# 09_cookie_tampering_scanner.py

이 코드는 **웹 애플리케이션의 쿠키 보안 설정 미흡 및 값 변조 취약점을 점검하는 하이브리드 스캐너**입니다.

이 코드의 역할은 다음과 같습니다.

1. **쿠키 보안 설정 점검 (Whitebox):** 설정 파일(`application.properties`)을 분석하여 `HttpOnly`, `Secure`, `SameSite` 등 필수 보안 플래그가 누락되었는지 확인합니다.
2. **권한 검증 로직 점검 (Whitebox):** 자바 컨트롤러 파일에서 쿠키 값을 읽어 권한을 처리할 때, 암호화나 서명(HMAC) 없이 그대로 신뢰하는 취약한 패턴을 찾아냅니다.
3. **쿠키 변조 공격 (Blackbox):** 일반 사용자로 로그인한 뒤, `role` 쿠키 값을 `admin` 등으로 변조하여 관리자 페이지에 접근할 수 있는지 테스트합니다.
4. **대응 방안 제시:** 취약점 발견 시 쿠키 서명 적용, 세션 기반 인증 전환, 보안 플래그 활성화 등의 조치를 권고합니다.

# 10_file_transfer_scanner.py

이 코드는 **웹 애플리케이션의 파일 업로드 및 다운로드 기능에서 발생하는 취약점을 블랙박스 테스트로 점검하는 스캐너**입니다.

이 코드의 역할은 다음과 같습니다.

1. **악성 파일 업로드 진단:** 파일 업로드 폼을 식별하고, `.jsp`, `.php`, `.exe` 등 실행 가능한 확장자를 가진 파일을 전송하여 서버가 이를 차단하지 않고 저장하는지 확인합니다.
2. **비인가 다운로드 진단:** 로그인 세션 없이 다운로드 URL에 접근했을 때 파일이 다운로드되는지 확인하여 접근 제어 미흡 여부를 점검합니다.
3. **경로 조작(Path Traversal) 진단:** 다운로드 파라미터(path, filename 등)에 `../../etc/passwd`와 같은 경로 조작 패턴을 주입하여, 시스템 중요 파일이나 설정 파일(`application.yml`)이 유출되는지 테스트합니다.
4. **대응 방안 제시:** 취약점 발견 시 확장자 화이트리스트 적용, 파일명 난수화, 다운로드 경로 고정 및 인증 강제 등의 보안 조치를 권고합니다.

# 11_path_traversal_scanner.py

이 코드는 **웹 애플리케이션의 파일 경로 처리 미흡으로 인한 경로 조작(Directory Traversal) 취약점을 점검하는 하이브리드 스캐너**입니다.

이 코드의 역할은 다음과 같습니다.

1. **경로 처리 로직 분석 (Whitebox):** 자바 소스 코드에서 파일 입출력을 수행할 때, 입력된 경로를 정규화(`normalize`)하거나 상위 경로(`..`) 이동을 차단하는 검증 로직이 있는지 확인합니다.
2. **시스템 파일 접근 (Blackbox):** 다운로드 기능 등에 `../../../etc/passwd`와 같은 페이로드를 전송하여 시스템 중요 파일이 유출되는지 테스트합니다.
3. **설정 파일 접근 (Blackbox):** `application.properties` 같은 설정 파일을 경로 조작을 통해 읽을 수 있는지 확인합니다.
4. **디렉토리 탈출 (Blackbox):** 지정된 업로드/다운로드 폴더를 벗어나 상위 디렉토리의 파일 목록이나 내용을 열람할 수 있는지 점검합니다.

# 12_error_page_scanner.py

이 코드는 **웹 애플리케이션의 에러 처리 미흡 및 불필요한 정보 노출 여부를 점검하는 블랙박스 스캐너**입니다.

이 코드의 역할은 다음과 같습니다.

1. **Soft-404 탐지:** 존재하지 않는 페이지(예: `/this_should_404`)를 요청했을 때, 404 코드가 아닌 **200 OK**를 반환하거나 메인 페이지로 단순히 리다이렉트하는지 확인합니다.
2. **정보 노출(Information Leakage) 탐지:** 에러 발생 시 서버의 내부 정보(Java Stack Trace, Tomcat 버전, SQL 에러 등)가 사용자 화면에 그대로 노출되는지 검사합니다.
3. **대응 방안 제시:** 취약점 발견 시 **커스텀 에러 페이지(Custom Error Page)** 적용과 올바른 HTTP 상태 코드(404, 500) 반환 설정을 권고합니다.

# 13_format_string_scanner.py

이 코드는 **웹 애플리케이션에서 발생하는 Format String(포맷 스트링) 취약점을 점검하는 하이브리드 스캐너**입니다.

이 코드의 역할은 다음과 같습니다.

1. **소스 코드 분석 (Whitebox):** 자바 코드 내에서 `String.format` 메서드를 사용할 때, 포맷 문자열(첫 번째 인자)에 사용자 입력을 `+` 연산자로 연결하는 위험한 패턴을 찾아냅니다.
2. **인젝션 테스트 (Blackbox):** 입력 필드에 `%s`, `%2$s` 같은 포맷 지정자를 주입하여, 서버가 이를 단순 문자열이 아닌 명령어로 해석하고 실행하는지 확인합니다.
3. **정보 유출 진단 (Blackbox):** 포맷 스트링 공격을 통해 메모리 스택에 있는 민감한 정보(API Key, Secret 등)를 끄집어낼 수 있는지 테스트합니다.
4. **대응 방안 제시:** 취약점 발견 시 포맷 문자열을 상수로 고정하거나, 불필요한 민감 정보 출력을 제거하도록 권고합니다.

# 14_http_method_scanner.py

이 코드는 **웹 서버에서 불필요하거나 위험한 HTTP Method가 활성화되어 있는지 점검하는 블랙박스 스캐너**입니다.

이 코드의 역할은 다음과 같습니다.

1. **XST 취약점 진단:** `TRACE` 메서드 요청 시 200 OK가 반환되는지 확인하여, 쿠키 탈취 공격인 **Cross-Site Tracing(XST)** 가능성을 점검합니다.
2. **리소스 조작 진단:** `PUT`, `DELETE`, `PATCH` 등 파일 업로드나 삭제가 가능한 메서드가 인증 없이 허용되는지(2xx 응답) 테스트합니다.
3. **서버 정보 노출 확인:** `OPTIONS` 메서드를 통해 서버가 지원하는 메서드 목록(`Allow` 헤더)을 노출하고 있는지 확인합니다.
4. **대응 방안 제시:** 취약점 발견 시 웹 서버(Apache, Nginx, Tomcat 등) 설정에서 불필요한 메서드를 비활성화하도록 권고합니다.

# 15_ssrf_scanner.py

이 코드는 **웹 애플리케이션의 SSRF(서버 사이드 요청 위조) 및 OS Command Injection 취약점을 통합적으로 점검하는 하이브리드 스캐너**입니다.

이 코드의 역할은 다음과 같습니다.

1. **커맨드 인젝션 탐지 (Whitebox):** 소스 코드에서 `Runtime.exec()`나 `ProcessBuilder`를 사용할 때, 사용자 입력값이 필터링 없이 쉘 명령어에 연결되는 위험한 패턴을 찾아냅니다.
2. **URL 요청 검증 (Whitebox):** `new URL()`, `HttpClient` 등을 사용하여 외부로 요청을 보낼 때, 대상 도메인에 대한 화이트리스트 검증 로직이 있는지 확인합니다.
3. **명령어 주입 테스트 (Blackbox):** Ping 테스트와 같은 기능에 `;`, `&`, `|` 등의 특수문자를 주입하여, `ls`, `id` 같은 시스템 명령어가 실행되는지 확인합니다.
4. **내부망 접근 테스트 (Blackbox):** 외부에서 접근 불가능한 내부 IP(`127.0.0.1` 등)로 요청을 보내, 서버가 내부망을 스캔하거나 연결할 수 있는지 점검합니다.

# main.py

### 도움말 보기
python main.py -h
python main.py --help

### 기본 실행 (기본 타겟: http://127.0.0.1:8080)
python main.py

### 커스텀 타겟 지정 (짧은 옵션)
python main.py -t http://localhost:8080
python main.py -t http://192.168.1.100:80

### 커스텀 타겟 지정 (긴 옵션)
python main.py --target http://localhost:8080
python main.py --target http://192.168.1.100:80
