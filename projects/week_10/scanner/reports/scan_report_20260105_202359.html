<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>DNA Lab Security Scan Report</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; line-height: 1.6; color: #333; background: #f4f4f4; margin: 0; padding: 20px; }
        .container { max-width: 1000px; margin: 0 auto; background: white; padding: 40px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); border-radius: 8px; }
        .header { border-bottom: 2px solid #333; padding-bottom: 20px; margin-bottom: 30px; }
        .header h1 { margin: 0; color: #2c3e50; }
        .meta { background: #f8f9fa; padding: 15px; border-radius: 4px; margin-bottom: 30px; font-size: 0.9em; }
        .summary { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; margin-bottom: 40px; text-align: center; }
        .card { padding: 20px; border-radius: 4px; color: white; }
        .card.total { background: #34495e; }
        .card.vuln { background: #e74c3c; }
        .card.safe { background: #27ae60; }
        .card.findings { background: #3498db; }
        .card h3 { margin: 0; font-size: 2em; }
        .item { border: 1px solid #ddd; margin-bottom: 20px; border-radius: 4px; overflow: hidden; }
        .item-head { padding: 12px 20px; display: flex; justify-content: space-between; align-items: center; background: #eee; font-weight: bold; }
        .item-head.vuln { background: #fadbd8; color: #c0392b; border-left: 5px solid #c0392b; }
        .item-head.safe { background: #d5f5e3; color: #27ae60; border-left: 5px solid #27ae60; }
        .item-body { padding: 20px; }
        .section { margin-bottom: 15px; }
        .section h4 { margin-bottom: 5px; color: #555; font-size: 0.9em; text-transform: uppercase; border-bottom: 1px solid #eee; padding-bottom: 5px; }
        ul { padding-left: 20px; margin: 0; }
        li { margin-bottom: 5px; font-size: 0.95em; word-break: break-all; }
        .footer { margin-top: 50px; text-align: center; font-size: 0.8em; color: #888; border-top: 1px solid #eee; padding-top: 20px; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>DNA Lab Security Scan Report</h1>
        </div>
        
        <div class="meta">
            <p><strong>Date:</strong> 2026-01-05 20:23:59</p>
            <p><strong>Target:</strong> http://127.0.0.1:8080</p>
        </div>
        
        <div class="summary">
            <div class="card total">
                <h3>16</h3>
                <p>Total Scans</p>
            </div>
            <div class="card vuln">
                <h3>15</h3>
                <p>Vulnerable</p>
            </div>
            <div class="card safe">
                <h3>1</h3>
                <p>Safe</p>
            </div>
            <div class="card findings">
                <h3>74</h3>
                <p>Total Findings</p>
            </div>
        </div>

        <div class="item">
            <div class="item-head vuln">
                <span>1. XSS (Cross-Site Scripting)</span>
                <span>VULNERABLE</span>
            </div>
            <div class="item-body">

                <div class="section">
                    <h4>Details</h4>
                    <ul><li>[Dynamic] Reflected XSS 취약 (/board/list, param: keyword)</li><li>[Header] CSP 헤더 미설정</li></ul>
                </div>
                <div class="section">
                    <h4>Recommendation</h4>
                    <p>출력값 검증 및 이스케이프 처리 | CSP (Content-Security-Policy) 헤더 설정</p>
                </div></div></div>
        <div class="item">
            <div class="item-head vuln">
                <span>2. SQL Injection</span>
                <span>VULNERABLE</span>
            </div>
            <div class="item-body">

                <div class="section">
                    <h4>Details</h4>
                    <ul><li>[Static] UserMapper.xml - select#login - SQL Injection 취약: ${username} (#{username} 사용 필요)</li><li>[Static] UserMapper.xml - select#login - SQL Injection 취약: ${password} (#{password} 사용 필요)</li><li>[Static] UserMapper.xml - select#findByUsername - SQL Injection 취약: ${username} (#{username} 사용 필요)</li><li>[Static] UserMapper.xml - select#findByUsernameAndEmail - SQL Injection 취약: ${username} (#{username} 사용 필요)</li><li>[Static] UserMapper.xml - select#findByUsernameAndEmail - SQL Injection 취약: ${email} (#{email} 사용 필요)</li><li>[Static] UserMapper.xml - insert#save - SQL Injection 취약: ${username} (#{username} 사용 필요)</li><li>[Static] UserMapper.xml - insert#save - SQL Injection 취약: ${password} (#{password} 사용 필요)</li><li>[Static] UserMapper.xml - insert#save - SQL Injection 취약: ${nickname} (#{nickname} 사용 필요)</li><li>[Static] UserMapper.xml - insert#save - SQL Injection 취약: ${email} (#{email} 사용 필요)</li><li>[Static] UserMapper.xml - insert#save - SQL Injection 취약: ${role} (#{role} 사용 필요)</li><li>[Static] UserMapper.xml - update#update - SQL Injection 취약: ${nickname} (#{nickname} 사용 필요)</li><li>[Static] UserMapper.xml - update#update - SQL Injection 취약: ${email} (#{email} 사용 필요)</li><li>[Static] UserMapper.xml - update#update - SQL Injection 취약: ${password} (#{password} 사용 필요)</li><li>[Static] UserMapper.xml - update#update - SQL Injection 취약: ${id} (#{id} 사용 필요)</li><li>[Static] UserMapper.xml - delete#delete - SQL Injection 취약: ${id} (#{id} 사용 필요)</li><li>[Static] BoardMapper.xml - select#findAll - SQL Injection 취약: ${keyword} (#{keyword} 사용 필요)</li><li>[Static] BoardMapper.xml - select#findByWriter - SQL Injection 취약: ${writer} (#{writer} 사용 필요)</li><li>[Static] BoardMapper.xml - select#findByWriter - SQL Injection 취약: ${keyword} (#{keyword} 사용 필요)</li><li>[Static] BoardMapper.xml - select#findByWriterOrAdmin - SQL Injection 취약: ${writer} (#{writer} 사용 필요)</li><li>[Static] BoardMapper.xml - select#findByWriterOrAdmin - SQL Injection 취약: ${keyword} (#{keyword} 사용 필요)</li><li>[Static] BoardMapper.xml - select#findById - SQL Injection 취약: ${id} (#{id} 사용 필요)</li><li>[Static] BoardMapper.xml - insert#save - SQL Injection 취약: ${title} (#{title} 사용 필요)</li><li>[Static] BoardMapper.xml - insert#save - SQL Injection 취약: ${content} (#{content} 사용 필요)</li><li>[Static] BoardMapper.xml - insert#save - SQL Injection 취약: ${writer} (#{writer} 사용 필요)</li><li>[Static] BoardMapper.xml - insert#save - SQL Injection 취약: ${filename} (#{filename} 사용 필요)</li><li>[Static] BoardMapper.xml - insert#save - SQL Injection 취약: ${filepath} (#{filepath} 사용 필요)</li><li>[Dynamic] 로그인 SQL Injection 취약 (payload: admin'#)</li><li>[Dynamic] URL 파라미터 SQL Injection 취약 (/user/profile?id=)</li></ul>
                </div>
                <div class="section">
                    <h4>Recommendation</h4>
                    <p>PreparedStatement 사용 및 입력값 검증 | MyBatis에서 ${} 대신 #{} 파라미터 사용 | URL 파라미터 검증 강화</p>
                </div></div></div>
        <div class="item">
            <div class="item-head vuln">
                <span>3. OS Command Injection</span>
                <span>VULNERABLE</span>
            </div>
            <div class="item-body">

                <div class="section">
                    <h4>Details</h4>
                    <ul><li>[Whitebox] AdminController.java:86 - OS Command Injection 위험 (사용자 입력이 명령어 실행에 사용됨)</li><li>[Whitebox] AdminController.java:86 - 명령어 문자열 동적 조합 발견</li><li>[Blackbox] OS Command Injection 취약 (/admin/system/ping): Windows 명령어 실행됨 (payload: 127.0.0.1 & ipconfig)</li><li>[Blackbox] Blind Command Injection 취약 (/admin/system/ping): 시간 지연 확인 (7.1초)</li></ul>
                </div>
                <div class="section">
                    <h4>Recommendation</h4>
                    <p>사용자 입력을 명령어로 직접 실행 금지 | 명령어 하드코딩 및 파라미터 검증 강화 | Runtime.exec() 사용 금지 또는 화이트리스트 검증 | 명령어 실행 함수 사용 최소화 및 입력 검증 강화</p>
                </div></div></div>
        <div class="item">
            <div class="item-head vuln">
                <span>4. CSRF (Cross-Site Request Forgery)</span>
                <span>VULNERABLE</span>
            </div>
            <div class="item-body">

                <div class="section">
                    <h4>Details</h4>
                    <ul><li>[Dynamic] CSRF 토큰 미사용: /board/write</li><li>[Dynamic] CSRF 보호 없음: /user/profile (토큰 없이 작업 수행 가능)</li></ul>
                </div>
                <div class="section">
                    <h4>Recommendation</h4>
                    <p>Spring Security CSRF 보호 활성화 | POST 요청에 CSRF 토큰 추가</p>
                </div></div></div>
        <div class="item">
            <div class="item-head vuln">
                <span>5. 약한 비밀번호 정책</span>
                <span>VULNERABLE</span>
            </div>
            <div class="item-body">

                <div class="section">
                    <h4>Details</h4>
                    <ul><li>[Dynamic] 약한 비밀번호 허용됨 (예: 1234)</li></ul>
                </div>
                <div class="section">
                    <h4>Recommendation</h4>
                    <p>비밀번호 복잡도 검증 (최소 8자, 대소문자/숫자/특수문자 포함)</p>
                </div></div></div>
        <div class="item">
            <div class="item-head vuln">
                <span>6. 불충분한 접근 제어 (인증/인가)</span>
                <span>VULNERABLE</span>
            </div>
            <div class="item-body">

                <div class="section">
                    <h4>Details</h4>
                    <ul><li>[Whitebox] UserMapper.xml - SQL Injection 취약 (로그인 쿼리)</li><li>[Whitebox] BoardController.java - 게시글 조회 소유권 검증 부재 (IDOR 위험)</li><li>[Blackbox] SQL Injection 인증 우회 성공 (payload: admin'#)</li></ul>
                </div>
                <div class="section">
                    <h4>Recommendation</h4>
                    <p>MyBatis에서 ${} 대신 #{} 사용 | PreparedStatement로 SQL Injection 방어</p>
                </div></div></div>
        <div class="item">
            <div class="item-head vuln">
                <span>7. 취약한 비밀번호 복구 절차</span>
                <span>VULNERABLE</span>
            </div>
            <div class="item-body">

                <div class="section">
                    <h4>Details</h4>
                    <ul><li>[Whitebox] DataInitializer.java - 안전한 토큰 생성 로직 부재</li><li>[Whitebox] DataInitializer.java - 토큰 만료 시간 로직 부재</li><li>[Whitebox] WebConfig.java - 안전한 토큰 생성 로직 부재</li><li>[Whitebox] WebConfig.java - 토큰 만료 시간 로직 부재</li><li>[Whitebox] AuthController.java - 토큰 만료 시간 로직 부재</li><li>[Whitebox] UserMapper.java - 안전한 토큰 생성 로직 부재</li><li>[Whitebox] UserMapper.java - 토큰 만료 시간 로직 부재</li><li>[Blackbox] 비밀번호 재설정 토큰 검증 미흡: /password/reset</li><li>[Blackbox] 예측 가능한 정보로 비밀번호 재설정 가능 (보안 질문 취약)</li></ul>
                </div>
                <div class="section">
                    <h4>Recommendation</h4>
                    <p>토큰 유효 시간 제한 (15분) | 보안 질문 제거 (토큰 기반 재설정만 허용) | 이메일 인증 토큰 사용 | UUID/SecureRandom으로 안전한 토큰 생성</p>
                </div></div></div>
        <div class="item">
            <div class="item-head vuln">
                <span>8. 불충분한 세션 관리</span>
                <span>VULNERABLE</span>
            </div>
            <div class="item-body">

                <div class="section">
                    <h4>Details</h4>
                    <ul><li>[Blackbox] 세션 쿠키에 HttpOnly 플래그 미설정</li></ul>
                </div>
                <div class="section">
                    <h4>Recommendation</h4>
                    <p>HttpOnly/Secure 쿠키 플래그 설정</p>
                </div></div></div>
        <div class="item">
            <div class="item-head vuln">
                <span>9. 쿠키 변조</span>
                <span>VULNERABLE</span>
            </div>
            <div class="item-body">

                <div class="section">
                    <h4>Details</h4>
                    <ul><li>[Blackbox] 쿠키 변조로 관리자 페이지 접근 성공: /admin/system (role=admin)</li><li>[Whitebox] AdminController.java - 검증 없는 쿠키 기반 권한 제어 의심</li><li>[Whitebox] AuthController.java - 검증 없는 쿠키 기반 권한 제어 의심</li></ul>
                </div>
                <div class="section">
                    <h4>Recommendation</h4>
                    <p>쿠키 서명(HMAC) 구현 또는 세션 기반 권한 관리 | 쿠키 값 변조 방지(서명) 적용</p>
                </div></div></div>
        <div class="item">
            <div class="item-head vuln">
                <span>10. 파일 전송 취약점</span>
                <span>VULNERABLE</span>
            </div>
            <div class="item-body">

                <div class="section">
                    <h4>Details</h4>
                    <ul><li>[Blackbox] 위험한 파일 업로드 가능: malware.exe (/libs/upload) - 200</li><li>[Blackbox] 경로 조작으로 설정 파일 접근 성공: /download?path=../application.properties</li></ul>
                </div>
                <div class="section">
                    <h4>Recommendation</h4>
                    <p>파일명 난수화 및 확장자 화이트리스트 적용 | 다운로드 가능 경로를 화이트리스트로 제한 | 경로 정규화(normalize) 및 상위 디렉토리 이동(..) 차단 | 실행 가능한 확장자(.exe) 업로드 차단</p>
                </div></div></div>
        <div class="item">
            <div class="item-head vuln">
                <span>11. 경로 조작 (Path Traversal)</span>
                <span>VULNERABLE</span>
            </div>
            <div class="item-body">

                <div class="section">
                    <h4>Details</h4>
                    <ul><li>[Blackbox] 시스템 파일 접근 가능 (/file/download)</li><li>[Blackbox] 설정 파일 노출 확인 (/file/view)</li></ul>
                </div>
                <div class="section">
                    <h4>Recommendation</h4>
                    <p>화이트리스트 기반 경로 제한 | 파일 경로 정규화 및 검증</p>
                </div></div></div>
        <div class="item">
            <div class="item-head vuln">
                <span>12. 에러 페이지 적용 미흡</span>
                <span>VULNERABLE</span>
            </div>
            <div class="item-body">

                <div class="section">
                    <h4>Details</h4>
                    <ul><li>[Blackbox] 없는 경로가 메인/로그인 페이지로 리다이렉트됨 (Soft-404): http://127.0.0.1:8080/this_should_404_zzzz</li><li>[Blackbox] 없는 경로가 메인/로그인 페이지로 리다이렉트됨 (Soft-404): http://127.0.0.1:8080/%ZZ</li><li>[Blackbox] 없는 경로가 메인/로그인 페이지로 리다이렉트됨 (Soft-404): http://127.0.0.1:8080/error_test_1234</li></ul>
                </div>
                <div class="section">
                    <h4>Recommendation</h4>
                    <p>운영 환경에서 스택 트레이스 및 상세 에러 메시지 노출 차단 (Custom Error Page 적용) | 존재하지 않는 페이지 요청 시 404 상태 코드 반환</p>
                </div></div></div>
        <div class="item">
            <div class="item-head vuln">
                <span>13. Format String 취약점</span>
                <span>VULNERABLE</span>
            </div>
            <div class="item-body">

                <div class="section">
                    <h4>Details</h4>
                    <ul><li>[Whitebox] SupportController.java:37 - 포맷 문자열에 사용자 입력 연결</li><li>[Blackbox] Format String 민감 정보 유출: SK-SHIELDUS-ADMIN-KEY-2025</li></ul>
                </div>
                <div class="section">
                    <h4>Recommendation</h4>
                    <p>String.format() 포맷 문자열 하드코딩 권장 | String.format()에서 민감 정보 제거</p>
                </div></div></div>
        <div class="item">
            <div class="item-head safe">
                <span>14. 불필요한 HTTP Method 악용</span>
                <span>SAFE</span>
            </div>
            <div class="item-body">

                <div class="section">
                    <h4>Recommendation</h4>
                    <p>안전 - 불필요한 HTTP Method가 차단되어 있음</p>
                </div></div></div>
        <div class="item">
            <div class="item-head vuln">
                <span>15. SSRF (Server-Side Request Forgery)</span>
                <span>VULNERABLE</span>
            </div>
            <div class="item-body">

                <div class="section">
                    <h4>Details</h4>
                    <ul><li>[Whitebox] AdminController.java:86 - Command Injection 위험 (exec에 입력값 연결)</li><li>[Blackbox] Command Injection/SSRF 취약: /admin/system/ping (payload: 127.0.0.1)</li><li>[Blackbox] 내부망(Loopback) 접근 가능: /admin/system/ping</li></ul>
                </div>
                <div class="section">
                    <h4>Recommendation</h4>
                    <p>입력값 검증 및 명령어 인젝션 방어 | Runtime.exec() 사용 금지 또는 화이트리스트 검증 | 내부 IP 대역 접근 차단</p>
                </div></div></div>
        <div class="item">
            <div class="item-head vuln">
                <span>16. Dynamic Scan</span>
                <span>VULNERABLE</span>
            </div>
            <div class="item-body">

                <div class="section">
                    <h4>Details</h4>
                    <ul><li>[Dynamic] XSS found: http://127.0.0.1:8080/join</li><li>[Dynamic] SQL Injection found: http://127.0.0.1:8080/join</li><li>[Dynamic] CSRF token missing: http://127.0.0.1:8080/board/write</li><li>[Dynamic] CSRF token missing: http://127.0.0.1:8080/update</li><li>[Dynamic] CSRF token missing: http://127.0.0.1:8080/user/family/delete</li></ul>
                </div>
                <div class="section">
                    <h4>Recommendation</h4>
                    <p>Input HTML escaping (th:text) | Implement CSRF token | Use PreparedStatement</p>
                </div></div></div>
        <div class="footer">
            Generated by DNA Lab Security Scanner
        </div>
    </div>
</body>
</html>
