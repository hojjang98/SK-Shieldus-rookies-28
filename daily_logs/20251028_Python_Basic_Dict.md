📄 2025.10.28 (Day 2) 클래스, 함수, 제어구문, 딕셔너리


# 1. 🧠 핵심 개념 정리 (Concepts)

- **변수와 자료형**  
  변수는 데이터를 담는 공간이며, 파이썬에서는 모든 것이 객체이다.  
  기본 타입과 참조 타입의 차이를 이해하는 것은 메모리 안전성과 데이터 무결성 측면에서 중요하다.  
  리터럴(literal)은 코드에 직접 명시된 값(예: `"admin"`, `123`)을 뜻하며, 입력 검증(input validation) 과정에서 타입 확인과 함께 필수적으로 고려되어야 한다.

- **함수(Function) vs 메서드(Method)**  
  함수는 독립적으로 실행 가능한 코드 블록(예: `print()`),  
  메서드는 객체가 소유한 함수로, 반드시 인스턴스나 클래스와 함께 호출된다(예: `"abc".upper()`).  
  보안 로직에서 함수는 해시 계산, 암호화, 데이터 정규화 등 공통 기능에,  
  메서드는 세션 관리나 사용자 객체 조작처럼 상태 변화가 필요한 영역에 주로 사용된다.

- **클래스(Class)와 설계 관점**  
  클래스는 현실 세계의 개체(명사)와 행동(동사)을 코드로 표현한 설계도이다.  
  속성(Attribute)은 상태를, 메서드(Method)는 행동을 정의한다.  
  보안 시스템에서는 Event, Detector, Session 같은 클래스를 설계하여 책임을 분리하고 확장성을 확보할 수 있다.  
  예를 들어, Event 클래스는 로그 한 줄을 표현하고, Detector 클래스는 이를 분석하여 탐지 규칙을 적용하는 역할을 수행한다.

- **제어구문(조건/반복)**  
  if, for, while 등은 탐지 규칙과 필터링 로직의 기본이 된다.  
  리스트 컴프리헨션은 간결한 데이터 가공에 유용하며, 예를 들어 특정 이벤트의 필드만 추출하거나, 이상 징후를 탐지하는 로직을 간단하게 표현할 수 있다.  
  조건 설계는 탐지의 정밀도에 직접적인 영향을 주며, 오탐/미탐 비율을 조정하는 핵심 요소이다.

- **딕셔너리(Dictionary)와 JSON 구조**  
  키-값 기반의 딕셔너리는 로그, API, SIEM 이벤트 표현에 최적화되어 있다.  
  실무에서는 `.get()` 메서드를 사용하여 KeyError를 방지하고, 필드 누락 시 기본값을 설정함으로써 안정성을 높인다.  
  또한 JSON 파싱 시 딕셔너리 구조를 유지함으로써, 데이터 정형화와 탐지 규칙의 자동화 구현이 가능하다.

  # 2. 💻 실습 코드 & 응용 (Practice & Code)

```python
# 리스트의 각 원소를 제곱
lst = [1, 2, 3, 4, 5]
res = [x ** 2 for x in lst]
print(res)
```

리스트 컴프리헨션은 단순한 문법 연습을 넘어, 로그 데이터에서 특정 패턴이나 수치를 빠르게 계산하는 데 활용할 수 있다. 예를 들어, 공격 시도 횟수나 IP 요청 빈도를 계산하는 과정에서 효율적인 필터링/집계 방법으로 쓰인다.

```python
# 얕은 복사 vs 깊은 복사
import copy
cache_shallow = copy.copy(obj)    # 얕은 복사: 참조만 복사
cache_deep = copy.deepcopy(obj)   # 깊은 복사: 객체 자체를 복제
```
보안 시스템에서 얕은 복사는 원본 데이터를 의도치 않게 변경시킬 수 있다. 따라서 로그 데이터나 세션 정보를 다룰 때는 deepcopy를 사용하여 데이터 무결성을 유지해야 한다.이는 SIEM 로그 전처리 과정이나 탐지 모델 학습 시 매우 중요한 안정성 확보 방법이다.

```python
# 딕셔너리 안전 접근
user = {"name": "admin", "role": "user"}
print(user.get("id", "unknown"))  # 안전 접근: 키가 없으면 기본값 반환
```

.get() 메서드는 KeyError를 방지한다. 이 방식은 JSON 응답이나 보안 로그 파싱 중 필드 누락이 발생하더라도 프로그램이 중단되지 않게 해주며,운영 중인 탐지 엔진이나 수집기(Log Collector)의 안정성을 크게 향상시킨다.

🧩 실무 응용 포인트

1. 리스트 컴프리헨션 → 로그 필드별 필터링, 이상 탐지 시 Threshold 계산
2. copy / deepcopy → 데이터 전처리 시 원본 로그 무결성 보장
3. 딕셔너리 접근(get) → 예외 발생 방지 및 안정적 파서 설계
4. 조건문 조합 → 탐지 정책(예: 로그인 실패 5회 이상 → 경고) 구현의 핵심 구조

# 3. 🛡️ 보안 관점 분석 (Security Insight)

- **객체지향 설계와 보안 모듈 구조**
  - 대부분의 보안 솔루션(로그 분석기, 탐지 엔진, 취약점 스캐너 등)은 객체지향 기반으로 설계된다.  
  - 예를 들어, `Event` 클래스는 단일 로그 이벤트를, `Detector` 클래스는 탐지 규칙을 표현할 수 있다.  
  - 클래스 구조를 이해하면 보안 로직을 모듈 단위로 분리해 유지보수성을 높이고, 향후 자동화 및 확장에도 유리하다.  
  - 이는 특히 SOC나 CERT 환경에서 탐지 규칙을 코드 형태로 관리할 때 매우 중요하다.

- **함수/메서드의 경계와 역할**
  - 독립 실행형 함수는 암호화, 해시, 정규화 등 공통 연산에 적합하다.  
  - 반면, 메서드는 객체의 상태를 변경하거나 관리하는 역할에 적합하다.  
  - 예를 들어, 세션(Session) 객체의 `invalidate()` 메서드는 사용자의 인증 정보를 폐기하는 기능으로, 보안성과 직결된다.

- **제어구문을 통한 탐지 로직 구현**
  - `if`, `for`, `while` 등은 탐지 정책의 핵심이다.  
    - 예: “동일 IP에서 5회 이상 로그인 실패 시 차단”  
    - 예: “비정상 포트로의 접근 시도 감지 및 로깅”  
  - 반복문(`for`)은 로그 스트림을 순회하며 이상 행위를 탐지하는 데 자주 활용된다.  
  - 조건 설계의 정밀도는 오탐(False Positive)과 미탐(False Negative)의 균형을 결정짓는 핵심 요소이다.

- **딕셔너리와 JSON의 실무적 활용**
  - 보안 로그, API 응답, Threat Intelligence 데이터 등은 대부분 JSON 기반으로 전달된다.  
  - 파이썬의 딕셔너리는 이러한 데이터를 파싱하고 정형화하기에 최적화된 구조다.  
  - 예를 들어, 로그 한 줄을 다음과 같이 구조화할 수 있다:  
    `{"timestamp": "2025-10-28 10:00", "event": "login_fail", "src_ip": "192.168.0.12"}`  
  - 이 형태로 데이터를 저장하면 탐지 규칙을 손쉽게 적용할 수 있으며, SIEM이나 ELK 같은 외부 플랫폼과 연동하기도 쉽다.

- **복사(copy, deepcopy)와 데이터 무결성**
  - 탐지 로직 실행 중, 동일한 데이터 객체를 여러 곳에서 참조할 경우 원본이 훼손될 수 있다.  
  - 얕은 복사를 사용할 경우, 원본 객체에 대한 변경이 복사본에도 반영되어 의도치 않은 데이터 오염이 발생할 수 있다.  
  - 이러한 문제를 방지하기 위해 **깊은 복사(deepcopy)** 를 활용하여 로그 원본을 보호하고,  
    특히 학습용 데이터셋 생성 시 원본 변조를 방지하는 데 필수적이다.

- **예외 처리의 중요성**
  - 보안 시스템에서는 단일 예외가 전체 서비스 중단으로 이어질 수 있다.  
  - `try-except` 구문을 사용하여 예외 상황을 감지하고, 로그 파일에 기록하거나 별도의 큐로 재처리하는 방식으로 안정성을 높일 수 있다.  
  - 예외 발생 시 단순히 에러를 출력하는 대신, “보안 이벤트”로 전환해 탐지 규칙에 반영하는 접근이 효과적이다.

---

### 💬 핵심 포인트
- 클래스와 메서드를 이용한 **탐지 엔진 구조화 설계**  
- 제어구문을 이용한 **정교한 탐지 조건 구현**  
- 딕셔너리(JSON)를 통한 **로그 표준화 및 정형화**  
- deepcopy를 활용한 **데이터 무결성 확보**  
- 예외 처리 기반의 **안정적 탐지 시스템 운영**

# 4. 🧩 요약 (Summary)

1. 파이썬의 객체·함수·제어구조는 탐지 엔진, 세션 관리, 로그 파서 같은 보안 시스템 설계에 직접적으로 적용된다.  
2. 딕셔너리(JSON) 기반의 데이터 모델링과 `.get()` 같은 안전한 접근 패턴은 로그 안정성과 파서 견고성 확보에 핵심적이다.  
3. 데이터 무결성을 위해 복사 전략(copy vs deepcopy)과 일관된 예외 처리 패턴을 명확히 하며, 예외는 단순 에러가 아니라 보안 이벤트로 취급할 수 있어야 한다.


