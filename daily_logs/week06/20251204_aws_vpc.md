### ğŸ“„ 2024.12.04 (Day 28) [AWS VPC: ë„¤íŠ¸ì›Œí¬ êµ¬ì„± ë° ì—°ê²°]

## 1. í•µì‹¬ ê°œë… ì •ë¦¬ (Concepts & Theory)

| # | í•µì‹¬ ê°œë… | ê°„ê²°í•œ ì„¤ëª… | ì‹¤ë¬´/ë³´ì•ˆ ê´€ì ì—ì„œì˜ ì¤‘ìš”ì„± |
|:---:|:---|:---|:---|
| **1** | **Amazon VPC (Virtual Private Cloud)** | AWS í´ë¼ìš°ë“œ ë‚´ì—ì„œ **ë…¼ë¦¬ì ìœ¼ë¡œ ê²©ë¦¬ëœ ê°€ìƒ ë„¤íŠ¸ì›Œí¬** ë¥¼ ìƒì„±í•˜ëŠ” ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤. ì‚¬ìš©ìê°€ ì •ì˜í•œ IP ì£¼ì†Œ ë²”ìœ„(CIDR ë¸”ë¡), ì„œë¸Œë„·, ë¼ìš°íŒ… í…Œì´ë¸”, ê²Œì´íŠ¸ì›¨ì´ë¥¼ êµ¬ì„±í•˜ì—¬ ì™„ì „í•œ ì œì–´ ê¶Œí•œì„ ê°€ì§‘ë‹ˆë‹¤. On-Premise ë°ì´í„°ì„¼í„°ì²˜ëŸ¼ ë„¤íŠ¸ì›Œí¬ë¥¼ ì„¤ê³„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. | **ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆì˜ ê¸°ë³¸** ì…ë‹ˆë‹¤. VPCë¡œ ë¦¬ì†ŒìŠ¤ë¥¼ ê²©ë¦¬í•˜ê³ , Public/Private Subnet ë¶„ë¦¬, ë³´ì•ˆ ê·¸ë£¹ ë° NACLë¡œ íŠ¸ë˜í”½ ì œì–´, VPC Peering/Transit Gatewayë¡œ ì•ˆì „í•œ ë‚´ë¶€ í†µì‹  êµ¬í˜„. ì˜ëª»ëœ VPC ì„¤ê³„ëŠ” ì™¸ë¶€ ê³µê²© ë…¸ì¶œ, ë‚´ë¶€ë§ ì¹¨íˆ¬, ë°ì´í„° ìœ ì¶œë¡œ ì´ì–´ì§‘ë‹ˆë‹¤. |
| **2** | **CIDR (Classless Inter-Domain Routing)** | IP ì£¼ì†Œ ë²”ìœ„ë¥¼ í‘œê¸°í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ **IPì£¼ì†Œ/ì„œë¸Œë„· ë§ˆìŠ¤í¬** í˜•íƒœì…ë‹ˆë‹¤. ì˜ˆ: 10.0.0.0/16ì€ 10.0.0.0 ~ 10.0.255.255 (65,536ê°œ IP). /16ì€ ì• 16ë¹„íŠ¸ê°€ ë„¤íŠ¸ì›Œí¬ ë¶€ë¶„ì´ê³ , ë‚˜ë¨¸ì§€ 16ë¹„íŠ¸ê°€ í˜¸ìŠ¤íŠ¸ ë¶€ë¶„ì…ë‹ˆë‹¤. VPC ìƒì„± ì‹œ CIDR ë¸”ë¡ì„ ì§€ì •í•©ë‹ˆë‹¤. | **IP ì£¼ì†Œ ê³„íš** ì´ ì¤‘ìš”í•©ë‹ˆë‹¤. VPC CIDRì€ ë³€ê²½ ë¶ˆê°€í•˜ë¯€ë¡œ ì´ˆê¸° ì„¤ê³„ ì‹œ ì¶©ë¶„í•œ IP í™•ë³´ í•„ìš”(ì˜ˆ: /16). ë‹¤ë¥¸ VPCë‚˜ On-Premiseì™€ ê²¹ì¹˜ì§€ ì•Šë„ë¡ RFC 1918 ì‚¬ì„¤ IP ëŒ€ì—­(10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16) ì‚¬ìš©. ë„ˆë¬´ ì‘ì€ CIDRì€ í™•ì¥ ë¶ˆê°€, ë„ˆë¬´ í° CIDRì€ ë‚­ë¹„. |
| **3** | **ì„œë¸Œë„· (Subnet)** | VPC ë‚´ì—ì„œ IP ì£¼ì†Œ ë²”ìœ„ë¥¼ ë” ì‘ì€ ë‹¨ìœ„ë¡œ ë¶„í• í•œ ë„¤íŠ¸ì›Œí¬ ì„¸ê·¸ë¨¼íŠ¸ì…ë‹ˆë‹¤. ê° ì„œë¸Œë„·ì€ **í•˜ë‚˜ì˜ ê°€ìš© ì˜ì—­(AZ)** ì— ì†í•˜ë©°, **Public Subnet** (ì¸í„°ë„· ê²Œì´íŠ¸ì›¨ì´ ì—°ê²°)ê³¼ **Private Subnet** (ì¸í„°ë„· ì§ì ‘ ì ‘ê·¼ ë¶ˆê°€)ìœ¼ë¡œ êµ¬ë¶„ë©ë‹ˆë‹¤. | **ë³´ì•ˆ ê³„ì¸µí™”** ì˜ í•µì‹¬ì…ë‹ˆë‹¤. Public Subnetì—ëŠ” ì›¹ ì„œë²„/ë¡œë“œ ë°¸ëŸ°ì„œ ë°°ì¹˜, Private Subnetì—ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë²„/ë°ì´í„°ë² ì´ìŠ¤ ë°°ì¹˜í•˜ì—¬ ê³µê²© í‘œë©´ ìµœì†Œí™”. ì„œë¸Œë„·ë§ˆë‹¤ NACL ì ìš© ê°€ëŠ¥í•˜ë©°, ìµœì†Œ 2ê°œ AZì— ì„œë¸Œë„· ë¶„ì‚° ë°°ì¹˜ë¡œ ê³ ê°€ìš©ì„± í™•ë³´. AWSëŠ” ì„œë¸Œë„·ë‹¹ ì²« 4ê°œ, ë§ˆì§€ë§‰ 1ê°œ IP ì˜ˆì•½(ì´ 5ê°œ). |
| **4** | **ì¸í„°ë„· ê²Œì´íŠ¸ì›¨ì´ (Internet Gateway, IGW)** | VPCì™€ ì¸í„°ë„· ê°„ **ì–‘ë°©í–¥ í†µì‹ ** ì„ ê°€ëŠ¥í•˜ê²Œ í•˜ëŠ” ê²Œì´íŠ¸ì›¨ì´ì…ë‹ˆë‹¤. Public Subnetì˜ ë¼ìš°íŒ… í…Œì´ë¸”ì— IGWë¥¼ ê¸°ë³¸ ê²Œì´íŠ¸ì›¨ì´(0.0.0.0/0)ë¡œ ì„¤ì •í•˜ì—¬ ì¸í„°ë„· ì ‘ì†ì„ í—ˆìš©í•©ë‹ˆë‹¤. ìˆ˜í‰ í™•ì¥ ê°€ëŠ¥í•˜ê³  ê³ ê°€ìš©ì„±ì´ ë³´ì¥ë©ë‹ˆë‹¤. | **Public Subnet í•„ìˆ˜ ìš”ì†Œ** ì…ë‹ˆë‹¤. IGWê°€ ì—†ìœ¼ë©´ ì¸í„°ë„· ì ‘ì† ë¶ˆê°€. EC2 ì¸ìŠ¤í„´ìŠ¤ì— Public IP ë˜ëŠ” Elastic IP í• ë‹¹ í•„ìš”. ë³´ì•ˆ ê·¸ë£¹ìœ¼ë¡œ ì¸ë°”ìš´ë“œ íŠ¸ë˜í”½ ì œì–´ í•„ìˆ˜(ì˜ˆ: HTTP/HTTPSë§Œ í—ˆìš©). DDoS ë°©ì–´ë¥¼ ìœ„í•´ AWS Shieldì™€ ê²°í•©. IGWëŠ” VPCë‹¹ 1ê°œë§Œ ì—°ê²° ê°€ëŠ¥. |
| **5** | **NAT Gateway / NAT Instance** | **Private Subnetì˜ ì¸ìŠ¤í„´ìŠ¤ê°€ ì¸í„°ë„·ì— ì•„ì›ƒë°”ìš´ë“œ ì—°ê²°** (ì˜ˆ: ì†Œí”„íŠ¸ì›¨ì–´ ì—…ë°ì´íŠ¸, API í˜¸ì¶œ)ì„ ê°€ëŠ¥í•˜ê²Œ í•˜ì§€ë§Œ, **ì¸ë°”ìš´ë“œ ì—°ê²°ì€ ì°¨ë‹¨** í•©ë‹ˆë‹¤. NAT GatewayëŠ” AWS ê´€ë¦¬í˜• ì„œë¹„ìŠ¤(ê³ ê°€ìš©ì„±, ìë™ í™•ì¥), NAT InstanceëŠ” EC2 ì¸ìŠ¤í„´ìŠ¤(ì‚¬ìš©ì ê´€ë¦¬). | **Private Subnet ë³´ì•ˆ ìœ ì§€** í•˜ë©´ì„œ ì™¸ë¶€ í†µì‹ ì„ í—ˆìš©í•©ë‹ˆë‹¤. ë°ì´í„°ë² ì´ìŠ¤ë‚˜ ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë²„ê°€ íŒ¨ì¹˜ë¥¼ ë°›ê±°ë‚˜ ì™¸ë¶€ API í˜¸ì¶œ ì‹œ í•„ìˆ˜. NAT GatewayëŠ” ê°€ìš©ì„±ì´ ë†’ì§€ë§Œ ë¹„ìš© ë°œìƒ, NAT InstanceëŠ” ì €ë ´í•˜ì§€ë§Œ ë‹¨ì¼ ì¥ì• ì . ê° AZë§ˆë‹¤ NAT Gateway ë°°ì¹˜ ê¶Œì¥. |
| **6** | **ë¼ìš°íŒ… í…Œì´ë¸” (Route Table)** | **ë„¤íŠ¸ì›Œí¬ íŠ¸ë˜í”½ì˜ ê²½ë¡œë¥¼ ê²°ì •** í•˜ëŠ” ê·œì¹™ ì§‘í•©ì…ë‹ˆë‹¤. ê° ì„œë¸Œë„·ì€ í•˜ë‚˜ì˜ ë¼ìš°íŒ… í…Œì´ë¸”ê³¼ ì—°ê²°ë˜ë©°, ëª©ì ì§€ IP ë²”ìœ„(Destination)ì™€ íƒ€ê²Ÿ(Target: IGW, NAT Gateway, VPC Peering ë“±)ì„ ì •ì˜í•©ë‹ˆë‹¤. ê°€ì¥ êµ¬ì²´ì ì¸ ê²½ë¡œ(Longest Prefix Match)ê°€ ìš°ì„  ì ìš©ë©ë‹ˆë‹¤. | **íŠ¸ë˜í”½ íë¦„ ì œì–´** ì˜ í•µì‹¬ì…ë‹ˆë‹¤. Public Subnet ë¼ìš°íŒ… í…Œì´ë¸”: 0.0.0.0/0 â†’ IGW. Private Subnet ë¼ìš°íŒ… í…Œì´ë¸”: 0.0.0.0/0 â†’ NAT Gateway. ì˜ëª»ëœ ë¼ìš°íŒ…ì€ í†µì‹  ë‹¨ì ˆ ë˜ëŠ” ì˜ë„ì¹˜ ì•Šì€ ê²½ë¡œë¡œ íŠ¸ë˜í”½ ìœ ì¶œ. VPC Peering, Transit Gateway, VPN ì—°ê²° ì‹œ ë¼ìš°íŒ… í…Œì´ë¸” ì—…ë°ì´íŠ¸ í•„ìˆ˜. |
| **7** | **ë³´ì•ˆ ê·¸ë£¹ (Security Group)** | EC2 ì¸ìŠ¤í„´ìŠ¤ ë“± ë¦¬ì†ŒìŠ¤ì— ì—°ê²°ë˜ëŠ” **ê°€ìƒ ë°©í™”ë²½** ìœ¼ë¡œ, **ìƒíƒœ ì €ì¥í˜•(Stateful)** ì…ë‹ˆë‹¤. ì¸ë°”ìš´ë“œ/ì•„ì›ƒë°”ìš´ë“œ ê·œì¹™ì„ ì •ì˜í•˜ë©°, ê¸°ë³¸ì ìœ¼ë¡œ **ëª¨ë“  ì¸ë°”ìš´ë“œ ì°¨ë‹¨, ëª¨ë“  ì•„ì›ƒë°”ìš´ë“œ í—ˆìš©** ì…ë‹ˆë‹¤. Allow ê·œì¹™ë§Œ ì •ì˜ ê°€ëŠ¥(Deny ë¶ˆê°€). ì‘ë‹µ íŠ¸ë˜í”½ì€ ìë™ í—ˆìš©ë©ë‹ˆë‹¤. | **ì¸ìŠ¤í„´ìŠ¤ ë ˆë²¨ ë°©í™”ë²½** ì…ë‹ˆë‹¤. ìµœì†Œ ê¶Œí•œ ì›ì¹™ ì ìš©: í•„ìš”í•œ í¬íŠ¸ì™€ ì†ŒìŠ¤ IPë§Œ í—ˆìš©(ì˜ˆ: SSHëŠ” íŠ¹ì • IPì—ì„œë§Œ). ë³´ì•ˆ ê·¸ë£¹ë¼ë¦¬ ì°¸ì¡° ê°€ëŠ¥(ì˜ˆ: ì›¹ ì„œë²„ SGëŠ” ALB SGë§Œ í—ˆìš©). ë³€ê²½ ì‚¬í•­ì€ ì¦‰ì‹œ ì ìš©. 5ê°œ ë³´ì•ˆ ê·¸ë£¹/ì¸ìŠ¤í„´ìŠ¤, 60ê°œ ê·œì¹™/ë³´ì•ˆ ê·¸ë£¹ ì œí•œ. CloudTrailë¡œ ë³€ê²½ ì´ë ¥ ì¶”ì . |
| **8** | **ë„¤íŠ¸ì›Œí¬ ACL (NACL, Network Access Control List)** | ì„œë¸Œë„· ë ˆë²¨ì—ì„œ ì‘ë™í•˜ëŠ” **ë¬´ìƒíƒœí˜•(Stateless) ë°©í™”ë²½** ì…ë‹ˆë‹¤. ì¸ë°”ìš´ë“œ/ì•„ì›ƒë°”ìš´ë“œ ê·œì¹™ì„ ë²ˆí˜¸ ìˆœì„œëŒ€ë¡œ í‰ê°€í•˜ë©°, **Allowì™€ Deny ëª¨ë‘ ì •ì˜ ê°€ëŠ¥** í•©ë‹ˆë‹¤. ì‘ë‹µ íŠ¸ë˜í”½ë„ ëª…ì‹œì  ê·œì¹™ í•„ìš”. ì„œë¸Œë„· ê²½ê³„ì—ì„œ íŠ¸ë˜í”½ í•„í„°ë§. | **ì„œë¸Œë„· ë ˆë²¨ ë³´ì•ˆ ê³„ì¸µ** ìœ¼ë¡œ ë³´ì•ˆ ê·¸ë£¹ê³¼ í•¨ê»˜ ë‹¤ì¸µ ë°©ì–´ êµ¬í˜„. NACLë¡œ íŠ¹ì • IP ëŒ€ì—­ ì°¨ë‹¨(ì˜ˆ: ì•Œë ¤ì§„ ê³µê²© IP), ë³´ì•ˆ ê·¸ë£¹ìœ¼ë¡œ ì„¸ë°€í•œ ì œì–´. ê·œì¹™ ë²ˆí˜¸ëŠ” 10, 20, 30... ì‹ìœ¼ë¡œ ì¦ê°€ ê¶Œì¥(ì¤‘ê°„ ì‚½ì… ìš©ì´). Statelessì´ë¯€ë¡œ Ephemeral í¬íŠ¸(1024-65535) í—ˆìš© í•„ìš”. ê¸°ë³¸ NACLì€ ëª¨ë“  íŠ¸ë˜í”½ í—ˆìš©. |
| **9** | **VPC Peering** | **ë‘ VPC ê°„ í”„ë¼ì´ë¹— ë„¤íŠ¸ì›Œí¬ ì—°ê²°** ì„ ì œê³µí•©ë‹ˆë‹¤. AWS ë°±ë³¸ ë„¤íŠ¸ì›Œí¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ë‘ VPCê°€ ê°™ì€ ë„¤íŠ¸ì›Œí¬ì— ìˆëŠ” ê²ƒì²˜ëŸ¼ í†µì‹ . ë¦¬ì „ ê°„(Inter-Region) ë˜ëŠ” ê³„ì • ê°„(Cross-Account) Peering ê°€ëŠ¥. CIDR ë¸”ë¡ì´ ê²¹ì¹˜ë©´ ì•ˆ ë©ë‹ˆë‹¤. **ë¹„ì „ì´ì (Non-transitive)** : A-B, B-C Peering ì‹œ A-C ì§ì ‘ í†µì‹  ë¶ˆê°€. | **VPC ê°„ ì•ˆì „í•œ í†µì‹ ** ì„ ìœ„í•´ ì¸í„°ë„· ê²½ìœ  ë¶ˆí•„ìš”. ì˜ˆ: Production VPC â†” Shared Services VPC(DNS, AD). VPC Peering ì—°ê²° í›„ ê° VPCì˜ ë¼ìš°íŒ… í…Œì´ë¸”ì— ìƒëŒ€ VPC CIDR ì¶”ê°€ í•„ìˆ˜. ë³´ì•ˆ ê·¸ë£¹ì—ì„œ ìƒëŒ€ VPC ë³´ì•ˆ ê·¸ë£¹ ì°¸ì¡° ê°€ëŠ¥. ë‹¤ì¤‘ VPC ì—°ê²° ì‹œ í’€ ë©”ì‰¬ êµ¬ì„±ì€ ê´€ë¦¬ ë³µì¡(Transit Gateway ê¶Œì¥). |
| **10** | **AWS Transit Gateway** | **ì—¬ëŸ¬ VPCì™€ On-Premise ë„¤íŠ¸ì›Œí¬ë¥¼ ì¤‘ì•™ í—ˆë¸Œë¡œ ì—°ê²°** í•˜ëŠ” ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤. ìˆ˜ì²œ ê°œì˜ VPCë¥¼ í•˜ë‚˜ì˜ Transit Gatewayì— ì—°ê²° ê°€ëŠ¥í•˜ë©°, ë¼ìš°íŒ…ì„ ì¤‘ì•™ ì§‘ì¤‘ì‹ìœ¼ë¡œ ê´€ë¦¬. VPC Peeringì˜ í’€ ë©”ì‰¬ ë³µì¡ë„ í•´ê²°. ë¦¬ì „ ê°„ Transit Gateway Peering ì§€ì›. | **ëŒ€ê·œëª¨ ë„¤íŠ¸ì›Œí¬ ì•„í‚¤í…ì²˜** ì— í•„ìˆ˜ì…ë‹ˆë‹¤. ìˆ˜ì‹­ ê°œ ì´ìƒì˜ VPC ì—°ê²° ì‹œ Transit Gatewayë¡œ ë‹¨ìˆœí™”. ë„¤íŠ¸ì›Œí¬ ì„¸ë¶„í™”(Segmentation) ê°€ëŠ¥: ë¼ìš°íŒ… í…Œì´ë¸”ë¡œ VPC ê°„ í†µì‹  ì œì–´. VPN ì—°ê²°, Direct Connectë¥¼ Transit Gatewayì— ì—°ê²°í•˜ì—¬ í•˜ì´ë¸Œë¦¬ë“œ í´ë¼ìš°ë“œ êµ¬ì„±. CloudWatchë¡œ Transit Gateway íŠ¸ë˜í”½ ëª¨ë‹ˆí„°ë§. |
| **11** | **VPC Endpoint** | VPC ë‚´ ë¦¬ì†ŒìŠ¤ê°€ **ì¸í„°ë„· ê²Œì´íŠ¸ì›¨ì´, NAT, VPN ì—†ì´ AWS ì„œë¹„ìŠ¤ì— í”„ë¼ì´ë¹— ì—°ê²°** í•˜ëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤. **Interface Endpoint** (ENI ê¸°ë°˜, PrivateLink ì‚¬ìš©, ëŒ€ë¶€ë¶„ ì„œë¹„ìŠ¤ ì§€ì›)ì™€ **Gateway Endpoint** (S3, DynamoDBë§Œ ì§€ì›, ë¬´ë£Œ)ë¡œ êµ¬ë¶„. íŠ¸ë˜í”½ì´ AWS ë‚´ë¶€ë§ìœ¼ë¡œë§Œ íë¦…ë‹ˆë‹¤. | **ë³´ì•ˆ ë° ì„±ëŠ¥ í–¥ìƒ** ì„ ë™ì‹œì— ë‹¬ì„±. Private Subnetì—ì„œ S3 ì ‘ê·¼ ì‹œ NAT Gateway ë¹„ìš© ì ˆê°(Gateway Endpoint ë¬´ë£Œ). ë°ì´í„°ê°€ ì¸í„°ë„· ë…¸ì¶œ ì—†ì´ AWS ë°±ë³¸ìœ¼ë¡œë§Œ ì „ì†¡ë˜ì–´ ì•ˆì „. VPC Endpoint ì •ì±…ìœ¼ë¡œ ì ‘ê·¼ ì œì–´ ê°€ëŠ¥(íŠ¹ì • S3 ë²„í‚·ë§Œ í—ˆìš©). ê·œì œ ì¤€ìˆ˜(ë°ì´í„° ë¡œì»¬ë¦¬í‹°) ìš”êµ¬ì‚¬í•­ ì¶©ì¡±. |
| **12** | **VPN (Virtual Private Network)** | On-Premise ë„¤íŠ¸ì›Œí¬ì™€ AWS VPCë¥¼ **ì•”í˜¸í™”ëœ í„°ë„ë¡œ ì—°ê²°** í•©ë‹ˆë‹¤. **Site-to-Site VPN** (On-Premise ë¼ìš°í„° â†” AWS VGW)ê³¼ **Client VPN** (ê°œë³„ ì‚¬ìš©ì â†” VPC) ì œê³µ. IPsec í”„ë¡œí† ì½œ ì‚¬ìš©. ì¸í„°ë„· ê²½ìœ í•˜ë¯€ë¡œ ëŒ€ì—­í­/ì§€ì—°ì‹œê°„ ë³€ë™ ê°€ëŠ¥. | **í•˜ì´ë¸Œë¦¬ë“œ í´ë¼ìš°ë“œ** êµ¬ì¶•ì˜ ê¸°ë³¸ì…ë‹ˆë‹¤. ë¹ ë¥¸ êµ¬ì¶•(ëª‡ ì‹œê°„), ì €ë ´í•œ ë¹„ìš©(Direct Connect ëŒ€ë¹„), ìœ ì—°ì„±(í•„ìš” ì‹œ ì¦‰ì‹œ ì„¤ì •/í•´ì œ). ê³ ê°€ìš©ì„± ìœ„í•´ ë‘ ê°œì˜ VPN í„°ë„ ìë™ ìƒì„±. BGP(Border Gateway Protocol) ì§€ì›ìœ¼ë¡œ ë™ì  ë¼ìš°íŒ… ê°€ëŠ¥. ë‹¨, ëŒ€ìš©ëŸ‰/ì €ì§€ì—° ìš”êµ¬ ì‹œ Direct Connect ê¶Œì¥. |
| **13** | **AWS Direct Connect** | On-Premiseì™€ AWS ê°„ **ì „ìš© ë¬¼ë¦¬ì  ë„¤íŠ¸ì›Œí¬ ì—°ê²°** ì„ ì œê³µí•©ë‹ˆë‹¤. ì¸í„°ë„·ì„ ê²½ìœ í•˜ì§€ ì•Šì•„ ì¼ê´€ëœ ë„¤íŠ¸ì›Œí¬ ì„±ëŠ¥, ë†’ì€ ëŒ€ì—­í­(1Gbps ~ 100Gbps), ë‚®ì€ ì§€ì—°ì‹œê°„ ì œê³µ. Direct Connect Location(AWS íŒŒíŠ¸ë„ˆ ë°ì´í„°ì„¼í„°)ì—ì„œ AWS ë¦¬ì „ìœ¼ë¡œ ì—°ê²°. | **ì—”í„°í”„ë¼ì´ì¦ˆê¸‰ í•˜ì´ë¸Œë¦¬ë“œ í´ë¼ìš°ë“œ** ì— í•„ìˆ˜ì…ë‹ˆë‹¤. ëŒ€ìš©ëŸ‰ ë°ì´í„° ì „ì†¡(ì˜ˆ: ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜, ë°±ì—…, ë¹…ë°ì´í„° ë¶„ì„), ì‹¤ì‹œê°„ ì• í”Œë¦¬ì¼€ì´ì…˜(ì˜ˆ: í™”ìƒíšŒì˜, HPC)ì— ì í•©. ë³´ì•ˆ: íŠ¸ë˜í”½ì´ í¼ë¸”ë¦­ ì¸í„°ë„· ë…¸ì¶œ ì•ˆ ë¨. ë¹„ìš©: ì´ˆê¸° êµ¬ì¶• ë¹„ìš© ë†’ì§€ë§Œ ì¥ê¸°ì ìœ¼ë¡œ ë°ì´í„° ì „ì†¡ ë¹„ìš© ì ˆê°. Direct Connect Gatewayë¡œ ì—¬ëŸ¬ VPC ì—°ê²° ê°€ëŠ¥. |

---

## 2. ì‹¤ìŠµ ì½”ë“œ & ì‘ìš© (Practice & Code Walkthrough)

### (A) VPC ìƒì„± ë° ê¸°ë³¸ êµ¬ì„±

**VPC ìƒì„± (Console):**
```
1. AWS Console â†’ VPC ì„œë¹„ìŠ¤ë¡œ ì´ë™
2. "VPC ìƒì„±(Create VPC)" í´ë¦­
3. VPC ì„¤ì •:
   - ë¦¬ì†ŒìŠ¤: VPC ì „ìš© (ë˜ëŠ” VPC ë“±ì„ ì„ íƒí•˜ì—¬ ìë™ ìƒì„±)
   - ì´ë¦„ íƒœê·¸: my-vpc
   - IPv4 CIDR ë¸”ë¡: 10.0.0.0/16 (65,536ê°œ IP)
   - IPv6 CIDR ë¸”ë¡: IPv6 CIDR ë¸”ë¡ ì—†ìŒ
   - í…Œë„Œì‹œ: ê¸°ë³¸ê°’
4. VPC ìƒì„± ì™„ë£Œ
```

**VPC ìƒì„± (AWS CLI):**
```bash
# VPC ìƒì„±
aws ec2 create-vpc \
  --cidr-block 10.0.0.0/16 \
  --tag-specifications 'ResourceType=vpc,Tags=[{Key=Name,Value=my-vpc}]'

# ì¶œë ¥: VPC ID í™•ì¸ (ì˜ˆ: vpc-0abcd1234efgh5678)

# VPC ì •ë³´ ì¡°íšŒ
aws ec2 describe-vpcs --vpc-ids vpc-0abcd1234efgh5678

# DNS í˜¸ìŠ¤íŠ¸ ì´ë¦„ í™œì„±í™” (ì¤‘ìš”: EC2 ì¸ìŠ¤í„´ìŠ¤ì— DNS ì´ë¦„ ë¶€ì—¬)
aws ec2 modify-vpc-attribute \
  --vpc-id vpc-0abcd1234efgh5678 \
  --enable-dns-hostnames
```

**CIDR ê³„ì‚° ì˜ˆì‹œ:**
```
10.0.0.0/16:
- ë„¤íŠ¸ì›Œí¬ ë¶€ë¶„: 10.0 (16ë¹„íŠ¸ ê³ ì •)
- í˜¸ìŠ¤íŠ¸ ë¶€ë¶„: 0.0 ~ 255.255 (16ë¹„íŠ¸ ê°€ë³€)
- IP ë²”ìœ„: 10.0.0.0 ~ 10.0.255.255
- ì‚¬ìš© ê°€ëŠ¥ IP: 65,536ê°œ - 5ê°œ(AWS ì˜ˆì•½) = 65,531ê°œ

10.0.1.0/24:
- ë„¤íŠ¸ì›Œí¬ ë¶€ë¶„: 10.0.1 (24ë¹„íŠ¸ ê³ ì •)
- í˜¸ìŠ¤íŠ¸ ë¶€ë¶„: 0 ~ 255 (8ë¹„íŠ¸ ê°€ë³€)
- IP ë²”ìœ„: 10.0.1.0 ~ 10.0.1.255
- ì‚¬ìš© ê°€ëŠ¥ IP: 256ê°œ - 5ê°œ(AWS ì˜ˆì•½) = 251ê°œ

AWS ì˜ˆì•½ IP (ê° ì„œë¸Œë„·ë§ˆë‹¤):
- 10.0.1.0: ë„¤íŠ¸ì›Œí¬ ì£¼ì†Œ
- 10.0.1.1: VPC ë¼ìš°í„°
- 10.0.1.2: DNS ì„œë²„
- 10.0.1.3: í–¥í›„ ì‚¬ìš© ì˜ˆì•½
- 10.0.1.255: ë¸Œë¡œë“œìºìŠ¤íŠ¸ ì£¼ì†Œ (VPCì—ì„œëŠ” ë¯¸ì§€ì›ì´ì§€ë§Œ ì˜ˆì•½)
```

### (B) ì„œë¸Œë„· ìƒì„± (Public & Private)

**Public Subnet ìƒì„±:**
```bash
# Public Subnet 1 (AZ-A)
aws ec2 create-subnet \
  --vpc-id vpc-0abcd1234efgh5678 \
  --cidr-block 10.0.1.0/24 \
  --availability-zone ap-northeast-2a \
  --tag-specifications 'ResourceType=subnet,Tags=[{Key=Name,Value=public-subnet-1}]'

# Public Subnet 2 (AZ-C, ê³ ê°€ìš©ì„±)
aws ec2 create-subnet \
  --vpc-id vpc-0abcd1234efgh5678 \
  --cidr-block 10.0.2.0/24 \
  --availability-zone ap-northeast-2c \
  --tag-specifications 'ResourceType=subnet,Tags=[{Key=Name,Value=public-subnet-2}]'

# Public IP ìë™ í• ë‹¹ í™œì„±í™”
aws ec2 modify-subnet-attribute \
  --subnet-id subnet-0xyz123 \
  --map-public-ip-on-launch
```

**Private Subnet ìƒì„±:**
```bash
# Private Subnet 1 (AZ-A)
aws ec2 create-subnet \
  --vpc-id vpc-0abcd1234efgh5678 \
  --cidr-block 10.0.11.0/24 \
  --availability-zone ap-northeast-2a \
  --tag-specifications 'ResourceType=subnet,Tags=[{Key=Name,Value=private-subnet-1}]'

# Private Subnet 2 (AZ-C)
aws ec2 create-subnet \
  --vpc-id vpc-0abcd1234efgh5678 \
  --cidr-block 10.0.12.0/24 \
  --availability-zone ap-northeast-2c \
  --tag-specifications 'ResourceType=subnet,Tags=[{Key=Name,Value=private-subnet-2}]'
```

**ì„œë¸Œë„· ì„¤ê³„ ì˜ˆì‹œ:**
```
VPC: 10.0.0.0/16

Public Subnets (ì¸í„°ë„· ì—°ê²°):
- 10.0.1.0/24 (ap-northeast-2a) â†’ ì›¹ ì„œë²„, ë¡œë“œ ë°¸ëŸ°ì„œ
- 10.0.2.0/24 (ap-northeast-2c) â†’ ì›¹ ì„œë²„, ë¡œë“œ ë°¸ëŸ°ì„œ

Private Subnets (ì• í”Œë¦¬ì¼€ì´ì…˜):
- 10.0.11.0/24 (ap-northeast-2a) â†’ ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë²„
- 10.0.12.0/24 (ap-northeast-2c) â†’ ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë²„

Private Subnets (ë°ì´í„°ë² ì´ìŠ¤):
- 10.0.21.0/24 (ap-northeast-2a) â†’ RDS, ElastiCache
- 10.0.22.0/24 (ap-northeast-2c) â†’ RDS, ElastiCache

Reserved:
- 10.0.0.0/24 â†’ í–¥í›„ í™•ì¥ìš©
- 10.0.255.0/24 â†’ ê´€ë¦¬ ë„¤íŠ¸ì›Œí¬ (Bastion Host ë“±)
```

### (C) ì¸í„°ë„· ê²Œì´íŠ¸ì›¨ì´ ë° NAT Gateway ì„¤ì •

**ì¸í„°ë„· ê²Œì´íŠ¸ì›¨ì´ (IGW) ì„¤ì •:**
```bash
# IGW ìƒì„±
aws ec2 create-internet-gateway \
  --tag-specifications 'ResourceType=internet-gateway,Tags=[{Key=Name,Value=my-igw}]'

# ì¶œë ¥: igw-0abc123def456789

# VPCì— IGW ì—°ê²°
aws ec2 attach-internet-gateway \
  --internet-gateway-id igw-0abc123def456789 \
  --vpc-id vpc-0abcd1234efgh5678

# IGW í™•ì¸
aws ec2 describe-internet-gateways --internet-gateway-ids igw-0abc123def456789
```

**NAT Gateway ì„¤ì •:**
```bash
# 1. Public Subnetì— Elastic IP í• ë‹¹
aws ec2 allocate-address --domain vpc
# ì¶œë ¥: AllocationId: eipalloc-0xyz123

# 2. NAT Gateway ìƒì„± (Public Subnetì— ë°°ì¹˜)
aws ec2 create-nat-gateway \
  --subnet-id subnet-0xyz123 \
  --allocation-id eipalloc-0xyz123 \
  --tag-specifications 'ResourceType=nat-gateway,Tags=[{Key=Name,Value=my-nat-gateway}]'

# ì¶œë ¥: nat-0abc123def (ìƒíƒœ: pending â†’ availableê¹Œì§€ ëŒ€ê¸°)

# NAT Gateway ìƒíƒœ í™•ì¸
aws ec2 describe-nat-gateways --nat-gateway-ids nat-0abc123def

# ê³ ê°€ìš©ì„±: ê° AZë§ˆë‹¤ NAT Gateway ìƒì„± ê¶Œì¥
# AZ-Cìš© NAT Gatewayë„ ë™ì¼í•˜ê²Œ ìƒì„±
```

### (D) ë¼ìš°íŒ… í…Œì´ë¸” êµ¬ì„±

**Public Subnet ë¼ìš°íŒ… í…Œì´ë¸”:**
```bash
# ë¼ìš°íŒ… í…Œì´ë¸” ìƒì„±
aws ec2 create-route-table \
  --vpc-id vpc-0abcd1234efgh5678 \
  --tag-specifications 'ResourceType=route-table,Tags=[{Key=Name,Value=public-rt}]'

# ì¶œë ¥: rtb-0public123

# ì¸í„°ë„· ê²Œì´íŠ¸ì›¨ì´ë¡œ ê°€ëŠ” ê¸°ë³¸ ê²½ë¡œ ì¶”ê°€
aws ec2 create-route \
  --route-table-id rtb-0public123 \
  --destination-cidr-block 0.0.0.0/0 \
  --gateway-id igw-0abc123def456789

# Public Subnetê³¼ ë¼ìš°íŒ… í…Œì´ë¸” ì—°ê²°
aws ec2 associate-route-table \
  --route-table-id rtb-0public123 \
  --subnet-id subnet-0xyz123  # public-subnet-1

aws ec2 associate-route-table \
  --route-table-id rtb-0public123 \
  --subnet-id subnet-0xyz456  # public-subnet-2

# ë¼ìš°íŒ… í…Œì´ë¸” í™•ì¸
aws ec2 describe-route-tables --route-table-ids rtb-0public123
```

**Private Subnet ë¼ìš°íŒ… í…Œì´ë¸”:**
```bash
# Private ë¼ìš°íŒ… í…Œì´ë¸” ìƒì„±
aws ec2 create-route-table \
  --vpc-id vpc-0abcd1234efgh5678 \
  --tag-specifications 'ResourceType=route-table,Tags=[{Key=Name,Value=private-rt}]'

# ì¶œë ¥: rtb-0private456

# NAT Gatewayë¡œ ê°€ëŠ” ê¸°ë³¸ ê²½ë¡œ ì¶”ê°€
aws ec2 create-route \
  --route-table-id rtb-0private456 \
  --destination-cidr-block 0.0.0.0/0 \
  --nat-gateway-id nat-0abc123def

# Private Subnetê³¼ ì—°ê²°
aws ec2 associate-route-table \
  --route-table-id rtb-0private456 \
  --subnet-id subnet-0private111  # private-subnet-1

aws ec2 associate-route-table \
  --route-table-id rtb-0private456 \
  --subnet-id subnet-0private222  # private-subnet-2
```

**ë¼ìš°íŒ… í…Œì´ë¸” êµ¬ì¡° ì˜ˆì‹œ:**
```
Public Route Table (rtb-0public123):
+-----------------------+---------------------+--------+
| Destination           | Target              | Status |
+-----------------------+---------------------+--------+
| 10.0.0.0/16           | local               | Active |
| 0.0.0.0/0             | igw-0abc123         | Active |
+-----------------------+---------------------+--------+

Private Route Table (rtb-0private456):
+-----------------------+---------------------+--------+
| Destination           | Target              | Status |
+-----------------------+---------------------+--------+
| 10.0.0.0/16           | local               | Active |
| 0.0.0.0/0             | nat-0abc123         | Active |
+-----------------------+---------------------+--------+

í•´ì„:
- 10.0.0.0/16 â†’ local: VPC ë‚´ë¶€ íŠ¸ë˜í”½ì€ ë¡œì»¬ ë¼ìš°íŒ…
- 0.0.0.0/0 â†’ igw/nat: ì™¸ë¶€ ì¸í„°ë„· íŠ¸ë˜í”½ ê²½ë¡œ
```

### (E) ë³´ì•ˆ ê·¸ë£¹ ë° NACL ì„¤ì •

**ë³´ì•ˆ ê·¸ë£¹ ìƒì„± (ì›¹ ì„œë²„ìš©):**
```bash
# ë³´ì•ˆ ê·¸ë£¹ ìƒì„±
aws ec2 create-security-group \
  --group-name web-server-sg \
  --description "Security group for web servers" \
  --vpc-id vpc-0abcd1234efgh5678

# ì¶œë ¥: sg-0web123

# HTTP ì¸ë°”ìš´ë“œ í—ˆìš© (ì „ì²´ ì¸í„°ë„·ì—ì„œ)
aws ec2 authorize-security-group-ingress \
  --group-id sg-0web123 \
  --protocol tcp \
  --port 80 \
  --cidr 0.0.0.0/0

# HTTPS ì¸ë°”ìš´ë“œ í—ˆìš©
aws ec2 authorize-security-group-ingress \
  --group-id sg-0web123 \
  --protocol tcp \
  --port 443 \
  --cidr 0.0.0.0/0

# SSH ì¸ë°”ìš´ë“œ í—ˆìš© (íŠ¹ì • IPë§Œ)
aws ec2 authorize-security-group-ingress \
  --group-id sg-0web123 \
  --protocol tcp \
  --port 22 \
  --cidr 203.0.113.0/24

# ë³´ì•ˆ ê·¸ë£¹ ê·œì¹™ í™•ì¸
aws ec2 describe-security-groups --group-ids sg-0web123
```

**ë³´ì•ˆ ê·¸ë£¹ ìƒì„± (ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë²„ìš©):**
```bash
# ì• í”Œë¦¬ì¼€ì´ì…˜ ë³´ì•ˆ ê·¸ë£¹ ìƒì„±
aws ec2 create-security-group \
  --group-name app-server-sg \
  --description "Security group for app servers" \
  --vpc-id vpc-0abcd1234efgh5678

# ì¶œë ¥: sg-0app456

# ì›¹ ì„œë²„ ë³´ì•ˆ ê·¸ë£¹ì—ì„œë§Œ ì ‘ê·¼ í—ˆìš© (ë³´ì•ˆ ê·¸ë£¹ ì°¸ì¡°)
aws ec2 authorize-security-group-ingress \
  --group-id sg-0app456 \
  --protocol tcp \
  --port 8080 \
  --source-group sg-0web123

# ë³´ì•ˆ ê·¸ë£¹ ê°„ ì°¸ì¡° ì¥ì :
# - IP ë³€ê²½ ì‹œì—ë„ ìë™ìœ¼ë¡œ ì—…ë°ì´íŠ¸
# - ë” ëª…í™•í•œ íŠ¸ë˜í”½ ì œì–´
```

**NACL ì„¤ì •:**
```bash
# NACL ìƒì„±
aws ec2 create-network-acl \
  --vpc-id vpc-0abcd1234efgh5678 \
  --tag-specifications 'ResourceType=network-acl,Tags=[{Key=Name,Value=public-nacl}]'

# ì¶œë ¥: acl-0nacl123

# ì¸ë°”ìš´ë“œ ê·œì¹™ ì¶”ê°€
# ê·œì¹™ 100: HTTP í—ˆìš©
aws ec2 create-network-acl-entry \
  --network-acl-id acl-0nacl123 \
  --rule-number 100 \
  --protocol tcp \
  --port-range From=80,To=80 \
  --cidr-block 0.0.0.0/0 \
  --rule-action allow \
  --ingress

# ê·œì¹™ 110: HTTPS í—ˆìš©
aws ec2 create-network-acl-entry \
  --network-acl-id acl-0nacl123 \
  --rule-number 110 \
  --protocol tcp \
  --port-range From=443,To=443 \
  --cidr-block 0.0.0.0/0 \
  --rule-action allow \
  --ingress

# ê·œì¹™ 120: SSH í—ˆìš© (íŠ¹ì • IP)
aws ec2 create-network-acl-entry \
  --network-acl-id acl-0nacl123 \
  --rule-number 120 \
  --protocol tcp \
  --port-range From=22,To=22 \
  --cidr-block 203.0.113.0/24 \
  --rule-action allow \
  --ingress

# ê·œì¹™ 130: Ephemeral í¬íŠ¸ í—ˆìš© (ì‘ë‹µ íŠ¸ë˜í”½ìš©)
aws ec2 create-network-acl-entry \
  --network-acl-id acl-0nacl123 \
  --rule-number 130 \
  --protocol tcp \
  --port-range From=1024,To=65535 \
  --cidr-block 0.0.0.0/0 \
  --rule-action allow \
  --ingress

# ì•„ì›ƒë°”ìš´ë“œ ê·œì¹™: ëª¨ë“  íŠ¸ë˜í”½ í—ˆìš© (ê°„ë‹¨íˆ)
aws ec2 create-network-acl-entry \
  --network-acl-id acl-0nacl123 \
  --rule-number 100 \
  --protocol -1 \
  --cidr-block 0.0.0.0/0 \
  --rule-action allow \
  --egress

# ì„œë¸Œë„·ê³¼ NACL ì—°ê²°
aws ec2 replace-network-acl-association \
  --association-id aclassoc-0xyz \
  --network-acl-id acl-0nacl123
```

**ë³´ì•ˆ ê·¸ë£¹ vs NACL ë¹„êµ:**
```
+-------------------+-------------------+-------------------+
| íŠ¹ì„±              | ë³´ì•ˆ ê·¸ë£¹         | NACL              |
+-------------------+-------------------+-------------------+
| ì‘ë™ ë ˆë²¨         | ì¸ìŠ¤í„´ìŠ¤          | ì„œë¸Œë„·            |
| ìƒíƒœ              | Stateful          | Stateless         |
| ê·œì¹™ íƒ€ì…         | Allowë§Œ           | Allow + Deny      |
| ê·œì¹™ í‰ê°€         | ëª¨ë“  ê·œì¹™ í‰ê°€    | ë²ˆí˜¸ ìˆœì„œëŒ€ë¡œ     |
| ì‘ë‹µ íŠ¸ë˜í”½       | ìë™ í—ˆìš©         | ëª…ì‹œì  ê·œì¹™ í•„ìš”  |
| ê¸°ë³¸ ì„¤ì •         | ëª¨ë“  íŠ¸ë˜í”½ ì°¨ë‹¨  | ëª¨ë“  íŠ¸ë˜í”½ í—ˆìš©  |
+-------------------+-------------------+-------------------+

ë°©ì–´ ì „ëµ:
1. NACL: ì„œë¸Œë„· ê²½ê³„ ë°©ì–´ (ê±°ì¹œ í•„í„°ë§, IP ëŒ€ì—­ ì°¨ë‹¨)
2. ë³´ì•ˆ ê·¸ë£¹: ì¸ìŠ¤í„´ìŠ¤ ì„¸ë°€í•œ ì œì–´ (í¬íŠ¸ë³„, ì†ŒìŠ¤ë³„)
```

### (F) VPC Peering ì„¤ì •

**VPC Peering ì—°ê²°:**
```bash
# VPC Peering ìš”ì²­ ìƒì„± (VPC-A â†’ VPC-B)
aws ec2 create-vpc-peering-connection \
  --vpc-id vpc-aaaaa \
  --peer-vpc-id vpc-bbbbb \
  --peer-region ap-northeast-2 \
  --tag-specifications 'ResourceType=vpc-peering-connection,Tags=[{Key=Name,Value=vpc-a-to-vpc-b}]'

# ì¶œë ¥: pcx-0peering123 (ìƒíƒœ: pending-acceptance)

# VPC-Bì—ì„œ Peering ìš”ì²­ ìˆ˜ë½
aws ec2 accept-vpc-peering-connection \
  --vpc-peering-connection-id pcx-0peering123

# Peering ìƒíƒœ í™•ì¸
aws ec2 describe-vpc-peering-connections \
  --vpc-peering-connection-ids pcx-0peering123
```

**ë¼ìš°íŒ… í…Œì´ë¸” ì—…ë°ì´íŠ¸ (ì–‘ë°©í–¥):**
```bash
# VPC-Aì˜ ë¼ìš°íŒ… í…Œì´ë¸”: VPC-B CIDR â†’ Peering ì—°ê²°
aws ec2 create-route \
  --route-table-id rtb-vpc-a \
  --destination-cidr-block 10.1.0.0/16 \
  --vpc-peering-connection-id pcx-0peering123

# VPC-Bì˜ ë¼ìš°íŒ… í…Œì´ë¸”: VPC-A CIDR â†’ Peering ì—°ê²°
aws ec2 create-route \
  --route-table-id rtb-vpc-b \
  --destination-cidr-block 10.0.0.0/16 \
  --vpc-peering-connection-id pcx-0peering123
```

**ë³´ì•ˆ ê·¸ë£¹ ì—…ë°ì´íŠ¸:**
```bash
# VPC-A ë³´ì•ˆ ê·¸ë£¹: VPC-B ë³´ì•ˆ ê·¸ë£¹ì—ì„œ ì ‘ê·¼ í—ˆìš©
aws ec2 authorize-security-group-ingress \
  --group-id sg-vpc-a \
  --protocol tcp \
  --port 3306 \
  --source-group sg-vpc-b \
  --group-owner-id 123456789012  # VPC-B ê³„ì • ID
```

### (G) VPC Endpoint ì„¤ì • (S3)

**Gateway Endpoint ìƒì„± (S3, DynamoDB):**
```bash
# S3 Gateway Endpoint ìƒì„±
aws ec2 create-vpc-endpoint \
  --vpc-id vpc-0abcd1234efgh5678 \
  --service-name com.amazonaws.ap-northeast-2.s3 \
  --route-table-ids rtb-0private456 \
  --tag-specifications 'ResourceType=vpc-endpoint,Tags=[{Key=Name,Value=s3-gateway-endpoint}]'

# ìë™ìœ¼ë¡œ ë¼ìš°íŒ… í…Œì´ë¸”ì— ê²½ë¡œ ì¶”ê°€ë¨:
# pl-78a54011 (S3 Prefix List) â†’ vpce-0s3gateway

# Endpoint í™•ì¸
aws ec2 describe-vpc-endpoints --vpc-endpoint-ids vpce-0s3gateway
```

**Interface Endpoint ìƒì„± (ë‹¤ë¥¸ AWS ì„œë¹„ìŠ¤):**
```bash
# EC2 APIìš© Interface Endpoint
aws ec2 create-vpc-endpoint \
  --vpc-id vpc-0abcd1234efgh5678 \
  --service-name com.amazonaws.ap-northeast-2.ec2 \
  --vpc-endpoint-type Interface \
  --subnet-ids subnet-0private111 subnet-0private222 \
  --security-group-ids sg-0endpoint \
  --private-dns-enabled \
  --tag-specifications 'ResourceType=vpc-endpoint,Tags=[{Key=Name,Value=ec2-interface-endpoint}]'

# Interface EndpointëŠ” ENI(Elastic Network Interface) ìƒì„±
# Private IP í• ë‹¹, DNS í•´ì„ìœ¼ë¡œ ì ‘ê·¼ (ì˜ˆ: ec2.ap-northeast-2.amazonaws.com)
```

**VPC Endpoint ì •ì±…:**
```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Principal": "*",
      "Action": [
        "s3:GetObject",
        "s3:PutObject"
      ],
      "Resource": [
        "arn:aws:s3:::my-secure-bucket/*"
      ]
    }
  ]
}
```

### (H) ì‹¤ìŠµ ì‹œë‚˜ë¦¬ì˜¤: ì™„ì „í•œ VPC ë„¤íŠ¸ì›Œí¬ êµ¬ì„±

**ëª©í‘œ: ê³ ê°€ìš©ì„± ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ì•„í‚¤í…ì²˜**

```
ì¸í„°ë„·
    |
    | (IGW)
    |
+---+-----------------------------------+
|   VPC: 10.0.0.0/16                  |
|                                      |
|   [Public Subnet 1: 10.0.1.0/24]   |
|     - ALB (Application Load Balancer) AZ-A
|     - NAT Gateway 1                 |
|                                      |
|   [Public Subnet 2: 10.0.2.0/24]   |
|     - ALB AZ-C                      |
|     - NAT Gateway 2                 |
|                                      |
|   [Private Subnet 1: 10.0.11.0/24]  |
|     - Web Server 1 (EC2) AZ-A      |
|                                      |
|   [Private Subnet 2: 10.0.12.0/24]  |
|     - Web Server 2 (EC2) AZ-C      |
|                                      |
|   [Private Subnet 3: 10.0.21.0/24]  |
|     - RDS Primary (AZ-A)            |
|                                      |
|   [Private Subnet 4: 10.0.22.0/24]  |
|     - RDS Standby (AZ-C)            |
+--------------------------------------+
```

**ë‹¨ê³„ë³„ êµ¬ì„±:**

```bash
# 1. VPC ìƒì„±
aws ec2 create-vpc --cidr-block 10.0.0.0/16

# 2. ì„œë¸Œë„· ìƒì„± (6ê°œ)
# Public: 10.0.1.0/24 (AZ-A), 10.0.2.0/24 (AZ-C)
# Private App: 10.0.11.0/24 (AZ-A), 10.0.12.0/24 (AZ-C)
# Private DB: 10.0.21.0/24 (AZ-A), 10.0.22.0/24 (AZ-C)

# 3. IGW ìƒì„± ë° ì—°ê²°

# 4. NAT Gateway ìƒì„± (ê° AZë§ˆë‹¤)

# 5. ë¼ìš°íŒ… í…Œì´ë¸” êµ¬ì„±
# - Public RT: 0.0.0.0/0 â†’ IGW
# - Private RT (AZ-A): 0.0.0.0/0 â†’ NAT GW 1
# - Private RT (AZ-C): 0.0.0.0/0 â†’ NAT GW 2

# 6. ë³´ì•ˆ ê·¸ë£¹ ìƒì„±
# - ALB SG: 0.0.0.0/0:80, 443 í—ˆìš©
# - Web SG: ALB SGì—ì„œë§Œ ì ‘ê·¼ í—ˆìš©
# - DB SG: Web SGì—ì„œë§Œ 3306 í—ˆìš©

# 7. EC2 ì¸ìŠ¤í„´ìŠ¤ ë°°í¬ (Auto Scaling Group)
# 8. RDS ë°°í¬ (Multi-AZ)
# 9. S3 Gateway Endpoint ìƒì„±
```

---

## 3. ì‹¤ë¬´/ë³´ì•ˆ ê´€ì  ë¶„ì„ (Insight & Scenario Mapping)

| ë¶„ì•¼ | ì ìš© ì‹œë‚˜ë¦¬ì˜¤ |
|:---:|:---|
| **ë„¤íŠ¸ì›Œí¬ ì•„í‚¤í…ì²˜ ì„¤ê³„** | **ë‹¤ì¸µ ë°©ì–´ êµ¬ì¡°** : Public Subnet(ALB/Bastion) â†’ Private Subnet(App Server) â†’ Private Subnet(Database)ë¡œ ê³„ì¸µ ë¶„ë¦¬. ê³µê²©ìê°€ DMZë¥¼ ì¹¨íˆ¬í•´ë„ ë‚´ë¶€ë§ ì ‘ê·¼ ì°¨ë‹¨. **ê³ ê°€ìš©ì„± ì„¤ê³„** : ìµœì†Œ 2ê°œ AZì— ë¦¬ì†ŒìŠ¤ ë¶„ì‚° ë°°ì¹˜. ê° AZë§ˆë‹¤ NAT Gateway êµ¬ì„±ìœ¼ë¡œ AZ ì¥ì•  ì‹œì—ë„ ë‹¤ë¥¸ AZì—ì„œ ì¸í„°ë„· ì ‘ì† ê°€ëŠ¥. ALBëŠ” ìë™ìœ¼ë¡œ ì—¬ëŸ¬ AZì— ë°°í¬. **IP ì£¼ì†Œ ê´€ë¦¬** : VPC CIDRì€ ë³€ê²½ ë¶ˆê°€í•˜ë¯€ë¡œ ì´ˆê¸° ì„¤ê³„ ì‹œ ì¶©ë¶„í•œ IP í™•ë³´(/16 ê¶Œì¥). ì„œë¸Œë„·ì€ /24ë¡œ ë¶„í• í•˜ì—¬ 256ê°œ IPì”© í• ë‹¹. í–¥í›„ í™•ì¥ì„ ìœ„í•´ CIDR ì¼ë¶€ ì˜ˆì•½. **ë„¤íŠ¸ì›Œí¬ í† í´ë¡œì§€** : Hub-and-Spoke(Transit Gateway ì¤‘ì‹¬) ë˜ëŠ” Mesh(VPC Peering) ì„ íƒ. ëŒ€ê·œëª¨ëŠ” Transit Gatewayë¡œ ì¤‘ì•™ ì§‘ì¤‘. |
| **ë³´ì•ˆ ê°•í™” ì „ëµ** | **ìµœì†Œ ê¶Œí•œ ë„¤íŠ¸ì›Œí¬ ì ‘ê·¼** : ë³´ì•ˆ ê·¸ë£¹ì€ í•„ìš”í•œ í¬íŠ¸ì™€ ì†ŒìŠ¤ë§Œ í—ˆìš©(SSHëŠ” Bastionì—ì„œë§Œ). NACLë¡œ ì•Œë ¤ì§„ ê³µê²© IP ëŒ€ì—­ ì°¨ë‹¨. **Bastion Host íŒ¨í„´** : Private Subnet EC2ëŠ” ì§ì ‘ SSH ë¶ˆê°€. Public Subnetì— Bastion Host ë°°ì¹˜ â†’ ì—¬ê¸°ì„œë§Œ Private EC2 ì ‘ì†. Bastion ë³´ì•ˆ ê·¸ë£¹: ê´€ë¦¬ì IPë§Œ SSH í—ˆìš©. **VPC Flow Logs** : ëª¨ë“  ë„¤íŠ¸ì›Œí¬ íŠ¸ë˜í”½ ë¡œê·¸ë¥¼ S3 ë˜ëŠ” CloudWatchì— ì €ì¥. ì˜ì‹¬ìŠ¤ëŸ¬ìš´ íŠ¸ë˜í”½ íŒ¨í„´ ë¶„ì„, í¬íŠ¸ ìŠ¤ìº” íƒì§€, ë°ì´í„° ìœ ì¶œ ì¶”ì . Athenaë¡œ SQL ì¿¼ë¦¬ ë¶„ì„. **AWS Network Firewall** : Suricata í˜¸í™˜ IDS/IPS ê¸°ëŠ¥. VPC ê²½ê³„ì— ë°°ì¹˜í•˜ì—¬ ì• í”Œë¦¬ì¼€ì´ì…˜ ë ˆë²¨ ê³µê²©(SQL Injection, DDoS) ì°¨ë‹¨. ë³´ì•ˆ ê·¸ë£¹/NACLë³´ë‹¤ ê³ ê¸‰ í•„í„°ë§. **ì•”í˜¸í™” ì „ì†¡** : VPN/Direct ConnectëŠ” IPsec ì•”í˜¸í™”. TLS 1.2+ ê°•ì œ(ALB Listener ì •ì±…). PrivateLink(VPC Endpoint)ë¡œ AWS ì„œë¹„ìŠ¤ íŠ¸ë˜í”½ ì•”í˜¸í™”. |
| **í•˜ì´ë¸Œë¦¬ë“œ í´ë¼ìš°ë“œ** | **VPN ì—°ê²°** : On-Premise ë°ì´í„°ì„¼í„°ì™€ VPCë¥¼ Site-to-Site VPNìœ¼ë¡œ ì—°ê²°. ì´ˆê¸° í´ë¼ìš°ë“œ ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹œ ë¹ ë¥´ê²Œ êµ¬ì¶•. BGP ë™ì  ë¼ìš°íŒ…ìœ¼ë¡œ ìë™ ê²½ë¡œ ì—…ë°ì´íŠ¸. ê³ ê°€ìš©ì„±: ë‘ ê°œì˜ í„°ë„ ìë™ ìƒì„±. ë¹„ìš© íš¨ìœ¨ì ì´ì§€ë§Œ ëŒ€ì—­í­/ì§€ì—°ì‹œê°„ ì œí•œ. **Direct Connect** : ì „ìš©ì„ ìœ¼ë¡œ On-Premiseì™€ AWS ì—°ê²°. ì¼ê´€ëœ ë„¤íŠ¸ì›Œí¬ ì„±ëŠ¥, ëŒ€ìš©ëŸ‰ ë°ì´í„° ì „ì†¡(ìˆ˜ì‹­ TB ë°±ì—…, ë¹…ë°ì´í„° ë¶„ì„), ë‚®ì€ ì§€ì—°ì‹œê°„(ì‹¤ì‹œê°„ ì• í”Œë¦¬ì¼€ì´ì…˜). Direct Connect Gatewayë¡œ ì—¬ëŸ¬ VPC/ë¦¬ì „ ì—°ê²°. LAG(Link Aggregation Group)ë¡œ ëŒ€ì—­í­ ì¦ê°€. **Transit Gateway í™œìš©** : ì—¬ëŸ¬ VPC, On-Premise, Direct Connectë¥¼ í•˜ë‚˜ì˜ Transit Gatewayì— ì—°ê²°. ì¤‘ì•™ ì§‘ì¤‘ì‹ ë¼ìš°íŒ… ê´€ë¦¬. ë„¤íŠ¸ì›Œí¬ ì„¸ë¶„í™”: ë¼ìš°íŒ… í…Œì´ë¸”ë¡œ VPC ê°„ í†µì‹  ì œì–´(ì˜ˆ: Production VPCëŠ” Development VPC ì ‘ê·¼ ì°¨ë‹¨). **DNS í†µí•©** : Route 53 Private Hosted Zoneìœ¼ë¡œ VPC ë‚´ë¶€ DNS. Resolver Endpointë¡œ On-Premise DNSì™€ í†µí•©. í•˜ì´ë¸Œë¦¬ë“œ í™˜ê²½ì—ì„œ ì¼ê´€ëœ DNS í•´ì„. |
| **ë¹„ìš© ìµœì í™”** | **NAT Gateway ë¹„ìš© ì ˆê°** : NAT GatewayëŠ” ì‹œê°„ë‹¹ + ë°ì´í„° ì²˜ë¦¬ ë¹„ìš©. S3/DynamoDBëŠ” Gateway Endpoint(ë¬´ë£Œ) ì‚¬ìš©. ë‹¤ë¥¸ ì„œë¹„ìŠ¤ëŠ” Interface Endpoint(ì‹œê°„ë‹¹ ë¹„ìš©, ë°ì´í„° ë¬´ë£Œ)ë¡œ NAT ìš°íšŒ. íŠ¸ë˜í”½ ë§ìœ¼ë©´ Endpointê°€ ì €ë ´. **VPC Peering vs Transit Gateway** : ì†Œìˆ˜ VPC ì—°ê²°ì€ Peering(ë¬´ë£Œ, ë°ì´í„° ì „ì†¡ë§Œ ê³¼ê¸ˆ). ë‹¤ìˆ˜ VPCëŠ” Transit Gateway(ì‹œê°„ë‹¹ + ë°ì´í„° ì²˜ë¦¬ ë¹„ìš©, ê´€ë¦¬ ê°„ì†Œí™”). ë¹„ìš©/ê´€ë¦¬ ë³µì¡ë„ íŠ¸ë ˆì´ë“œì˜¤í”„. **Direct Connect vs VPN** : ì´ˆê¸° êµ¬ì¶•: VPN ì €ë ´(ì‹œê°„ë‹¹ $0.05). ì¥ê¸° ìš´ì˜: Direct Connectê°€ ë°ì´í„° ì „ì†¡ ë¹„ìš© ë‚®ìŒ. ëŒ€ì—­í­/ì§€ì—°ì‹œê°„ ìš”êµ¬ì‚¬í•­ì— ë”°ë¼ ì„ íƒ. **Elastic IP ë¹„ìš©** : ì‚¬ìš© ì¤‘ì¸ EIPëŠ” ë¬´ë£Œ, ë¯¸ì‚¬ìš© EIPëŠ” ì‹œê°„ë‹¹ ê³¼ê¸ˆ. NAT Gateway/ì¸ìŠ¤í„´ìŠ¤ì— ì—°ê²°ëœ EIP í™•ì¸, ë¯¸ì‚¬ìš© ì¦‰ì‹œ ë¦´ë¦¬ìŠ¤. |
| **ëª¨ë‹ˆí„°ë§ & íŠ¸ëŸ¬ë¸”ìŠˆíŒ…** | **VPC Flow Logs ë¶„ì„** : ë¹„ì •ìƒ íŠ¸ë˜í”½ íŒ¨í„´ íƒì§€(ì˜ˆ: ì§§ì€ ì‹œê°„ ëŒ€ëŸ‰ ì—°ê²° ì‹œë„). ë³´ì•ˆ ê·¸ë£¹/NACL ì°¨ë‹¨ ë¡œê·¸(REJECT) í™•ì¸ìœ¼ë¡œ ê³µê²© ì‹œë„ íŒŒì•…. CloudWatch Insights ë˜ëŠ” Athenaë¡œ ì¿¼ë¦¬: `SELECT * FROM vpc_flow_logs WHERE action='REJECT' AND dstport=22`. **Reachability Analyzer** : ë„¤íŠ¸ì›Œí¬ ê²½ë¡œ ì§„ë‹¨ ë„êµ¬. ì†ŒìŠ¤ì—ì„œ ëª©ì ì§€ê¹Œì§€ ë¼ìš°íŒ… í…Œì´ë¸”, ë³´ì•ˆ ê·¸ë£¹, NACL, IGW/NAT ë“± ëª¨ë“  í™‰ ë¶„ì„. ì—°ê²° ì‹¤íŒ¨ ì›ì¸ ìë™ ì‹ë³„(ì˜ˆ: "NACL ê·œì¹™ 120ë²ˆì´ ì°¨ë‹¨"). **CloudWatch ë©”íŠ¸ë¦­** : NAT Gateway: ActiveConnectionCount, BytesInFromSource, BytesOutToDestination. VPN: TunnelState, TunnelDataIn/Out. ì„ê³„ê°’ ì´ˆê³¼ ì‹œ SNS ì•Œë¦¼. **Transit Gateway Network Manager** : ì „ì²´ ë„¤íŠ¸ì›Œí¬ í† í´ë¡œì§€ ì‹œê°í™”. ê° VPC/VPN ì—°ê²° ìƒíƒœ, íŠ¸ë˜í”½ íë¦„ ëª¨ë‹ˆí„°ë§. ì¥ì•  ë°œìƒ ì‹œ ì˜í–¥ ë²”ìœ„ íŒŒì•…. |

---

## 4. ê°œì¸ ì¸ì‚¬ì´íŠ¸ ë° ë‹¤ìŒ ë‹¨ê³„ (Reflection & Next Steps)

* **ë°°ìš´ ì /ëŠë‚€ ì :**
  - **VPCëŠ” AWS ë„¤íŠ¸ì›Œí¬ì˜ ê¸°ì´ˆ** : ëª¨ë“  ë¦¬ì†ŒìŠ¤ê°€ VPC ì•ˆì—ì„œ ë™ì‘í•˜ë¯€ë¡œ, VPCë¥¼ ì œëŒ€ë¡œ ì„¤ê³„í•˜ì§€ ì•Šìœ¼ë©´ ë‚˜ì¤‘ì— ì•„í‚¤í…ì²˜ ë³€ê²½ì´ ë§¤ìš° ì–´ë µìŠµë‹ˆë‹¤. CIDR ë¸”ë¡ì€ ë³€ê²½ ë¶ˆê°€í•˜ë¯€ë¡œ ì´ˆê¸° IP ì£¼ì†Œ ê³„íšì´ ì¤‘ìš”í•¨ì„ ê¹¨ë‹¬ì•˜ìŠµë‹ˆë‹¤.
  - **Public/Private Subnet ë¶„ë¦¬ì˜ ì¤‘ìš”ì„±** : ì›¹ ì„œë²„ëŠ” Public Subnetì—, ë°ì´í„°ë² ì´ìŠ¤ëŠ” Private Subnetì— ë°°ì¹˜í•˜ì—¬ ê³µê²© í‘œë©´ì„ ìµœì†Œí™”í•˜ëŠ” ê²ƒì´ ê¸°ë³¸ì…ë‹ˆë‹¤. NAT Gatewayë¥¼ í†µí•´ Private Subnetë„ ì¸í„°ë„· ì ‘ì†(ì•„ì›ƒë°”ìš´ë“œë§Œ)ì´ ê°€ëŠ¥í•˜ë‹¤ëŠ” ì ì´ í•µì‹¬ì…ë‹ˆë‹¤.
  - **ë³´ì•ˆ ê·¸ë£¹ê³¼ NACLì˜ ì°¨ì´** : ë³´ì•ˆ ê·¸ë£¹ì€ Stateful(ì‘ë‹µ ìë™ í—ˆìš©), NACLì€ Stateless(ëª…ì‹œì  ê·œì¹™ í•„ìš”). ë³´ì•ˆ ê·¸ë£¹ì€ ì¸ìŠ¤í„´ìŠ¤ ë ˆë²¨, NACLì€ ì„œë¸Œë„· ë ˆë²¨. ë‘ ê°œë¥¼ ì¡°í•©í•˜ì—¬ ë‹¤ì¸µ ë°©ì–´ë¥¼ êµ¬í˜„í•˜ëŠ” ê²ƒì´ Best Practiceì…ë‹ˆë‹¤.
  - **ë¼ìš°íŒ… í…Œì´ë¸”ì˜ ì—­í• ** : íŠ¸ë˜í”½ì´ ì–´ë””ë¡œ ê°€ì•¼ í•˜ëŠ”ì§€ ê²°ì •í•˜ëŠ” í•µì‹¬ ìš”ì†Œì…ë‹ˆë‹¤. Public Subnetì€ IGWë¡œ, Private Subnetì€ NAT Gatewayë¡œ ë¼ìš°íŒ…. VPC Peeringì´ë‚˜ Transit Gateway ì—°ê²° ì‹œì—ë„ ë¼ìš°íŒ… í…Œì´ë¸” ì—…ë°ì´íŠ¸ê°€ í•„ìˆ˜ì…ë‹ˆë‹¤.
  - **VPC Peeringì˜ ì œì•½** : ë¹„ì „ì´ì (Non-transitive)ì´ë¼ëŠ” ì ì´ ì¤‘ìš”í•©ë‹ˆë‹¤. A-B, B-C Peeringì´ ìˆì–´ë„ A-CëŠ” ì§ì ‘ í†µì‹  ë¶ˆê°€. ë‹¤ìˆ˜ VPC ì—°ê²° ì‹œ Transit Gatewayê°€ í›¨ì”¬ íš¨ìœ¨ì ì…ë‹ˆë‹¤.
  - **VPC Endpointì˜ ê°€ì¹˜** : S3, DynamoDBëŠ” Gateway Endpoint(ë¬´ë£Œ)ë¡œ ì ‘ê·¼í•˜ë©´ NAT Gateway ë¹„ìš©ì„ ì ˆê°í•˜ê³  ë³´ì•ˆë„ ê°•í™”ë©ë‹ˆë‹¤. Interface EndpointëŠ” ë‹¤ë¥¸ AWS ì„œë¹„ìŠ¤ì— í”„ë¼ì´ë¹— ì—°ê²° ì œê³µ.
  - **ì‹¤ìŠµì˜ íš¨ê³¼** : ì½˜ì†”ê³¼ CLIë¡œ ì§ì ‘ VPC, ì„œë¸Œë„·, IGW, NAT Gateway, ë¼ìš°íŒ… í…Œì´ë¸”, ë³´ì•ˆ ê·¸ë£¹ì„ ì„¤ì •í•´ë³´ë‹ˆ ê° êµ¬ì„± ìš”ì†Œì˜ ì—­í• ê³¼ ìƒí˜¸ì‘ìš©ì´ ëª…í™•í•˜ê²Œ ì´í•´ë˜ì—ˆìŠµë‹ˆë‹¤. íŠ¹íˆ ë¼ìš°íŒ… í…Œì´ë¸” ì„¤ì • ì‹¤ìˆ˜ë¡œ í†µì‹ ì´ ì•ˆ ë˜ëŠ” ê²½í—˜ì„ í†µí•´ íŠ¸ëŸ¬ë¸”ìŠˆíŒ… ëŠ¥ë ¥ë„ í–¥ìƒë˜ì—ˆìŠµë‹ˆë‹¤.

* **ì‹¬í™” ë°©í–¥:**
  - **AWS Transit Gateway ì‹¤ìŠµ** : ì—¬ëŸ¬ VPCë¥¼ Transit Gatewayë¡œ ì—°ê²°í•˜ê³ , ë¼ìš°íŒ… í…Œì´ë¸”ë¡œ VPC ê°„ í†µì‹  ì œì–´. VPN/Direct Connectë¥¼ Transit Gatewayì— ì—°ê²°í•˜ì—¬ í•˜ì´ë¸Œë¦¬ë“œ í´ë¼ìš°ë“œ êµ¬ì„±.
  - **VPN ì—°ê²° ì‹¤ìŠµ** : On-Premise ì‹œë®¬ë ˆì´ì…˜(VirtualBox)ê³¼ AWS VPCë¥¼ Site-to-Site VPNìœ¼ë¡œ ì—°ê²°. IPsec í„°ë„ ì„¤ì •, BGP ë™ì  ë¼ìš°íŒ… êµ¬ì„±.
  - **Direct Connect í•™ìŠµ** : Direct Connectì˜ êµ¬ì„± ìš”ì†Œ(Virtual Interface, LAG, Direct Connect Gateway) ì´í•´. ëŒ€ìš©ëŸ‰ ë°ì´í„° ì „ì†¡ ì‹œë‚˜ë¦¬ì˜¤.
  - **VPC Flow Logs ë¶„ì„** : Flow Logsë¥¼ S3ì— ì €ì¥í•˜ê³  Athenaë¡œ ì¿¼ë¦¬. ì˜ì‹¬ìŠ¤ëŸ¬ìš´ íŠ¸ë˜í”½ íŒ¨í„´(í¬íŠ¸ ìŠ¤ìº”, ëŒ€ëŸ‰ ì—°ê²° ì‹œë„) íƒì§€. CloudWatch Insightsë¡œ ì‹¤ì‹œê°„ ë¶„ì„.
  - **AWS Network Firewall ì‹¤ìŠµ** : Suricata ë£° ì‘ì„±í•˜ì—¬ ì• í”Œë¦¬ì¼€ì´ì…˜ ë ˆë²¨ ê³µê²© ì°¨ë‹¨. Intrusion Prevention ì‹œë‚˜ë¦¬ì˜¤.
  - **ê³ ê¸‰ ë³´ì•ˆ ì•„í‚¤í…ì²˜** : Bastion Host ë˜ëŠ” AWS Systems Manager Session Managerë¡œ Private EC2 ì•ˆì „í•˜ê²Œ ì ‘ì†. GuardDutyë¡œ VPC ë‚´ ìœ„í˜‘ íƒì§€.
  - **ë©€í‹° ë¦¬ì „ VPC ì„¤ê³„** : Transit Gateway Inter-Region Peeringìœ¼ë¡œ ì—¬ëŸ¬ ë¦¬ì „ VPC ì—°ê²°. ê¸€ë¡œë²Œ ì• í”Œë¦¬ì¼€ì´ì…˜ ì•„í‚¤í…ì²˜ êµ¬ì„±.
  - **PrivateLink í™œìš©** : VPC Endpoint Serviceë¥¼ ìƒì„±í•˜ì—¬ ë‹¤ë¥¸ ê³„ì •ì˜ VPCì—ì„œ ë‚´ ì„œë¹„ìŠ¤ì— í”„ë¼ì´ë¹— ì ‘ê·¼. SaaS ì œê³µì ì‹œë‚˜ë¦¬ì˜¤.
  - **Terraformìœ¼ë¡œ VPC ìë™í™”** : VPC ëª¨ë“ˆ ì‘ì„±í•˜ì—¬ ì„œë¸Œë„·, IGW, NAT Gateway, ë¼ìš°íŒ… í…Œì´ë¸”, ë³´ì•ˆ ê·¸ë£¹ì„ ì½”ë“œë¡œ ê´€ë¦¬. ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ì¸í”„ë¼.
  - **ë„¤íŠ¸ì›Œí¬ ì„±ëŠ¥ ìµœì í™”** : Enhanced Networking(SR-IOV), Placement Group, Jumbo Frame(MTU 9001) ì„¤ì •. ê³ ì„±ëŠ¥ ì»´í“¨íŒ…(HPC) ì‹œë‚˜ë¦¬ì˜¤.

---

## 5. ì¶”ê°€ ì°¸ê³ ì‚¬í•­ (Quick Reference)

### CIDR ë¸”ë¡ ê³„ì‚°í‘œ

| CIDR | ì„œë¸Œë„· ë§ˆìŠ¤í¬ | ì‚¬ìš© ê°€ëŠ¥ IP | ìš©ë„ |
|:---:|:---:|:---:|:---|
| /32 | 255.255.255.255 | 1ê°œ | ë‹¨ì¼ í˜¸ìŠ¤íŠ¸ |
| /28 | 255.255.255.240 | 11ê°œ (16-5) | ë§¤ìš° ì‘ì€ ì„œë¸Œë„· |
| /24 | 255.255.255.0 | 251ê°œ (256-5) | ì¼ë°˜ì ì¸ ì„œë¸Œë„· |
| /20 | 255.255.240.0 | 4,091ê°œ (4096-5) | í° ì„œë¸Œë„· |
| /16 | 255.255.0.0 | 65,531ê°œ (65536-5) | VPC ê¶Œì¥ í¬ê¸° |
| /12 | 255.240.0.0 | 1,048,571ê°œ | ë§¤ìš° í° VPC |
| /8 | 255.0.0.0 | 16,777,211ê°œ | ìµœëŒ€ VPC í¬ê¸° |

**AWS ì˜ˆì•½ IP (ê° ì„œë¸Œë„·ë§ˆë‹¤ 5ê°œ):**
```
ì˜ˆ: 10.0.1.0/24 ì„œë¸Œë„·
- 10.0.1.0: ë„¤íŠ¸ì›Œí¬ ì£¼ì†Œ
- 10.0.1.1: VPC ë¼ìš°í„°
- 10.0.1.2: DNS ì„œë²„ (Amazon-provided DNS)
- 10.0.1.3: í–¥í›„ ì‚¬ìš© ì˜ˆì•½
- 10.0.1.255: ë¸Œë¡œë“œìºìŠ¤íŠ¸ ì£¼ì†Œ
```

### VPC êµ¬ì„± ìš”ì†Œ ì œí•œ (ê¸°ë³¸ê°’)

| ë¦¬ì†ŒìŠ¤ | ì œí•œ | ì¦ê°€ ê°€ëŠ¥ ì—¬ë¶€ |
|:---:|:---:|:---:|
| VPC/ë¦¬ì „ | 5ê°œ | Yes (ìˆ˜ë°± ê°œ) |
| ì„œë¸Œë„·/VPC | 200ê°œ | Yes |
| IGW/VPC | 1ê°œ | No |
| NAT Gateway/AZ | 5ê°œ | Yes |
| VPC Peering ì—°ê²°/VPC | 50ê°œ | Yes (125ê°œ) |
| ë³´ì•ˆ ê·¸ë£¹/VPC | 2,500ê°œ | Yes |
| ë³´ì•ˆ ê·¸ë£¹/ì¸ìŠ¤í„´ìŠ¤ | 5ê°œ | Yes (16ê°œ) |
| ê·œì¹™/ë³´ì•ˆ ê·¸ë£¹ | 60ê°œ (In+Out) | Yes (1000ê°œ) |
| NACL/VPC | 200ê°œ | Yes |
| ê·œì¹™/NACL | 20ê°œ (In+Out) | Yes (40ê°œ) |

### ì£¼ìš” AWS ì„œë¹„ìŠ¤ í¬íŠ¸ (ë³´ì•ˆ ê·¸ë£¹ ì„¤ì •ìš©)

| ì„œë¹„ìŠ¤ | í¬íŠ¸ | í”„ë¡œí† ì½œ | ì„¤ëª… |
|:---:|:---:|:---:|:---|
| SSH | 22 | TCP | Linux ì›ê²© ì ‘ì† (Bastionì—ì„œë§Œ í—ˆìš©) |
| RDP | 3389 | TCP | Windows ì›ê²© ë°ìŠ¤í¬í†± (Bastionì—ì„œë§Œ) |
| HTTP | 80 | TCP | ì›¹ íŠ¸ë˜í”½ (ALBì—ì„œ í—ˆìš©) |
| HTTPS | 443 | TCP | ì•”í˜¸í™” ì›¹ íŠ¸ë˜í”½ (ALBì—ì„œ í—ˆìš©) |
| MySQL/Aurora | 3306 | TCP | ë°ì´í„°ë² ì´ìŠ¤ (App SGì—ì„œë§Œ í—ˆìš©) |
| PostgreSQL | 5432 | TCP | ë°ì´í„°ë² ì´ìŠ¤ (App SGì—ì„œë§Œ í—ˆìš©) |
| Redis | 6379 | TCP | ElastiCache (App SGì—ì„œë§Œ) |
| Memcached | 11211 | TCP | ElastiCache (App SGì—ì„œë§Œ) |
| Custom App | 8080, 8443 | TCP | ì• í”Œë¦¬ì¼€ì´ì…˜ (Web SGì—ì„œë§Œ) |
| NFS | 2049 | TCP | EFS ë§ˆìš´íŠ¸ (App SGì—ì„œë§Œ) |
| SMTP | 25, 587 | TCP | ì´ë©”ì¼ ë°œì†¡ (ì œí•œì  í—ˆìš©) |
| DNS | 53 | UDP/TCP | Route 53 (VPC ë‚´ë¶€) |
| All ICMP | - | ICMP | Ping, Traceroute (ë””ë²„ê¹… ì‹œë§Œ) |
| Ephemeral | 1024-65535 | TCP | ì‘ë‹µ íŠ¸ë˜í”½ (NACLì—ì„œ í—ˆìš© í•„ìš”) |

### AWS CLI ì£¼ìš” ëª…ë ¹ì–´ (VPC ê´€ë¦¬)

```bash
# VPC
aws ec2 describe-vpcs
aws ec2 create-vpc --cidr-block 10.0.0.0/16
aws ec2 delete-vpc --vpc-id vpc-xxx

# ì„œë¸Œë„·
aws ec2 describe-subnets --filters "Name=vpc-id,Values=vpc-xxx"
aws ec2 create-subnet --vpc-id vpc-xxx --cidr-block 10.0.1.0/24
aws ec2 delete-subnet --subnet-id subnet-xxx

# ì¸í„°ë„· ê²Œì´íŠ¸ì›¨ì´
aws ec2 create-internet-gateway
aws ec2 attach-internet-gateway --vpc-id vpc-xxx --internet-gateway-id igw-xxx
aws ec2 detach-internet-gateway --vpc-id vpc-xxx --internet-gateway-id igw-xxx

# NAT Gateway
aws ec2 create-nat-gateway --subnet-id subnet-xxx --allocation-id eipalloc-xxx
aws ec2 describe-nat-gateways
aws ec2 delete-nat-gateway --nat-gateway-id nat-xxx

# ë¼ìš°íŒ… í…Œì´ë¸”
aws ec2 describe-route-tables --filters "Name=vpc-id,Values=vpc-xxx"
aws ec2 create-route --route-table-id rtb-xxx --destination-cidr-block 0.0.0.0/0 --gateway-id igw-xxx
aws ec2 associate-route-table --subnet-id subnet-xxx --route-table-id rtb-xxx

# ë³´ì•ˆ ê·¸ë£¹
aws ec2 describe-security-groups --group-ids sg-xxx
aws ec2 authorize-security-group-ingress --group-id sg-xxx --protocol tcp --port 80 --cidr 0.0.0.0/0
aws ec2 revoke-security-group-ingress --group-id sg-xxx --protocol tcp --port 22 --cidr 0.0.0.0/0

# VPC Peering
aws ec2 create-vpc-peering-connection --vpc-id vpc-aaa --peer-vpc-id vpc-bbb
aws ec2 accept-vpc-peering-connection --vpc-peering-connection-id pcx-xxx
aws ec2 delete-vpc-peering-connection --vpc-peering-connection-id pcx-xxx

# VPC Endpoint
aws ec2 create-vpc-endpoint --vpc-id vpc-xxx --service-name com.amazonaws.region.s3 --route-table-ids rtb-xxx
aws ec2 describe-vpc-endpoints

# VPC Flow Logs
aws ec2 create-flow-logs --resource-type VPC --resource-ids vpc-xxx --traffic-type ALL --log-destination-type s3 --log-destination arn:aws:s3:::my-flow-logs
aws ec2 describe-flow-logs
```

### ë³´ì•ˆ ê·¸ë£¹ ì„¤ê³„ íŒ¨í„´

**1. ì›¹ ê³„ì¸µ (ALB/Web Server):**
```
Security Group: web-tier-sg
Inbound:
  - HTTP (80) from 0.0.0.0/0
  - HTTPS (443) from 0.0.0.0/0
Outbound:
  - All traffic (ê¸°ë³¸ê°’)
```

**2. ì• í”Œë¦¬ì¼€ì´ì…˜ ê³„ì¸µ:**
```
Security Group: app-tier-sg
Inbound:
  - Custom TCP (8080) from web-tier-sg
  - Custom TCP (8443) from web-tier-sg
Outbound:
  - MySQL (3306) to db-tier-sg
  - HTTPS (443) to 0.0.0.0/0 (ì™¸ë¶€ API í˜¸ì¶œ)
```

**3. ë°ì´í„°ë² ì´ìŠ¤ ê³„ì¸µ:**
```
Security Group: db-tier-sg
Inbound:
  - MySQL (3306) from app-tier-sg
Outbound:
  - None (ë˜ëŠ” ìµœì†Œ í•„ìš”)
```

**4. Bastion Host:**
```
Security Group: bastion-sg
Inbound:
  - SSH (22) from <ê´€ë¦¬ì IP>/32
Outbound:
  - SSH (22) to app-tier-sg
  - SSH (22) to db-tier-sg
```

### VPC Flow Logs ë¶„ì„ ì¿¼ë¦¬ (Athena)

```sql
-- ê±°ë¶€ëœ SSH ì‹œë„ (í¬íŠ¸ ìŠ¤ìº” íƒì§€)
SELECT 
  srcaddr, dstaddr, dstport, protocol, action, COUNT(*) as attempt_count
FROM vpc_flow_logs
WHERE 
  dstport = 22 
  AND action = 'REJECT'
  AND start >= CAST(date_add('day', -1, now()) AS BIGINT)
GROUP BY srcaddr, dstaddr, dstport, protocol, action
HAVING COUNT(*) > 10
ORDER BY attempt_count DESC;

-- ìƒìœ„ íŠ¸ë˜í”½ ì†ŒìŠ¤ IP
SELECT 
  srcaddr, 
  SUM(bytes) / 1024 / 1024 / 1024 as total_gb,
  COUNT(*) as connection_count
FROM vpc_flow_logs
WHERE start >= CAST(date_add('day', -7, now()) AS BIGINT)
GROUP BY srcaddr
ORDER BY total_gb DESC
LIMIT 20;

-- ë¹„ì •ìƒ í¬íŠ¸ ì ‘ê·¼ ì‹œë„
SELECT 
  srcaddr, dstport, COUNT(*) as attempt_count
FROM vpc_flow_logs
WHERE 
  dstport NOT IN (80, 443, 22, 3306)
  AND action = 'REJECT'
  AND start >= CAST(date_add('day', -1, now()) AS BIGINT)
GROUP BY srcaddr, dstport
HAVING COUNT(*) > 5
ORDER BY attempt_count DESC;
```

### ë„¤íŠ¸ì›Œí¬ íŠ¸ëŸ¬ë¸”ìŠˆíŒ… ì²´í¬ë¦¬ìŠ¤íŠ¸

```
â˜‘ CIDR ë¸”ë¡ ì¶©ëŒ í™•ì¸ (VPC Peering, On-Premise)
â˜‘ ì„œë¸Œë„·ì´ ì˜¬ë°”ë¥¸ AZì— ë°°ì¹˜ë˜ì—ˆëŠ”ì§€ í™•ì¸
â˜‘ ì¸í„°ë„· ê²Œì´íŠ¸ì›¨ì´ê°€ VPCì— ì—°ê²°ë˜ì—ˆëŠ”ì§€ í™•ì¸
â˜‘ NAT Gatewayê°€ Public Subnetì— ìˆê³  EIPê°€ í• ë‹¹ë˜ì—ˆëŠ”ì§€ í™•ì¸
â˜‘ ë¼ìš°íŒ… í…Œì´ë¸”ì´ ì˜¬ë°”ë¥¸ ì„œë¸Œë„·ì— ì—°ê²°ë˜ì—ˆëŠ”ì§€ í™•ì¸
â˜‘ Public Subnet ë¼ìš°íŒ…: 0.0.0.0/0 â†’ IGW
â˜‘ Private Subnet ë¼ìš°íŒ…: 0.0.0.0/0 â†’ NAT Gateway
â˜‘ ë³´ì•ˆ ê·¸ë£¹ ì¸ë°”ìš´ë“œ ê·œì¹™ í™•ì¸ (í•„ìš”í•œ í¬íŠ¸ í—ˆìš©)
â˜‘ NACL ì¸ë°”ìš´ë“œ/ì•„ì›ƒë°”ìš´ë“œ ê·œì¹™ í™•ì¸ (Ephemeral í¬íŠ¸ í—ˆìš©)
â˜‘ EC2 ì¸ìŠ¤í„´ìŠ¤ì— Public IP ë˜ëŠ” EIP í• ë‹¹ í™•ì¸ (Public Subnet)
â˜‘ VPC Peering ì‹œ ì–‘ìª½ ë¼ìš°íŒ… í…Œì´ë¸” ì—…ë°ì´íŠ¸ í™•ì¸
â˜‘ VPC Endpoint ì •ì±… í™•ì¸ (í•„ìš”í•œ ë¦¬ì†ŒìŠ¤ ì ‘ê·¼ í—ˆìš©)
â˜‘ DNS í•´ì„ í™œì„±í™” í™•ì¸ (VPC ì†ì„±)
â˜‘ VPC Flow Logsë¡œ REJECT ë¡œê·¸ í™•ì¸
â˜‘ Reachability Analyzerë¡œ ë„¤íŠ¸ì›Œí¬ ê²½ë¡œ ì§„ë‹¨
```

### ê³ ê°€ìš©ì„± VPC ì„¤ê³„ ì›ì¹™

```
1. ë‹¤ì¤‘ AZ ë°°í¬
   - ëª¨ë“  ê³„ì¸µ(Web, App, DB)ì„ ìµœì†Œ 2ê°œ AZì— ë°°ì¹˜
   - ë¡œë“œ ë°¸ëŸ°ì„œëŠ” ìë™ìœ¼ë¡œ ì—¬ëŸ¬ AZì— ë¶„ì‚°
   - RDS Multi-AZ, ElastiCache Cluster Mode

2. NAT Gateway ê³ ê°€ìš©ì„±
   - ê° AZë§ˆë‹¤ NAT Gateway ìƒì„±
   - ê° AZì˜ Private Subnetì€ ìì‹ ì˜ AZ NAT Gateway ì‚¬ìš©
   - í•œ AZ ì¥ì•  ì‹œì—ë„ ë‹¤ë¥¸ AZëŠ” ì¸í„°ë„· ì ‘ì† ê°€ëŠ¥

3. VPN ê³ ê°€ìš©ì„±
   - Site-to-Site VPNì€ ìë™ìœ¼ë¡œ 2ê°œ í„°ë„ ìƒì„±
   - BGP ë™ì  ë¼ìš°íŒ…ìœ¼ë¡œ ìë™ Failover
   - ë˜ëŠ” Direct Connect + VPN Backup êµ¬ì„±

4. Transit Gateway ê³ ê°€ìš©ì„±
   - Transit GatewayëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ì—¬ëŸ¬ AZì— ë°°í¬
   - ìë™ Failover, 99.95% SLA

5. ëª¨ë‹ˆí„°ë§ ë° ì•Œë¦¼
   - CloudWatchë¡œ NAT Gateway ìƒíƒœ ëª¨ë‹ˆí„°ë§
   - VPN í„°ë„ ìƒíƒœ ì•Œë¦¼ (TunnelState ë©”íŠ¸ë¦­)
   - VPC Flow Logsë¡œ ë¹„ì •ìƒ íŠ¸ë˜í”½ íƒì§€
```
