# ğŸ“„ 2025.01.21 (Day 16) - Splunk SIEM ê¸°ë³¸ ì‹¤ìŠµ ë° ë°ì´í„° ë¶„ì„

---

## 1. í•µì‹¬ ê°œë… ì •ë¦¬

### SIEM ë° Splunk ê¸°ì´ˆ

| # | í•µì‹¬ ê°œë… | ì„¤ëª… | ì‹¤ë¬´/ë³´ì•ˆ ê´€ì  |
|:---:|:---|:---|:---|
| 1 | SIEM | Security Information and Event Management, ë³´ì•ˆ ì •ë³´ ë° ì´ë²¤íŠ¸ ê´€ë¦¬ ì‹œìŠ¤í…œ | ë‹¤ì–‘í•œ ì†ŒìŠ¤ì˜ ë¡œê·¸ë¥¼ ì¤‘ì•™ ì§‘ì¤‘ì‹ìœ¼ë¡œ ìˆ˜ì§‘, ë¶„ì„í•˜ì—¬ ë³´ì•ˆ ìœ„í˜‘ íƒì§€ |
| 2 | Splunk | ì—”í„°í”„ë¼ì´ì¦ˆê¸‰ ë¹…ë°ì´í„° ìˆ˜ì§‘ ë° ë¶„ì„ í”Œë«í¼ | ë¨¸ì‹  ë°ì´í„° ì¸ë±ì‹± ë° ì‹¤ì‹œê°„ ê²€ìƒ‰ìœ¼ë¡œ ì¸í”„ë¼/ë³´ì•ˆ ëª¨ë‹ˆí„°ë§ |
| 3 | SPL | Splunk Processing Language, Splunk ì „ìš© ì¿¼ë¦¬ ì–¸ì–´ | SQLê³¼ ìœ ì‚¬í•˜ì§€ë§Œ íŒŒì´í”„ë¼ì¸ ê¸°ë°˜ìœ¼ë¡œ ë°ì´í„° ë³€í™˜ ë° í†µê³„ ì²˜ë¦¬ |
| 4 | Index | Splunkê°€ ë°ì´í„°ë¥¼ ì €ì¥í•˜ëŠ” ë…¼ë¦¬ì  ì»¨í…Œì´ë„ˆ | ë¡œê·¸ íƒ€ì…ë³„ë¡œ ì¸ë±ìŠ¤ ë¶„ë¦¬í•˜ì—¬ ê²€ìƒ‰ ì„±ëŠ¥ ìµœì í™” |
| 5 | Sourcetype | ë¡œê·¸ ë°ì´í„°ì˜ í˜•ì‹ ì •ì˜ | access_combined, syslog ë“± íŒŒì‹± ê·œì¹™ ìë™ ì ìš© |

### Splunk ì•„í‚¤í…ì²˜ êµ¬ì„± ìš”ì†Œ

| # | í•µì‹¬ ê°œë… | ì„¤ëª… | ì‹¤ë¬´/ë³´ì•ˆ ê´€ì  |
|:---:|:---|:---|:---|
| 6 | Forwarder | ë°ì´í„° ìˆ˜ì§‘ ì—ì´ì „íŠ¸ | ì›ê²© ì„œë²„ì— ì„¤ì¹˜í•˜ì—¬ ë¡œê·¸ë¥¼ Splunk ì„œë²„ë¡œ ì „ì†¡ |
| 7 | Indexer | ë°ì´í„°ë¥¼ ì¸ë±ì‹±í•˜ê³  ì €ì¥í•˜ëŠ” ì„œë²„ | ëŒ€ìš©ëŸ‰ ë¡œê·¸ ê³ ì† ê²€ìƒ‰ì„ ìœ„í•œ ì—­ì¸ë±ìŠ¤ ìƒì„± |
| 8 | Search Head | ì‚¬ìš©ì ê²€ìƒ‰ ì¸í„°í˜ì´ìŠ¤ ì œê³µ | ì›¹ UIì—ì„œ SPL ì¿¼ë¦¬ ì‹¤í–‰ ë° ëŒ€ì‹œë³´ë“œ ê´€ë¦¬ |
| 9 | Management Console | Splunk í´ëŸ¬ìŠ¤í„° ì¤‘ì•™ ê´€ë¦¬ | ë¶„ì‚° í™˜ê²½ì—ì„œ ì„¤ì • ë°°í¬ ë° ëª¨ë‹ˆí„°ë§ |
| 10 | ë¶„ì‚° ì•„í‚¤í…ì²˜ | Forwarder â†’ Indexer â†’ Search Head êµ¬ì¡° | ëŒ€ê·œëª¨ í™˜ê²½ì—ì„œ ìˆ˜í‰ í™•ì¥ ê°€ëŠ¥ |

### Splunk ê²€ìƒ‰ ê¸°ë³¸ ê°œë…

| # | í•µì‹¬ ê°œë… | ì„¤ëª… | ì‹¤ë¬´/ë³´ì•ˆ ê´€ì  |
|:---:|:---|:---|:---|
| 11 | í‚¤ì›Œë“œ ê²€ìƒ‰ | ë¡œê·¸ ë‚´ ë‹¨ì–´ ì§ì ‘ ê²€ìƒ‰ | port, mongodb ë“± ë¬¸ìì—´ í¬í•¨ ì´ë²¤íŠ¸ í•„í„°ë§ |
| 12 | ì™€ì¼ë“œì¹´ë“œ | `*` ì‚¬ìš©ìœ¼ë¡œ ë¶€ë¶„ ì¼ì¹˜ ê²€ìƒ‰ | `por*` â†’ port, portal, pork ë“± ëª¨ë‘ ë§¤ì¹­ |
| 13 | ë¶€ìš¸ ì—°ì‚°ì | AND, OR, NOTìœ¼ë¡œ ì¡°ê±´ ì¡°í•© | `mongodb AND 194.8.74.23` ë‘ ì¡°ê±´ ëª¨ë‘ ë§Œì¡± |
| 14 | íŒŒì´í”„ë¼ì¸ | `|` ê¸°í˜¸ë¡œ ëª…ë ¹ì–´ ì²´ì´ë‹ | ê²€ìƒ‰ ê²°ê³¼ë¥¼ ë‹¤ìŒ ëª…ë ¹ì–´ ì…ë ¥ìœ¼ë¡œ ì „ë‹¬ |
| 15 | ì„œë¸Œê²€ìƒ‰ | `[ ]` ì•ˆì˜ ê²€ìƒ‰ ê²°ê³¼ë¥¼ ì™¸ë¶€ ì¿¼ë¦¬ì— ì‚¬ìš© | VIP ê³ ê° ì°¾ê¸° í›„ í•´ë‹¹ ê³ ê° ìƒì„¸ ë¶„ì„ |

---

## 2. ì‹¤ìŠµ ë‚´ìš© ì •ë¦¬

### ì‹¤ìŠµ 0-1: ë„¤íŠ¸ì›Œí¬ ê¸°ë³¸ ì ê²€

**ëª©í‘œ:** Splunk ì‹¤ìŠµ ì „ ë„¤íŠ¸ì›Œí¬ ì—°ê²° ìƒíƒœ í™•ì¸

**ì‹¤ìŠµ í™˜ê²½:**
- Ubuntu 20.04
- í„°ë¯¸ë„

**ì‹¤ìŠµ ë‹¨ê³„:**
```bash
# 1. IP ì£¼ì†Œ í™•ì¸
ip addr show
# ë˜ëŠ”
ifconfig

# 2. ê¸°ë³¸ ê²Œì´íŠ¸ì›¨ì´(ë¼ìš°í„°) í™•ì¸
ip route show
# ì¶œë ¥ ì˜ˆì‹œ: default via 192.168.1.1 dev ens33

# 3. êµ¬ê¸€ DNS ì—°ê²° í…ŒìŠ¤íŠ¸
ping 8.8.8.8 -c 4

# 4. DNS ì„œë²„ ì •ìƒ ì‘ë™ í™•ì¸
ping www.google.com -c 4
# DNSê°€ ì •ìƒì´ë©´ ë„ë©”ì¸ì´ IPë¡œ ë³€í™˜ë˜ì–´ ì‘ë‹µ
```

**ë¶„ì„ í¬ì¸íŠ¸:**
```
í™•ì¸ í•­ëª©:
âœ“ IP ì£¼ì†Œ ì •ìƒ í• ë‹¹ (DHCP ë˜ëŠ” ê³ ì • IP)
âœ“ ê²Œì´íŠ¸ì›¨ì´ ì—°ê²° ê°€ëŠ¥ (ë‚´ë¶€ ë„¤íŠ¸ì›Œí¬ í†µì‹ )
âœ“ ì¸í„°ë„· ì—°ê²° ê°€ëŠ¥ (ì™¸ë¶€ í†µì‹ )
âœ“ DNS ì„œë²„ ì •ìƒ ì‘ë™ (ë„ë©”ì¸ ì´ë¦„ í•´ì„)
```

**ë³´ì•ˆ ì¸ì‚¬ì´íŠ¸:**
- SplunkëŠ” ì›ê²© Forwarderì™€ í†µì‹ í•˜ë¯€ë¡œ ë„¤íŠ¸ì›Œí¬ ì—°ê²° í•„ìˆ˜
- ë°©í™”ë²½ ì •ì±…ìœ¼ë¡œ í¬íŠ¸ 9997 (Forwarder í†µì‹ ) í—ˆìš© í•„ìš”
- DNS ì¥ì•  ì‹œ í˜¸ìŠ¤íŠ¸ëª… ê¸°ë°˜ ë¡œê·¸ ìˆ˜ì§‘ ì‹¤íŒ¨ ê°€ëŠ¥

### ì‹¤ìŠµ 1-1: Splunk 8.2.0 ì„¤ì¹˜ ë° ì´ˆê¸° ì„¤ì •

**ëª©í‘œ:** Ubuntu 20.04ì— Splunk Enterprise ì„¤ì¹˜ ë° ì›¹ UI ì ‘ì†

**ì‹¤ìŠµ í™˜ê²½:**
- Ubuntu 20.04
- Splunk 8.2.0 (splunk-8.2.0-e053ef3c985f-linux-2.6-amd64.deb)

**ì‹¤ìŠµ ë‹¨ê³„:**
```bash
# 1. Splunk .deb íŒ¨í‚¤ì§€ ì„¤ì¹˜
sudo dpkg -i splunk-8.2.0-e053ef3c985f-linux-2.6-amd64.deb
# ì„¤ì¹˜ ê²½ë¡œ: /opt/splunk

# 2. SWID íƒœê·¸ ë³µì‚¬ (ì†Œí”„íŠ¸ì›¨ì–´ ì‹ë³„ì)
sudo mkdir -p /usr/share/regid.2001-12.com.splunk
sudo cp /opt/splunk/swidtag/splunk-Splunk-Enterprise-primary.swidtag \
        /opt/splunk/etc/regid.2001-12.com.splunk-Splunk-Enterprise.swidtag
sudo chown splunk:splunk /opt/splunk/etc/regid.2001-12.com.splunk-Splunk-Enterprise.swidtag

# 3. ë¶€íŒ… ì‹œ ìë™ ì‹œì‘ ì„¤ì •
sudo /opt/splunk/bin/splunk enable boot-start
# ë¼ì´ì„ ìŠ¤ ì•½ê´€ ë™ì˜: 'q' ëˆŒëŸ¬ì„œ ë¹ ì ¸ë‚˜ì˜¨ í›„ 'y' ì…ë ¥

# 4. ê´€ë¦¬ì ê³„ì • ìƒì„±
# Please enter an administrator username: admin
# Password: 12345678 (ìµœì†Œ 8ì)

# 5. Splunk ìƒíƒœ í™•ì¸
sudo /opt/splunk/bin/splunk status

# 6. Splunk ì‹œì‘
sudo /opt/splunk/bin/splunk start

# 7. ì›¹ UI ì ‘ì†
# ë¸Œë¼ìš°ì €ì—ì„œ http://[Ubuntu_IP]:8000 ì ‘ì†
# ë¡œê·¸ì¸: admin / 12345678
```

**Splunk ë””ë ‰í† ë¦¬ êµ¬ì¡°:**
```
/opt/splunk/
â”œâ”€â”€ bin/           # splunk ì‹¤í–‰ íŒŒì¼
â”œâ”€â”€ etc/           # ì„¤ì • íŒŒì¼ (inputs.conf, outputs.conf ë“±)
â”‚   â”œâ”€â”€ system/
â”‚   â””â”€â”€ apps/
â”œâ”€â”€ var/           # ì¸ë±ìŠ¤ ë°ì´í„° ì €ì¥ì†Œ
â””â”€â”€ share/         # ë¬¸ì„œ ë° ë¦¬ì†ŒìŠ¤
```

**ë¶„ì„ í¬ì¸íŠ¸:**
```
í™•ì¸ í•­ëª©:
âœ“ Splunk ì„œë¹„ìŠ¤ ì •ìƒ ì‹¤í–‰ (splunkd, splunkweb)
âœ“ ì›¹ UI í¬íŠ¸ 8000 ì ‘ì† ê°€ëŠ¥
âœ“ ê´€ë¦¬ì ê³„ì • ë¡œê·¸ì¸ ì„±ê³µ
âœ“ ë¼ì´ì„ ìŠ¤: Free License (ì¼ì¼ 500MB ì œí•œ)
```

**ë³´ì•ˆ ê³ ë ¤ì‚¬í•­:**
```
ë³´ì•ˆ ì„¤ì •:
- ê¸°ë³¸ í¬íŠ¸ 8000, 8089 ë°©í™”ë²½ ê·œì¹™ ì„¤ì •
- ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸ ê°•í™” (í”„ë¡œë•ì…˜ í™˜ê²½)
- HTTPS í™œì„±í™” (SSL ì¸ì¦ì„œ ì ìš©)
- ìµœì†Œ ê¶Œí•œ ì›ì¹™ (Role-Based Access Control)

ë°©ì–´ ë°©ë²•:
â†’ Splunk ì›¹ UIëŠ” ë‚´ë¶€ë§ì—ì„œë§Œ ì ‘ê·¼ í—ˆìš©
â†’ ê´€ë¦¬ í¬íŠ¸ 8089ëŠ” ì‹ ë¢°ëœ IPë§Œ í—ˆìš©
â†’ ì •ê¸°ì ì¸ ë³´ì•ˆ íŒ¨ì¹˜ ì ìš©
â†’ ê°ì‚¬ ë¡œê·¸(audit.log) ì£¼ê¸°ì  ê²€í† 
```

### ì‹¤ìŠµ 1-2: Nginx ì›¹ ì„œë²„ ì„¤ì¹˜

**ëª©í‘œ:** WAS(Web Application Server) ì—­í• ì˜ Nginx ì„¤ì¹˜

**ì‹¤ìŠµ í™˜ê²½:**
- Ubuntu 20.04

**ì‹¤ìŠµ ë‹¨ê³„:**
```bash
# 1. Nginx ì„¤ì¹˜
sudo apt update
sudo apt install nginx -y

# 2. Nginx ì„œë¹„ìŠ¤ ì‹œì‘
sudo systemctl start nginx
sudo systemctl enable nginx

# 3. ë°©í™”ë²½ ì„¤ì • (UFW ì‚¬ìš© ì‹œ)
sudo ufw allow 'Nginx Full'

# 4. ì„¤ì¹˜ í™•ì¸
curl http://localhost
# "Welcome to nginx!" ë©”ì‹œì§€ ì¶œë ¥ë˜ë©´ ì •ìƒ

# 5. Nginx ì„¤ì • íŒŒì¼ ìœ„ì¹˜ í™•ì¸
ls /etc/nginx/
ls /var/log/nginx/
# access.log: ì ‘ê·¼ ë¡œê·¸
# error.log: ì—ëŸ¬ ë¡œê·¸
```

**Nginx ë¡œê·¸ í˜•ì‹:**
```bash
# /var/log/nginx/access.log ì˜ˆì‹œ
192.168.1.100 - - [21/Jan/2025:14:23:45 +0900] "GET / HTTP/1.1" 200 615 "-" "Mozilla/5.0"

# í˜•ì‹: IP - - [ì‹œê°„] "ë©”ì†Œë“œ URI í”„ë¡œí† ì½œ" ìƒíƒœì½”ë“œ ë°”ì´íŠ¸ "ë¦¬í¼ëŸ¬" "User-Agent"
```

**ë³´ì•ˆ ì¸ì‚¬ì´íŠ¸:**
- Nginx ë¡œê·¸ëŠ” Splunk Forwarderë¡œ ìˆ˜ì§‘í•˜ì—¬ ì›¹ ê³µê²© íŒ¨í„´ ë¶„ì„ ê°€ëŠ¥
- access.logì—ì„œ 404 ë‹¤ë°œ ì‹œ ë””ë ‰í† ë¦¬ íƒìƒ‰ ê³µê²© ì˜ì‹¬
- ë¹„ì •ìƒì ì¸ User-AgentëŠ” ìë™í™” ê³µê²© ë„êµ¬ ì‹œê·¸ë‹ˆì²˜

### ì‹¤ìŠµ 2-1: Splunk ìƒ˜í”Œ ë°ì´í„° ì—…ë¡œë“œ

**ëª©í‘œ:** tutorialdata.zipì„ ì´ìš©í•œ Splunk ê²€ìƒ‰ ì‹¤ìŠµ ì¤€ë¹„

**ì‹¤ìŠµ í™˜ê²½:**
- Splunk ì›¹ UI

**ì‹¤ìŠµ ë‹¨ê³„:**
```bash
# 1. Splunk ì›¹ UI ë¡œê·¸ì¸
# http://[Ubuntu_IP]:8000
# admin / 12345678

# 2. ìƒ˜í”Œ ë°ì´í„° ë‹¤ìš´ë¡œë“œ
# Settings > Add Data > Upload
# íŒŒì¼: tutorialdata.zip (Splunk ê³µì‹ íŠœí† ë¦¬ì–¼ ë°ì´í„°)

# 3. ì¸ë±ìŠ¤ ìƒì„±
# Settings > Indexes > New Index
# Index Name: test_index
# Max Size: 500MB

# 4. ë°ì´í„° ì—…ë¡œë“œ ì„¤ì •
# Source type: Automatic
# Host: ubuntu
# Index: test_index

# 5. ë°ì´í„° í™•ì¸
# Search & Reporting ì•± ì‹¤í–‰
# ê²€ìƒ‰ì°½ì— ì…ë ¥: index="test_index"
```

**tutorialdata.zip ë°ì´í„° êµ¬ì¡°:**
```
ë°ì´í„° ì¢…ë¥˜:
- access_combined_wcookie: ì›¹ ì„œë²„ ì ‘ê·¼ ë¡œê·¸ (Apache Combined + ì¿ í‚¤)
- secure-2: Linux ë³´ì•ˆ ë¡œê·¸ (/var/log/secure í˜•ì‹)
- vendor_sales: íŒë§¤/ì˜ì—… ë°ì´í„° (CSV í˜•ì‹)

ì£¼ìš” í•„ë“œ:
- clientip: í´ë¼ì´ì–¸íŠ¸ IP ì£¼ì†Œ
- status: HTTP ìƒíƒœ ì½”ë“œ (200, 404, 500 ë“±)
- action: ì‚¬ìš©ì í–‰ë™ (purchase, addtocart, view ë“±)
- product_name, productId: ìƒí’ˆ ì •ë³´
- price: ê°€ê²©
```

**ë³´ì•ˆ ì¸ì‚¬ì´íŠ¸:**
- ì‹¤ì œ í™˜ê²½ì—ì„œëŠ” Forwarderë¡œ ì‹¤ì‹œê°„ ë¡œê·¸ ìˆ˜ì§‘
- ì¸ë±ìŠ¤ ë¶„ë¦¬ë¡œ ê²€ìƒ‰ ì„±ëŠ¥ ìµœì í™” (web, security, firewall ë“±)
- ë°ì´í„° ë³´ì¡´ ê¸°ê°„ ì •ì±… ì„¤ì • í•„ìš” (ë²•ì  ìš”êµ¬ì‚¬í•­)

### ì‹¤ìŠµ 2-2: Splunk ê¸°ë³¸ ê²€ìƒ‰ ì‹¤ìŠµ

**ëª©í‘œ:** SPL í‚¤ì›Œë“œ ê²€ìƒ‰ ë° ì—°ì‚°ì ì‚¬ìš©ë²• í•™ìŠµ

**ì‹¤ìŠµ í™˜ê²½:**
- Splunk ì›¹ UI
- test_index

**ì‹¤ìŠµ ë‹¨ê³„:**
```bash
# 1. ë‹¨ìˆœ í‚¤ì›Œë“œ ê²€ìƒ‰
source="tutorialdata.zip:*" host="ubuntu" index="test_index" port
# ê²°ê³¼: "port" ë¬¸ìì—´ì´ í¬í•¨ëœ ëª¨ë“  ì´ë²¤íŠ¸

# 2. ì™€ì¼ë“œì¹´ë“œ ê²€ìƒ‰
source="tutorialdata.zip:*" host="ubuntu" index="test_index" por*
# ê²°ê³¼: port, portal, pork ë“± "por"ë¡œ ì‹œì‘í•˜ëŠ” ëª¨ë“  ë‹¨ì–´

# 3. ë‹¤ì¤‘ í‚¤ì›Œë“œ ê²€ìƒ‰ (AND ì•”ë¬µì )
source="tutorialdata.zip:*" host="ubuntu" index="test_index" port mongodb
# ê²°ê³¼: "port"ì™€ "mongodb" ë‘˜ ë‹¤ í¬í•¨ëœ ì´ë²¤íŠ¸

# 4. ì •í™•í•œ ë¬¸ìì—´ ê²€ìƒ‰ (ë”°ì˜´í‘œ ì‚¬ìš©)
source="tutorialdata.zip:*" host="ubuntu" index="test_index" "mongodb from"
# ê²°ê³¼: "mongodb from" ì •í™•íˆ ì´ ìˆœì„œë¡œ í¬í•¨ëœ ì´ë²¤íŠ¸ë§Œ

# 5. ë¶€ìš¸ ì—°ì‚°ì - AND
source="tutorialdata.zip:*" host="ubuntu" index="test_index" mongodb AND 194.8.74.23
# ê²°ê³¼: "mongodb"ì™€ "194.8.74.23" ëª¨ë‘ í¬í•¨

# 6. ë¶€ìš¸ ì—°ì‚°ì - OR (ê´„í˜¸ë¡œ ê·¸ë£¹í•‘)
source="tutorialdata.zip:*" host="ubuntu" index="test_index" mongodb AND (194.8.74.23 OR 85.62.218.82)
# ê²°ê³¼: mongodb + (IP1 ë˜ëŠ” IP2)

# 7. í˜¸ìŠ¤íŠ¸ ì™€ì¼ë“œì¹´ë“œ
source="tutorialdata.zip:*" index="test_index" host=u*
# ê²°ê³¼: í˜¸ìŠ¤íŠ¸ëª…ì´ "u"ë¡œ ì‹œì‘í•˜ëŠ” ëª¨ë“  ì´ë²¤íŠ¸
```

**SPL ê²€ìƒ‰ ì›ë¦¬:**
```
ê²€ìƒ‰ ì²˜ë¦¬ ê³¼ì •:
1. ì¸ë±ìŠ¤ì—ì„œ í‚¤ì›Œë“œ ë§¤ì¹­ ì´ë²¤íŠ¸ ì¶”ì¶œ (ì—­ì¸ë±ìŠ¤ í™œìš©)

2. ë¶€ìš¸ ì—°ì‚°ìë¡œ í•„í„°ë§ (AND, OR, NOT)

3. í•„ë“œ ì¶”ì¶œ (ìë™ ë˜ëŠ” ì •ê·œí‘œí˜„ì‹)

4. íƒ€ì„ìŠ¤íƒ¬í”„ ìˆœì„œë¡œ ì •ë ¬

5. ê²°ê³¼ ë°˜í™˜ (ê¸°ë³¸ 10,000ê°œ ì œí•œ)
```

**ê²€ìƒ‰ ìµœì í™” íŒ:**
- ê°€ëŠ¥í•œ ì¸ë±ìŠ¤ì™€ sourcetype ëª…ì‹œ (ê²€ìƒ‰ ë²”ìœ„ ì¶•ì†Œ)
- ì‹œê°„ ë²”ìœ„ ì œí•œ (Last 24 hours, Last 7 days ë“±)
- ì™€ì¼ë“œì¹´ë“œëŠ” í•„ìš”í•œ ê²½ìš°ì—ë§Œ ì‚¬ìš© (ì„±ëŠ¥ ì €í•˜)
- ë³µì¡í•œ ì •ê·œí‘œí˜„ì‹ë³´ë‹¤ ê°„ë‹¨í•œ í‚¤ì›Œë“œ ì¡°í•© ì„ í˜¸

### ì‹¤ìŠµ 2-3: Splunk íŒŒì´í”„ë¼ì¸ ëª…ë ¹ì–´ ì‹¤ìŠµ

**ëª©í‘œ:** `table`, `sort`, `top`, `rare` ëª…ë ¹ì–´ë¡œ ë°ì´í„° ë³€í™˜

**ì‹¤ìŠµ í™˜ê²½:**
- Splunk ì›¹ UI
- test_index

**ì‹¤ìŠµ ë‹¨ê³„:**
```bash
# 1. table: íŠ¹ì • í•„ë“œë§Œ í…Œì´ë¸” í˜•ì‹ìœ¼ë¡œ ì¶œë ¥
host="*" index="test_index" | table Code, AcctID, sourcetype
# ê²°ê³¼: Code, AcctID, sourcetype ì»¬ëŸ¼ë§Œ í‘œì‹œ

# 2. sort: ì •ë ¬
host="*" index="test_index" | table Code, AcctID, source, sourcetype | sort Code
# ê²°ê³¼: Code í•„ë“œ ê¸°ì¤€ ì˜¤ë¦„ì°¨ìˆœ ì •ë ¬

# 3. top: ë¹ˆë„ìˆ˜ ìƒìœ„ í•­ëª©
host="*" index="test_index" | table Code, AcctID, source, sourcetype | top Code
# ê²°ê³¼: Code ê°’ë³„ ê°œìˆ˜ì™€ ë¹„ìœ¨, ìƒìœ„ 10ê°œ

# 4. top limit: ê°œìˆ˜ ì œí•œ
host="*" index="test_index" | top Code limit=5
# ê²°ê³¼: ìƒìœ„ 5ê°œë§Œ í‘œì‹œ

# 5. rare: ë¹ˆë„ìˆ˜ í•˜ìœ„ í•­ëª©
host="*" index="test_index" | rare Code limit=5
# ê²°ê³¼: ê°€ì¥ ë“œë¬¸ Code 5ê°œ
```

**íŒŒì´í”„ë¼ì¸ ëª…ë ¹ì–´ ì›ë¦¬:**
```
ëª…ë ¹ì–´ ì²´ì´ë‹:
ê²€ìƒ‰ ê²°ê³¼ â†’ | table â†’ | sort â†’ | top â†’ ìµœì¢… ì¶œë ¥

ê° ë‹¨ê³„ë§ˆë‹¤ ì´ì „ ê²°ê³¼ë¥¼ ì…ë ¥ìœ¼ë¡œ ë°›ì•„ ë³€í™˜
```

**ì£¼ìš” ëª…ë ¹ì–´ ë¹„êµ:**

| ëª…ë ¹ì–´ | ê¸°ëŠ¥ | ì‚¬ìš© ì˜ˆì‹œ | ì¶œë ¥ í˜•ì‹ |
|:---:|:---|:---|:---|
| `table` | íŠ¹ì • í•„ë“œë§Œ ì„ íƒ | `table clientip, status` | ì›ë³¸ ë°ì´í„° ê·¸ëŒ€ë¡œ |
| `sort` | ì •ë ¬ | `sort -_time` (ìµœì‹ ìˆœ) | ì •ë ¬ëœ í…Œì´ë¸” |
| `top` | ë¹ˆë„ìˆ˜ ìƒìœ„ | `top clientip limit=10` | ê°œìˆ˜, ë¹„ìœ¨ í¬í•¨ |
| `rare` | ë¹ˆë„ìˆ˜ í•˜ìœ„ | `rare uri limit=5` | ê°œìˆ˜, ë¹„ìœ¨ í¬í•¨ |
| `stats` | í†µê³„ ê³„ì‚° | `stats count by status` | ì§‘ê³„ ê²°ê³¼ |

**ë³´ì•ˆ ì¸ì‚¬ì´íŠ¸:**
- `top clientip`ë¡œ ê°€ì¥ ë§ì´ ì ‘ì†í•œ IP íƒì§€ (DDoS ì˜ì‹¬)
- `rare uri`ë¡œ ë¹„ì •ìƒì ì¸ ì ‘ê·¼ ê²½ë¡œ ë°œê²¬ (ì›¹ì‰˜, ë°±ë„ì–´)
- `top status=404`ë¡œ ë””ë ‰í† ë¦¬ ìŠ¤ìº” ê³µê²© íƒì§€

### ì‹¤ìŠµ 3-1: ê³ ê¸‰ SPL - VIP ê³ ê° ë¶„ì„ ì¿¼ë¦¬

**ëª©í‘œ:** ì„œë¸Œê²€ìƒ‰ê³¼ í†µê³„ ëª…ë ¹ì–´ë¡œ ë³µì¡í•œ ë¶„ì„ ìˆ˜í–‰

**ì‹¤ìŠµ í™˜ê²½:**
- Splunk ì›¹ UI
- test_index

**ì‹¤ìŠµ ë‹¨ê³„:**
```bash
# ì¿¼ë¦¬ ì „ì²´:
index=test_index sourcetype=access_* status=200 action=purchase 
    [search index=test_index sourcetype=access_* status=200 action=purchase 
     | top limit=1 clientip 
     | table clientip] 
| stats count AS "Total Purchased", 
        dc(productId) AS "Total Products", 
        values(product_name) AS "Product Names" 
  BY clientip 
| rename clientip AS "VIP Customer"

# ì‹¤í–‰ ê²°ê³¼ ì˜ˆì‹œ:
# VIP Customer      | Total Purchased | Total Products | Product Names
# 87.194.216.51     | 47              | 12             | Laptop, Mouse, Keyboard, Monitor...
```

**ì¿¼ë¦¬ ë¶„í•´ ì„¤ëª…:**
```bash
# 1ë‹¨ê³„: ì„œë¸Œê²€ìƒ‰ (ê°€ì¥ ë§ì´ êµ¬ë§¤í•œ ê³ ê° 1ëª… ì°¾ê¸°)
[search index=test_index sourcetype=access_* status=200 action=purchase 
 | top limit=1 clientip 
 | table clientip]
# ê²°ê³¼: clientip="87.194.216.51"

# 2ë‹¨ê³„: ë©”ì¸ ê²€ìƒ‰ (í•´ë‹¹ ê³ ê°ì˜ êµ¬ë§¤ ì´ë²¤íŠ¸ë§Œ í•„í„°ë§)
index=test_index sourcetype=access_* status=200 action=purchase 
    [ì„œë¸Œê²€ìƒ‰ ê²°ê³¼ ìë™ ì‚½ì…]
# íš¨ê³¼: clientip="87.194.216.51" ì¡°ê±´ ìë™ ì¶”ê°€

# 3ë‹¨ê³„: í†µê³„ ê³„ì‚°
| stats 
    count AS "Total Purchased",              # ì´ êµ¬ë§¤ íšŸìˆ˜
    dc(productId) AS "Total Products",       # ê³ ìœ  ìƒí’ˆ ê°œìˆ˜ (distinct count)
    values(product_name) AS "Product Names"  # êµ¬ë§¤í•œ ìƒí’ˆ ëª©ë¡
  BY clientip

# 4ë‹¨ê³„: í•„ë“œëª… ë³€ê²½ (ë³´ê³ ì„œ ê°€ë…ì„±)
| rename clientip AS "VIP Customer"
```

**ì„œë¸Œê²€ìƒ‰ ë™ì‘ ì›ë¦¬:**
```
ì‹¤í–‰ ìˆœì„œ:
1. [ ] ì•ˆì˜ ì„œë¸Œê²€ìƒ‰ ë¨¼ì € ì‹¤í–‰
2. ì„œë¸Œê²€ìƒ‰ ê²°ê³¼ê°€ ë©”ì¸ ê²€ìƒ‰ì˜ ì¡°ê±´ìœ¼ë¡œ ì‚½ì…
3. ë©”ì¸ ê²€ìƒ‰ ì‹¤í–‰
4. í†µê³„ ë° ë³€í™˜ ëª…ë ¹ì–´ ìˆœì°¨ ì²˜ë¦¬

ì œì•½ì‚¬í•­:
- ì„œë¸Œê²€ìƒ‰ ê²°ê³¼ëŠ” ìµœëŒ€ 10,000ê°œ ì œí•œ
- ì¤‘ì²© ì„œë¸Œê²€ìƒ‰ì€ ìµœëŒ€ 2ë‹¨ê³„ê¹Œì§€
- ì„±ëŠ¥ ë¶€í•˜ ì£¼ì˜ (í° ë°ì´í„°ì…‹ì—ì„œëŠ” join ë˜ëŠ” lookup ì‚¬ìš©)
```

**ë³´ì•ˆ ì¸ì‚¬ì´íŠ¸:**
- VIP ê³ ê° í–‰ë™ íŒ¨í„´ ë¶„ì„ìœ¼ë¡œ ê³„ì • íƒˆì·¨ íƒì§€
- ë¹„ì •ìƒì ì¸ ëŒ€ëŸ‰ êµ¬ë§¤ëŠ” ì¹´ë“œ ë„ìš© ì˜ì‹¬
- ê³ ê°ë³„ ì ‘ì† êµ­ê°€ ë³€í™” ëª¨ë‹ˆí„°ë§ (ì§€ë¦¬ì  ì´ìƒ íƒì§€)

### ì‹¤ìŠµ 3-2: ìƒí’ˆ ì „í™˜ìœ¨ ë¶„ì„ ì¿¼ë¦¬

**ëª©í‘œ:** ì¡°íšŒ â†’ ì¥ë°”êµ¬ë‹ˆ â†’ êµ¬ë§¤ ë‹¨ê³„ë³„ ì „í™˜ìœ¨ ê³„ì‚°

**ì‹¤ìŠµ í™˜ê²½:**
- Splunk ì›¹ UI
- test_index

**ì‹¤ìŠµ ë‹¨ê³„:**
```bash
# ì¿¼ë¦¬ ì „ì²´:
index="test_index" sourcetype=access_* status=200 
| stats 
    count AS views, 
    count(eval(action="addtocart")) AS addtocart, 
    count(eval(action="purchase")) AS purchases 
  by product_name 
| eval 
    viewsToPurchases = round((purchases/views)*100, 2), 
    cartToPurchases = round((purchases/addtocart)*100, 2) 
| table product_name, views, addtocart, purchases, viewsToPurchases, cartToPurchases 
| rename 
    product_name AS "Product Name", 
    views AS "Views", 
    addtocart AS "Adds To Cart", 
    purchases AS "Purchases", 
    viewsToPurchases AS "Viewâ†’Purchase(%)", 
    cartToPurchases AS "Cartâ†’Purchase(%)"
```

**ì¿¼ë¦¬ ë¶„í•´ ì„¤ëª…:**
```bash
# 1ë‹¨ê³„: ì¡°ê±´ë¶€ ì¹´ìš´íŠ¸ (eval í•¨ìˆ˜ ì‚¬ìš©)
| stats 
    count AS views,                            # ì „ì²´ ì¡°íšŒìˆ˜
    count(eval(action="addtocart")) AS addtocart,  # actionì´ "addtocart"ì¸ ê²ƒë§Œ ì¹´ìš´íŠ¸
    count(eval(action="purchase")) AS purchases    # actionì´ "purchase"ì¸ ê²ƒë§Œ ì¹´ìš´íŠ¸
  by product_name

# 2ë‹¨ê³„: ì „í™˜ìœ¨ ê³„ì‚° (eval ëª…ë ¹ì–´)
| eval 
    viewsToPurchases = round((purchases/views)*100, 2),      # ì¡°íšŒâ†’êµ¬ë§¤: (êµ¬ë§¤/ì¡°íšŒ)*100
    cartToPurchases = round((purchases/addtocart)*100, 2)   # ì¥ë°”êµ¬ë‹ˆâ†’êµ¬ë§¤: (êµ¬ë§¤/ì¥ë°”êµ¬ë‹ˆ)*100

# round() í•¨ìˆ˜: ì†Œìˆ˜ì  ë‘˜ì§¸ ìë¦¬ê¹Œì§€ ë°˜ì˜¬ë¦¼

# 3ë‹¨ê³„: ë³´ê³ ì„œ í˜•ì‹ ì •ë¦¬
| table product_name, views, addtocart, purchases, viewsToPurchases, cartToPurchases
| rename ... (í•œê¸€ëª…ìœ¼ë¡œ ë³€ê²½)
```

**ì‹¤í–‰ ê²°ê³¼ ì˜ˆì‹œ:**
```
Product Name | Views | Adds To Cart | Purchases | Viewâ†’Purchase(%) | Cartâ†’Purchase(%)
Laptop       | 523   | 87           | 23        | 4.40             | 26.44
Mouse        | 891   | 134          | 67        | 7.52             | 50.00
Keyboard     | 412   | 56           | 18        | 4.37             | 32.14
```

**eval í•¨ìˆ˜ í™œìš©:**
- `round(ê°’, ìë¦¬ìˆ˜)`: ë°˜ì˜¬ë¦¼
- `if(ì¡°ê±´, ì°¸, ê±°ì§“)`: ì¡°ê±´ë¶€ ê°’
- `case()`: ë‹¤ì¤‘ ì¡°ê±´ ì²˜ë¦¬
- `tonumber()`, `tostring()`: í˜•ë³€í™˜

**ë³´ì•ˆ ì¸ì‚¬ì´íŠ¸:**
- ì „í™˜ìœ¨ ê¸‰ë½ ì‹œ ì›¹ ì‚¬ì´íŠ¸ ì¥ì•  ë˜ëŠ” ê³µê²© ì˜ì‹¬
- íŠ¹ì • ìƒí’ˆë§Œ ì¥ë°”êµ¬ë‹ˆ ì¶”ê°€ í›„ êµ¬ë§¤ ì•ˆ í•˜ë©´ ê°€ê²© ì¡°ì‘ ì‹œë„ ê°€ëŠ¥
- ë¹„ì •ìƒì ìœ¼ë¡œ ë†’ì€ ì „í™˜ìœ¨ì€ ë´‡ í™œë™ ì˜ì‹¬

### ì‹¤ìŠµ 3-3: ì‹œê³„ì—´ ì°¨íŠ¸ ìƒì„±

**ëª©í‘œ:** `timechart` ëª…ë ¹ì–´ë¡œ ì‹œê°„ëŒ€ë³„ ì¶”ì´ ì‹œê°í™”

**ì‹¤ìŠµ í™˜ê²½:**
- Splunk ì›¹ UI
- test_index

**ì‹¤ìŠµ ë‹¨ê³„:**
```bash
# 1. ì‹œê°„ëŒ€ë³„ ìƒí’ˆ êµ¬ë§¤ ì¶”ì´
index="test_index" sourcetype=access_* 
| timechart count(eval(action="purchase")) by product_name usenull=f useother=f

# ì‹¤í–‰ ê²°ê³¼:
# Xì¶•: ì‹œê°„ (ìë™ìœ¼ë¡œ ì ì ˆí•œ ê°„ê²© ì„ íƒ)
# Yì¶•: êµ¬ë§¤ íšŸìˆ˜
# ì„ (Series): ê° ìƒí’ˆë³„

# 2. ìƒìœ„ ì¹´í…Œê³ ë¦¬ ë¶„ì„
index="test_index" sourcetype=access_* status=200 action=purchase 
| top categoryId

# ì‹¤í–‰ ê²°ê³¼:
# categoryId | count | percent
# ELECTRONICS| 523   | 34.2%
# CLOTHING   | 412   | 26.9%
# BOOKS      | 305   | 19.9%
```

**timechart ì˜µì…˜:**
- `span=1m`: 1ë¶„ ë‹¨ìœ„ë¡œ ì§‘ê³„
- `usenull=f`: NULL ê°’ ì œì™¸
- `useother=f`: ê¸°íƒ€(Other) ê·¸ë£¹ ì œì™¸
- `by í•„ë“œëª…`: í•„ë“œë³„ë¡œ ì‹œë¦¬ì¦ˆ ë¶„ë¦¬

**ì°¨íŠ¸ ìœ í˜•:**
- Line Chart: ì‹œê°„ ì¶”ì´ (ê¸°ë³¸)
- Column Chart: ë§‰ëŒ€ ê·¸ë˜í”„
- Area Chart: ì˜ì—­ ê·¸ë˜í”„
- Pie Chart: ì›í˜• ì°¨íŠ¸ (top ëª…ë ¹ì–´ì™€ í•¨ê»˜)

**ë³´ì•ˆ ì¸ì‚¬ì´íŠ¸:**
- ì‹œê°„ëŒ€ë³„ íŠ¸ë˜í”½ ê¸‰ì¦ì€ DDoS ê³µê²© ì§•í›„
- íŠ¹ì • ì‹œê°„ëŒ€ íŠ¹ì • ìƒí’ˆ êµ¬ë§¤ í­ì¦ì€ ë´‡ í™œë™
- í‰ì†Œì™€ ë‹¤ë¥¸ íŒ¨í„´ íƒì§€ (Anomaly Detection)

### ì‹¤ìŠµ 4-1: ëŒ€ì‹œë³´ë“œ ìƒì„±

**ëª©í‘œ:** ê²€ìƒ‰ ê²°ê³¼ë¥¼ ëŒ€ì‹œë³´ë“œ íŒ¨ë„ë¡œ ì €ì¥

**ì‹¤ìŠµ í™˜ê²½:**
- Splunk ì›¹ UI

**ì‹¤ìŠµ ë‹¨ê³„:**
```bash
# 1. ê²€ìƒ‰ ì‹¤í–‰
index="test_index" sourcetype=access_* status=200 action=purchase 
| top categoryId

# 2. ê²€ìƒ‰ ê²°ê³¼ ìš°ì¸¡ ìƒë‹¨ "Save As" í´ë¦­
# - Dashboard Panel ì„ íƒ
# - Dashboard: "Sales Dashboard" (ì‹ ê·œ ìƒì„±)
# - Panel Title: "Top Categories"
# - Panel Content: Visualization (ì°¨íŠ¸) ë˜ëŠ” Statistics (í‘œ)

# 3. ì°¨íŠ¸ ìœ í˜• ì„ íƒ
# - Pie Chart ì„ íƒ
# - ìƒ‰ìƒ, ë ˆì´ë¸” ë“± ì»¤ìŠ¤í„°ë§ˆì´ì§•

# 4. ëŒ€ì‹œë³´ë“œ í™•ì¸
# Dashboards ë©”ë‰´ > Sales Dashboard

# 5. ì¶”ê°€ íŒ¨ë„ ìƒì„±
# ê°™ì€ ë°©ì‹ìœ¼ë¡œ ì—¬ëŸ¬ ê²€ìƒ‰ ê²°ê³¼ë¥¼ í•˜ë‚˜ì˜ ëŒ€ì‹œë³´ë“œì— ì¶”ê°€
# ì˜ˆ:
# - ì‹œê°„ëŒ€ë³„ êµ¬ë§¤ ì¶”ì´ (Line Chart)
# - ìƒìœ„ 10ê°œ IP (Table)
# - ìƒí’ˆë³„ ì „í™˜ìœ¨ (Column Chart)
```

**ëŒ€ì‹œë³´ë“œ êµ¬ì„± ì˜ˆì‹œ:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        Sales Dashboard (24ì‹œê°„)             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Top Categories      â”‚  Hourly Purchases    â”‚
â”‚  (Pie Chart)         â”‚  (Line Chart)        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Product Conversion Rate                    â”‚
â”‚  (Column Chart)                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Top 10 Customers                           â”‚
â”‚  (Table)                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ëŒ€ì‹œë³´ë“œ ê³ ê¸‰ ê¸°ëŠ¥:**
- ë“œë¦´ë‹¤ìš´: ì°¨íŠ¸ í´ë¦­ ì‹œ ìƒì„¸ ê²€ìƒ‰ìœ¼ë¡œ ì´ë™
- ì‹œê°„ ë²”ìœ„ ì„ íƒê¸°: ì‹¤ì‹œê°„, 1ì‹œê°„, 24ì‹œê°„, 7ì¼ ë“±
- ì…ë ¥ í•„í„°: ë“œë¡­ë‹¤ìš´, í…ìŠ¤íŠ¸ ì…ë ¥ìœ¼ë¡œ ë™ì  ê²€ìƒ‰
- ìë™ ìƒˆë¡œê³ ì¹¨: 30ì´ˆ, 1ë¶„, 5ë¶„ ê°„ê²©

**ë³´ì•ˆ ì¸ì‚¬ì´íŠ¸:**
- SOC ëŒ€ì‹œë³´ë“œ: ì‹¤ì‹œê°„ ê³µê²© íƒì§€, ì•Œë¦¼ í˜„í™©, TOP 10 ìœ„í˜‘
- ì„ì› ëŒ€ì‹œë³´ë“œ: ì›”ê°„ ì¹¨í•´ì‚¬ê³  ê±´ìˆ˜, ë³´ì•ˆ íˆ¬ì ROI
- ìš´ì˜ ëŒ€ì‹œë³´ë“œ: ì‹œìŠ¤í…œ ê°€ìš©ì„±, ë¡œê·¸ ìˆ˜ì§‘ëŸ‰, ì¸ë±ì„œ ìƒíƒœ

### ì‹¤ìŠµ 4-2: ë³´ê³ ì„œ ì €ì¥ ë° ì˜ˆì•½

**ëª©í‘œ:** ê²€ìƒ‰ ê²°ê³¼ë¥¼ PDF/CSVë¡œ ë‚´ë³´ë‚´ê¸° ë° ì •ê¸° ë³´ê³ ì„œ ì˜ˆì•½

**ì‹¤ìŠµ í™˜ê²½:**
- Splunk ï¿½eb UI

**ì‹¤ìŠµ ë‹¨ê³„:**
```bash
# 1. ê²€ìƒ‰ ì‹¤í–‰
index="test_index" sourcetype=access_* status=200 action=purchase 
| stats count AS "Total Purchased", 
        dc(productId) AS "Total Products" 
  BY clientip 
| rename clientip AS "Customer IP"

# 2. ê²€ìƒ‰ ì €ì¥
# Save As > Report
# Title: "Daily Purchase Report"
# Description: "ê³ ê°ë³„ ì¼ì¼ êµ¬ë§¤ í†µê³„"
# Time Range Picker: Yes (ë³´ê³ ì„œ ì‹¤í–‰ ì‹œ ì‹œê°„ ë²”ìœ„ ì„ íƒ ê°€ëŠ¥)

# 3. ë³´ê³ ì„œ ì˜ˆì•½ (Schedule)
# Edit > Edit Schedule
# Schedule Report: Enabled
# Schedule: Daily at 9:00 AM
# Time Range: Previous day
# Action: Email (ìˆ˜ì‹ ì ì´ë©”ì¼ ì…ë ¥)
# Format: PDF ë˜ëŠ” CSV

# 4. ì¦‰ì‹œ ë‚´ë³´ë‚´ê¸°
# Export > PDF ë˜ëŠ” CSV
# íŒŒì¼ ë‹¤ìš´ë¡œë“œí•˜ì—¬ ë³´ê´€
```

**ë³´ê³ ì„œ ìœ í˜•:**
- ì¼ì¼ ë³´ê³ ì„œ: ì „ë‚  ë³´ì•ˆ ì´ë²¤íŠ¸ ìš”ì•½
- ì£¼ê°„ ë³´ê³ ì„œ: ì£¼ê°„ TOP 10 ìœ„í˜‘, íŠ¸ë Œë“œ ë¶„ì„
- ì›”ê°„ ë³´ê³ ì„œ: ì›”ë³„ ì¹¨í•´ì‚¬ê³  í†µê³„, ëŒ€ì‘ í˜„í™©
- ì—°ê°„ ë³´ê³ ì„œ: ì—°ê°„ ë³´ì•ˆ íˆ¬ì ëŒ€ë¹„ íš¨ê³¼ ë¶„ì„

**ë³´ì•ˆ ì¸ì‚¬ì´íŠ¸:**
- ì •ê¸° ë³´ê³ ì„œë¡œ ê²½ì˜ì§„ì—ê²Œ ë³´ì•ˆ í˜„í™© ê°€ì‹œì„± ì œê³µ
- ê·œì œ ëŒ€ì‘: ISMS-P, ê°œì¸ì •ë³´ë³´í˜¸ë²• ì¤€ìˆ˜ ì¦ë¹™
- ì¹¨í•´ì‚¬ê³  ì´ë ¥ ê´€ë¦¬: ë²•ì  ë¶„ìŸ ì‹œ ì¦ê±° ìë£Œ

### ì‹¤ìŠµ 5-1: Splunk Forwarder ê°œë… í•™ìŠµ

**ëª©í‘œ:** Universal Forwarderì˜ ì—­í• ê³¼ ì„¤ì¹˜ ë°©ë²• ì´í•´

**Forwarder ê°œë…:**
```
Splunk Forwarderë€?
- ì›ê²© ì„œë²„ì— ì„¤ì¹˜í•˜ëŠ” ê²½ëŸ‰ ì—ì´ì „íŠ¸
- ë¡œì»¬ ë¡œê·¸ íŒŒì¼ì„ Splunk Indexerë¡œ ì „ì†¡
- CPU/ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ìµœì†Œí™” (ì•½ 50MB RAM)
- ë°ì´í„° ì••ì¶• ë° ì•”í˜¸í™” ì „ì†¡ (SSL/TLS)

Forwarder ì¢…ë¥˜:
1. Universal Forwarder (ê°€ì¥ ë§ì´ ì‚¬ìš©)
   - ë°ì´í„° ìˆ˜ì§‘ ë° ì „ì†¡ë§Œ ìˆ˜í–‰
   - íŒŒì‹± ë° ì¸ë±ì‹±ì€ Indexerì—ì„œ ì²˜ë¦¬
   
2. Heavy Forwarder
   - ë°ì´í„° íŒŒì‹± ë° í•„í„°ë§ ê°€ëŠ¥
   - ë¯¼ê° ì •ë³´ ë§ˆìŠ¤í‚¹, ë°ì´í„° ë³€í™˜ ë“±
```

**Forwarder ì„¤ì¹˜ ê³¼ì • (ì´ë¡ ):**
```bash
# Ubuntu Forwarder ì„¤ì¹˜ ì˜ˆì‹œ (ì‹¤ì œ ì‹¤ìŠµì€ ì•ˆ í•¨)

# 1. Forwarder íŒ¨í‚¤ì§€ ì„¤ì¹˜
sudo dpkg -i splunkforwarder-8.2.0-*.deb

# 2. ë¶€íŒ… ì‹œ ìë™ ì‹œì‘
sudo /opt/splunkforwarder/bin/splunk enable boot-start

# 3. Splunk ì„œë²„ ì—°ê²° ì„¤ì • (í¬íŠ¸ 9997)
sudo /opt/splunkforwarder/bin/splunk add forward-server 192.168.x.x:9997

# 4. ëª¨ë‹ˆí„°ë§í•  ë¡œê·¸ íŒŒì¼ ì„¤ì •
sudo nano /opt/splunkforwarder/etc/system/local/inputs.conf

[monitor:///var/log/nginx/access.log]
disabled = false
index = web
sourcetype = access_combined

[monitor:///var/log/auth.log]
disabled = false
index = security
sourcetype = syslog

# 5. Forwarder ì¬ì‹œì‘
sudo /opt/splunkforwarder/bin/splunk restart
```

**Forwarder í†µì‹  í¬íŠ¸:**
- 9997: Forwarder â†’ Indexer (ê¸°ë³¸ ìˆ˜ì‹  í¬íŠ¸)
- 8089: Splunk Management Port (ì„¤ì • ë³€ê²½ìš©)

**ë³´ì•ˆ ì¸ì‚¬ì´íŠ¸:**
- ForwarderëŠ” ì½ê¸° ì „ìš© ê¶Œí•œë§Œ í•„ìš” (ë¡œê·¸ íŒŒì¼ ë³€ì¡° ë°©ì§€)
- SSL ì•”í˜¸í™”ë¡œ ì „ì†¡ ì¤‘ ë°ì´í„° ë³´í˜¸
- ë„¤íŠ¸ì›Œí¬ ì„¸ê·¸ë¨¼í…Œì´ì…˜: DMZ ì„œë²„ëŠ” ë³„ë„ Forwarder ì‚¬ìš©

---

## 3. Splunk ëª…ë ¹ì–´ ë¹„êµí‘œ

### ê²€ìƒ‰ ë° í•„í„°ë§ ëª…ë ¹ì–´

| ëª…ë ¹ì–´ | ê¸°ëŠ¥ | ì‚¬ìš© ì˜ˆì‹œ | ì¶œë ¥ ê²°ê³¼ |
|:---:|:---|:---|:---|
| `search` | ê¸°ë³¸ ê²€ìƒ‰ (ìƒëµ ê°€ëŠ¥) | `search port` | í‚¤ì›Œë“œ í¬í•¨ ì´ë²¤íŠ¸ |
| `where` | ì¡°ê±´ í•„í„°ë§ | `where status=200` | ì¡°ê±´ ë§Œì¡± ì´ë²¤íŠ¸ë§Œ |
| `fields` | í•„ë“œ ì„ íƒ/ì œì™¸ | `fields clientip, status` | ì„ íƒëœ í•„ë“œë§Œ í‘œì‹œ |
| `dedup` | ì¤‘ë³µ ì œê±° | `dedup clientip` | ê³ ìœ  IPë§Œ í‘œì‹œ |
| `head` | ìƒìœ„ Nê°œ | `head 10` | ì²˜ìŒ 10ê°œ ì´ë²¤íŠ¸ |
| `tail` | í•˜ìœ„ Nê°œ | `tail 10` | ë§ˆì§€ë§‰ 10ê°œ ì´ë²¤íŠ¸ |

### í†µê³„ ë° ì§‘ê³„ ëª…ë ¹ì–´

| ëª…ë ¹ì–´ | ê¸°ëŠ¥ | ì‚¬ìš© ì˜ˆì‹œ | ì¶œë ¥ ê²°ê³¼ |
|:---:|:---|:---|:---|
| `stats` | í†µê³„ ê³„ì‚° | `stats count by status` | ìƒíƒœë³„ ê°œìˆ˜ |
| `count` | ì´ë²¤íŠ¸ ê°œìˆ˜ | `stats count` | ì´ ì´ë²¤íŠ¸ ìˆ˜ |
| `dc()` | ê³ ìœ ê°’ ê°œìˆ˜ | `stats dc(clientip)` | ê³ ìœ  IP ê°œìˆ˜ |
| `values()` | ê³ ìœ ê°’ ëª©ë¡ | `stats values(uri)` | ê³ ìœ  URI ëª©ë¡ |
| `sum()` | í•©ê³„ | `stats sum(bytes)` | ë°”ì´íŠ¸ ì´í•© |
| `avg()` | í‰ê·  | `stats avg(response_time)` | í‰ê·  ì‘ë‹µ ì‹œê°„ |
| `min()` / `max()` | ìµœì†Œ/ìµœëŒ€ | `stats max(price)` | ìµœê³  ê°€ê²© |

### ì‹œê°í™” ëª…ë ¹ì–´

| ëª…ë ¹ì–´ | ê¸°ëŠ¥ | ì‚¬ìš© ì˜ˆì‹œ | ì°¨íŠ¸ ìœ í˜• |
|:---:|:---|:---|:---|
| `timechart` | ì‹œê³„ì—´ ì°¨íŠ¸ | `timechart count by status` | Line Chart |
| `chart` | ì¼ë°˜ ì°¨íŠ¸ | `chart count by product, status` | Column Chart |
| `top` | ë¹ˆë„ìˆ˜ ìƒìœ„ | `top clientip limit=10` | Pie Chart |
| `rare` | ë¹ˆë„ìˆ˜ í•˜ìœ„ | `rare uri limit=5` | Table |

---

## 4. ì‹¬í™” ë¶„ì„

### SPL ì¿¼ë¦¬ íŒ¨í„´ ë¶„ì„

| ì¿¼ë¦¬ íŒ¨í„´ | ì„¤ëª… | ì‚¬ìš© ì‚¬ë¡€ | ë³´ì•ˆ ì ìš© |
|:---:|:---|:---|:---|
| **ì„œë¸Œê²€ìƒ‰** | `[ ]` ì•ˆì˜ ê²€ìƒ‰ ê²°ê³¼ë¥¼ ì™¸ë¶€ ì¿¼ë¦¬ ì¡°ê±´ìœ¼ë¡œ ì‚¬ìš© | VIP ê³ ê°ì˜ í–‰ë™ ë¶„ì„ | ê³µê²©ì IP ì°¾ê¸° í›„ ì „ì²´ í™œë™ ì¶”ì  |
| **ì¡°ê±´ë¶€ ì§‘ê³„** | `count(eval(ì¡°ê±´))` | íŠ¹ì • ì¡°ê±´ ë§Œì¡±í•˜ëŠ” ì´ë²¤íŠ¸ë§Œ ì¹´ìš´íŠ¸ | ì‹¤íŒ¨í•œ ë¡œê·¸ì¸ íšŸìˆ˜ ì§‘ê³„ |
| **í•„ë“œ ê³„ì‚°** | `eval í•„ë“œëª… = ìˆ˜ì‹` | ì „í™˜ìœ¨, ë¹„ìœ¨ ê³„ì‚° | ì„±ê³µë¥ , íƒì§€ìœ¨ ê³„ì‚° |
| **íŒŒì´í”„ë¼ì¸** | `ê²€ìƒ‰ | ë³€í™˜ | ì§‘ê³„ | ì •ë ¬` | ë‹¤ë‹¨ê³„ ë°ì´í„° ë³€í™˜ | ê³µê²© IP â†’ êµ­ê°€ â†’ í†µê³„ |

### ì‹¤ì „ ë³´ì•ˆ ì¿¼ë¦¬ ì˜ˆì‹œ (ë¬¸ì„œ ê¸°ë°˜)

```bash
# 1. HTTP ìƒíƒœ ì½”ë“œë³„ í†µê³„ (ê³µê²© íƒì§€)
index=web sourcetype="access_combined" 
| stats count as hits by status 
| sort - hits

# 2. ìƒìœ„ 20ê°œ ê³µê²© IP (DDoS íƒì§€)
index=web sourcetype="access_combined" 
| stats count as hits by clientip 
| sort - hits 
| head 20

# 3. 404 ì—ëŸ¬ ë§ì€ URI (ë””ë ‰í† ë¦¬ ìŠ¤ìº” íƒì§€)
index=web sourcetype="access_combined" status=404 
| stats count as notfound_cnt by uri 
| sort - notfound_cnt 
| head 20

# 4. 1ë¶„ ë‹¨ìœ„ ì‹œê°„ëŒ€ë³„ íŠ¸ë˜í”½ ì¶”ì´ (DDoS íŒ¨í„´ ë¶„ì„)
index=web sourcetype="access_combined" 
| timechart span=1m count by status

# 5. SQL Injection/XSS í˜ì´ë¡œë“œ íƒì§€
index=web sourcetype="access_combined" 
    ("union select" OR "select * from" OR "etc/passwd" OR "<script" OR "%3Cscript%3E") 
| stats count by clientip, uri 
| sort - count

# 6. SSH ë¡œê·¸ì¸ ì‹¤íŒ¨ ì‹œë„ (Brute Force íƒì§€)
index=waf sourcetype="access_combined" "Failed password" 
| rex "from (?<src_ip>\d+\.\d+\.\d+\.\d+)" 
| stats count as fail_cnt by src_ip 
| sort - fail_cnt 
| head 20

# 7. Windows ë³´ì•ˆ ì´ë²¤íŠ¸ ì§‘ê³„
index=* host="ìœˆë„ìš°ì‹œìŠ¤í…œì´ë¦„" source="WinEventLog:Security" 
| stats count by EventCode 
| sort - count

# 8. íŠ¹ì • ì´ë²¤íŠ¸ ì½”ë“œ ìƒì„¸ ë¶„ì„ (EventCode 4673: ê¶Œí•œ ì‚¬ìš©)
index=* host="ìœˆë„ìš°ì‹œìŠ¤í…œì´ë¦„" source="WinEventLog:Security" EventCode=4673 
| table _time EventCode Account_Name Message 
| sort _time
```

---

## 5. ì‹¤ë¬´/ë³´ì•ˆ ì ìš©

### SOC ë¶„ì„ê°€ ê´€ì  - Splunk í™œìš© ì‹œë‚˜ë¦¬ì˜¤

| ì‹œë‚˜ë¦¬ì˜¤ | íƒì§€ ì¿¼ë¦¬ | ëŒ€ì‘ ë°©ì•ˆ |
|:---|:---|:---|
| **ì›¹ ê³µê²© íƒì§€** | `index=web (sql OR xss OR ../)`<br>`| stats count by clientip` | ê³µê²© IP ì°¨ë‹¨, WAF ë£° ì—…ë°ì´íŠ¸ |
| **DDoS ê³µê²© íƒì§€** | `index=web | timechart span=1m count`<br>(ê¸‰ê²©í•œ íŠ¸ë˜í”½ ì¦ê°€ í™•ì¸) | ìƒìœ„ IP ì°¨ë‹¨, CDN í™œì„±í™” |
| **Brute Force íƒì§€** | `index=security "Failed password"`<br>`| stats count by src_ip` | 5íšŒ ì´ìƒ ì‹¤íŒ¨ IP ìë™ ì°¨ë‹¨ |
| **ë‚´ë¶€ì ìœ„í˜‘ íƒì§€** | `index=security (copy OR download)`<br>`| stats sum(bytes) by user` | ëŒ€ëŸ‰ íŒŒì¼ ìœ ì¶œ ì˜ì‹¬ ê³„ì • ì¡°ì‚¬ |
| **ëœì„¬ì›¨ì–´ íƒì§€** | `index=endpoint (*.encrypted OR ransom)`<br>`| stats count by hostname` | ì¦‰ì‹œ ê²©ë¦¬, ë°±ì—… ë³µêµ¬ |

### Splunk ëŒ€ì‹œë³´ë“œ êµ¬ì„± ë² ìŠ¤íŠ¸ í”„ë™í‹°ìŠ¤

**ë³´ì•ˆ ìš´ì˜ ì„¼í„°(SOC) ëŒ€ì‹œë³´ë“œ:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ì‹¤ì‹œê°„ ë³´ì•ˆ ëª¨ë‹ˆí„°ë§ (Last 1 Hour)          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Alert by Severity   â”‚  Attack Timeline     â”‚
â”‚  (Pie Chart)         â”‚  (Line Chart)        â”‚
â”‚  - Critical: 12      â”‚  ì‹œê°„ëŒ€ë³„ ê³µê²© ì¶”ì´   â”‚
â”‚  - High: 45          â”‚                      â”‚
â”‚  - Medium: 123       â”‚                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Top 10 Attacker IPs                        â”‚
â”‚  (Table: IP, Count, Country, Last Seen)     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Attack Type Distribution                   â”‚
â”‚  (Column Chart: SQL Injection, XSS, etc)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ì„ì› ë³´ê³ ìš© ëŒ€ì‹œë³´ë“œ:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ì›”ê°„ ë³´ì•ˆ í˜„í™© (Current Month)              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Total Incidents     â”‚  MTTR (í‰ê·  ëŒ€ì‘ì‹œê°„) â”‚
â”‚  - Resolved: 145     â”‚  - 2.3 hours         â”‚
â”‚  - In Progress: 12   â”‚                      â”‚
â”‚  - Open: 3           â”‚  Compliance Score    â”‚
â”‚                      â”‚  - 95.2%             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Monthly Trend (Last 12 Months)             â”‚
â”‚  (Area Chart: Incidents vs. Response Time)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Splunk ê²€ìƒ‰ ìµœì í™” ì²´í¬ë¦¬ìŠ¤íŠ¸

**ì„±ëŠ¥ ìµœì í™”:**
- [ ] ì¸ë±ìŠ¤ ëª…ì‹œ (`index=web` ëŒ€ì‹  `index=*` ì§€ì–‘)
- [ ] Sourcetype ëª…ì‹œ (`sourcetype=access_combined`)
- [ ] ì‹œê°„ ë²”ìœ„ ì œí•œ (Last 24 hours, Last 7 days)
- [ ] í•„ë“œ ì¶”ì¶œ ìµœì†Œí™” (í•„ìš”í•œ í•„ë“œë§Œ `fields` ëª…ë ¹ì–´ë¡œ ì„ íƒ)
- [ ] ì„œë¸Œê²€ìƒ‰ ê²°ê³¼ 10,000ê°œ ì´í•˜ ìœ ì§€

**ì¿¼ë¦¬ ì‘ì„±:**
- [ ] í‚¤ì›Œë“œ ê²€ìƒ‰ ìš°ì„  (ì •ê·œí‘œí˜„ì‹ì€ ìµœí›„ ìˆ˜ë‹¨)
- [ ] íŒŒì´í”„ë¼ì¸ ìˆœì„œ ìµœì í™” (í•„í„°ë§ â†’ ì§‘ê³„ â†’ ì •ë ¬)
- [ ] `stats` ëŒ€ì‹  `tstats` ì‚¬ìš© (ë°ì´í„° ëª¨ë¸ ê¸°ë°˜)
- [ ] ë³µì¡í•œ ì¿¼ë¦¬ëŠ” Saved Searchë¡œ ì €ì¥ í›„ ì¬ì‚¬ìš©

**ë³´ì•ˆ ì„¤ì •:**
- [ ] ì—­í•  ê¸°ë°˜ ì ‘ê·¼ ì œì–´ (RBAC) ì„¤ì •
- [ ] ë¯¼ê° ì •ë³´ ë§ˆìŠ¤í‚¹ (ì‹ ìš©ì¹´ë“œë²ˆí˜¸, ì£¼ë¯¼ë²ˆí˜¸ ë“±)
- [ ] ê°ì‚¬ ë¡œê·¸ í™œì„±í™” (audit.log)
- [ ] ì •ê¸°ì ì¸ ë³´ì•ˆ íŒ¨ì¹˜ ì ìš©

---

## 6. ë°°ìš´ ì  ë° ì¸ì‚¬ì´íŠ¸

### ìƒˆë¡œ ì•Œê²Œ ëœ ì 

- **Splunkì˜ ê°•ë ¥í•œ ê²€ìƒ‰ ì—”ì§„:** SQLë³´ë‹¤ ì§ê´€ì ì¸ íŒŒì´í”„ë¼ì¸ ê¸°ë°˜ SPLë¡œ ë³µì¡í•œ ë¡œê·¸ ë¶„ì„ë„ ëª‡ ì¤„ë¡œ ê°€ëŠ¥
- **ì„œë¸Œê²€ìƒ‰ì˜ ìœ ì—°ì„±:** VIP ê³ ê° ì°¾ê¸° â†’ í•´ë‹¹ ê³ ê° ìƒì„¸ ë¶„ì„ì²˜ëŸ¼ 2ë‹¨ê³„ ì¿¼ë¦¬ë¥¼ í•˜ë‚˜ë¡œ í†µí•© ê°€ëŠ¥
- **evalì˜ ë‹¤ì¬ë‹¤ëŠ¥í•¨:** ë‹¨ìˆœ ì‚¬ì¹™ì—°ì‚°ë¶€í„° ì¡°ê±´ë¶€ ì§‘ê³„, ì „í™˜ìœ¨ ê³„ì‚°ê¹Œì§€ ëª¨ë‘ ì²˜ë¦¬
- **ëŒ€ì‹œë³´ë“œì˜ ì‹¤ì‹œê°„ì„±:** ìë™ ìƒˆë¡œê³ ì¹¨ìœ¼ë¡œ SOCì—ì„œ ì‹¤ì‹œê°„ ìœ„í˜‘ ëª¨ë‹ˆí„°ë§ ê°€ëŠ¥
- **Forwarderì˜ ê²½ëŸ‰ì„±:** 50MB RAMìœ¼ë¡œ ìˆ˜ë°± ëŒ€ ì„œë²„ ë¡œê·¸ ìˆ˜ì§‘ ê°€ëŠ¥, ì¤‘ì•™ ì§‘ì¤‘ì‹ ê´€ë¦¬ì˜ íš¨ìœ¨ì„±

### ì´ì „ í•™ìŠµê³¼ì˜ ì—°ê²°ê³ ë¦¬

- **Wireshark íŒ¨í‚· ë¶„ì„ â†’ Splunk ë¡œê·¸ ë¶„ì„:** ìˆ˜ë™ íŒ¨í‚· ë¶„ì„ì„ ë„˜ì–´ ìë™í™”ëœ ëŒ€ê·œëª¨ ë¡œê·¸ ë¶„ì„ ì²´ê³„
- **Snort IDS ì´ë²¤íŠ¸ â†’ Splunk í†µí•©:** Snort ì•Œë¦¼ì„ Splunkë¡œ ìˆ˜ì§‘í•˜ì—¬ ì¢…í•© ë¶„ì„ ê°€ëŠ¥
- **ì›¹ì‰˜ ê³µê²© íƒì§€ ì—°ê³„:** ì´ì „ì— í•™ìŠµí•œ SQL Injection íŒ¨í„´ì„ Splunk ì¿¼ë¦¬ë¡œ íƒì§€
- **ISMS-P ë¡œê·¸ ê´€ë¦¬ ìš”êµ¬ì‚¬í•­:** Splunkë¡œ ì¤‘ì•™ ì§‘ì¤‘ì‹ ë¡œê·¸ ìˆ˜ì§‘ ë° ë³´ì¡´ ì˜ë¬´ ì´í–‰

### ì‹¤ë¬´ ì ìš© ì•„ì´ë””ì–´

**ë³´ì•ˆ ì „ë¬¸ê°€ ê´€ì :**
- **ì¹¨í•´ì‚¬ê³  ëŒ€ì‘ í”Œë«í¼:** Splunkë¥¼ SIEMìœ¼ë¡œ í™œìš©í•˜ì—¬ ì „ì²´ ì¸í”„ë¼ ë¡œê·¸ í†µí•© ë¶„ì„
- **ìœ„í˜‘ í—ŒíŒ…:** ì •ìƒ íŒ¨í„´ í•™ìŠµ í›„ ì´ìƒ ì§•í›„ íƒì§€ (Anomaly Detection)
- **ì»´í”Œë¼ì´ì–¸ìŠ¤ ë³´ê³ :** ISMS-P, ê°œì¸ì •ë³´ë³´í˜¸ë²• ì¤€ìˆ˜ ì¦ë¹™ ìë£Œ ìë™ ìƒì„±
- **ë³´ì•ˆ ëŒ€ì‹œë³´ë“œ êµ¬ì¶•:** ê²½ì˜ì§„ìš© ì›”ê°„ ë³´ì•ˆ í˜„í™©, SOCìš© ì‹¤ì‹œê°„ ìœ„í˜‘ ëª¨ë‹ˆí„°ë§

**ì‹œìŠ¤í…œ ì—”ì§€ë‹ˆì–´ ê´€ì :**
- **ì¸í”„ë¼ ëª¨ë‹ˆí„°ë§:** ì„œë²„ CPU/ë©”ëª¨ë¦¬ ì‚¬ìš©ë¥ , ë””ìŠ¤í¬ ìš©ëŸ‰ ì¶”ì´ ë¶„ì„
- **ì¥ì•  ì˜ˆì¸¡:** ì—ëŸ¬ ë¡œê·¸ ì¦ê°€ íŒ¨í„´ìœ¼ë¡œ ì¥ì•  ì‚¬ì „ íƒì§€
- **ìš©ëŸ‰ ê³„íš:** íŠ¸ë˜í”½ ì¶”ì´ ë¶„ì„ìœ¼ë¡œ ì„œë²„ ì¦ì„¤ ì‹œê¸° ì˜ˆì¸¡

---

## 7. Quick Reference

### Splunk ëª…ë ¹ì–´ ì¹˜íŠ¸ì‹œíŠ¸

```bash
# ê¸°ë³¸ ê²€ìƒ‰
index=web sourcetype=access_combined status=200

# ì‹œê°„ ë²”ìœ„ (ì›¹ UI Time Picker ë˜ëŠ” ì¿¼ë¦¬)
earliest=-24h latest=now

# í•„ë“œ ì„ íƒ
| fields clientip, status, uri

# ì •ë ¬
| sort -_time  (ìµœì‹ ìˆœ)
| sort +status (ì˜¤ë¦„ì°¨ìˆœ)

# í†µê³„
| stats count by status
| stats count AS total, avg(bytes) AS avg_bytes

# ìƒìœ„/í•˜ìœ„
| top clientip limit=10
| rare uri limit=5

# í…Œì´ë¸” í˜•ì‹
| table _time, clientip, status, uri

# ì‹œê³„ì—´
| timechart span=1h count by status

# ì¡°ê±´ë¶€ ì§‘ê³„
| stats count(eval(status=404)) AS not_found

# í•„ë“œ ê³„ì‚°
| eval response_time_ms = response_time * 1000

# ì„œë¸Œê²€ìƒ‰
... [search ... | top limit=1 clientip | table clientip]

# ì •ê·œí‘œí˜„ì‹ ì¶”ì¶œ
| rex field=_raw "IP: (?<ip>\d+\.\d+\.\d+\.\d+)"

# ì¤‘ë³µ ì œê±°
| dedup clientip
```

### Splunk ê´€ë¦¬ ëª…ë ¹ì–´

```bash
# Splunk ì‹œì‘/ì¤‘ì§€/ì¬ì‹œì‘
/opt/splunk/bin/splunk start
/opt/splunk/bin/splunk stop
/opt/splunk/bin/splunk restart

# ìƒíƒœ í™•ì¸
/opt/splunk/bin/splunk status

# ë¶€íŒ… ì‹œ ìë™ ì‹œì‘
/opt/splunk/bin/splunk enable boot-start

# Forwarder ì„¤ì •
/opt/splunkforwarder/bin/splunk add forward-server [IP]:9997

# ë¼ì´ì„ ìŠ¤ í™•ì¸
Settings > Licensing

# ì¸ë±ìŠ¤ ê´€ë¦¬
Settings > Indexes

# ì‚¬ìš©ì ê´€ë¦¬
Settings > Users and Authentication
```

### ì£¼ìš” ë””ë ‰í† ë¦¬ ë° íŒŒì¼

| ê²½ë¡œ | ì„¤ëª… |
|:---|:---|
| `/opt/splunk/bin/` | ì‹¤í–‰ íŒŒì¼ |
| `/opt/splunk/etc/system/local/` | ë¡œì»¬ ì„¤ì • íŒŒì¼ |
| `/opt/splunk/var/lib/splunk/` | ì¸ë±ìŠ¤ ë°ì´í„° ì €ì¥ì†Œ |
| `/opt/splunk/var/log/splunk/` | Splunk ìì²´ ë¡œê·¸ |
| `/opt/splunkforwarder/etc/system/local/inputs.conf` | Forwarder ì…ë ¥ ì„¤ì • |

---

## 8. íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

| ë¬¸ì œ | ì›ì¸ | í•´ê²° ë°©ë²• |
|:---|:---|:---|
| ì›¹ UI ì ‘ì† ì•ˆ ë¨ (8000 í¬íŠ¸) | - Splunk ì„œë¹„ìŠ¤ ì¤‘ì§€<br>- ë°©í™”ë²½ ì°¨ë‹¨<br>- í¬íŠ¸ ì¶©ëŒ | - `splunk status` í™•ì¸ í›„ `splunk start`<br>- `sudo ufw allow 8000`<br>- `netstat -tuln | grep 8000` í¬íŠ¸ ì‚¬ìš© í™•ì¸ |
| ê²€ìƒ‰ ê²°ê³¼ ì—†ìŒ | - ì¸ë±ìŠ¤ëª… ì˜¤íƒ€<br>- ì‹œê°„ ë²”ìœ„ ì˜ëª» ì„¤ì •<br>- ë°ì´í„° ë¯¸ìˆ˜ì§‘ | - `index=*` ë¡œ ì „ì²´ ê²€ìƒ‰ í…ŒìŠ¤íŠ¸<br>- Time Pickerì—ì„œ "All time" ì„ íƒ<br>- Settings > Indexesì—ì„œ ë°ì´í„° í¬ê¸° í™•ì¸ |
| Forwarder ë°ì´í„° ìˆ˜ì§‘ ì•ˆ ë¨ | - Forwarder ì„œë¹„ìŠ¤ ì¤‘ì§€<br>- Indexer ì—°ê²° ì‹¤íŒ¨<br>- ë¡œê·¸ íŒŒì¼ ê¶Œí•œ ë¶€ì¡± | - `/opt/splunkforwarder/bin/splunk status`<br>- `inputs.conf`ì—ì„œ forward-server í™•ì¸<br>- `chmod 644 /var/log/nginx/access.log` |
| ê²€ìƒ‰ ì†ë„ ëŠë¦¼ | - ì‹œê°„ ë²”ìœ„ ë„ˆë¬´ ë„“ìŒ<br>- ì¸ë±ìŠ¤ ë¯¸ì§€ì •<br>- ë³µì¡í•œ ì •ê·œí‘œí˜„ì‹ | - ì‹œê°„ ë²”ìœ„ ì¢íˆê¸° (Last 1 hour)<br>- ì¸ë±ìŠ¤ì™€ sourcetype ëª…ì‹œ<br>- `rex` ëŒ€ì‹  ê¸°ë³¸ í•„ë“œ ì¶”ì¶œ ì‚¬ìš© |

---

**Today's Insight:**

SplunkëŠ” ë‹¨ìˆœí•œ ë¡œê·¸ ê²€ìƒ‰ ë„êµ¬ë¥¼ ë„˜ì–´ ë¹„ì¦ˆë‹ˆìŠ¤ ì¸í…”ë¦¬ì „ìŠ¤ì™€ ë³´ì•ˆ ë¶„ì„ì„ í†µí•©í•˜ëŠ” ê°•ë ¥í•œ í”Œë«í¼ì„ì„ ì²´ê°í–ˆìŠµë‹ˆë‹¤. tutorialdata.zip ìƒ˜í”Œ ë°ì´í„°ë¡œ VIP ê³ ê° ë¶„ì„, ìƒí’ˆ ì „í™˜ìœ¨ ê³„ì‚°, ì‹œê°„ëŒ€ë³„ êµ¬ë§¤ ì¶”ì´ ì‹œê°í™” ë“±ì„ ì‹¤ìŠµí•˜ë©°, íŒŒì´í”„ë¼ì¸ ê¸°ë°˜ SPLì˜ ì§ê´€ì„±ê³¼ ìœ ì—°ì„±ì— ë†€ëìŠµë‹ˆë‹¤. íŠ¹íˆ ì„œë¸Œê²€ìƒ‰ `[ ]`ì„ ì‚¬ìš©í•˜ì—¬ "ê°€ì¥ ë§ì´ êµ¬ë§¤í•œ ê³ ê° 1ëª…ì„ ì°¾ì€ í›„, ê·¸ ê³ ê°ì˜ ëª¨ë“  í™œë™ ë¶„ì„"ì„ ë‹¨ì¼ ì¿¼ë¦¬ë¡œ ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤ëŠ” ì ì´ ì¸ìƒì ì´ì—ˆìŠµë‹ˆë‹¤. ëŒ€ì‹œë³´ë“œì™€ ë³´ê³ ì„œë¥¼ ì§ì ‘ ë§Œë“¤ì–´ë³´ë©°, SOC ë¶„ì„ê°€ê°€ ì‹¤ì‹œê°„ìœ¼ë¡œ ìœ„í˜‘ì„ ëª¨ë‹ˆí„°ë§í•˜ê³  ê²½ì˜ì§„ì—ê²Œ ë³´ì•ˆ í˜„í™©ì„ ê°€ì‹œí™”í•˜ëŠ” ë°©ì‹ì„ ì´í•´í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤. í–¥í›„ ì‹¤ë¬´ì—ì„œëŠ” Splunk Forwarderë¡œ ìˆ˜ë°± ëŒ€ ì„œë²„ì˜ ë¡œê·¸ë¥¼ ì¤‘ì•™ ì§‘ì¤‘ì‹ìœ¼ë¡œ ìˆ˜ì§‘í•˜ê³ , ì»¤ìŠ¤í…€ ì¿¼ë¦¬ë¡œ ì¡°ì§ íŠ¹í™” ìœ„í˜‘ì„ íƒì§€í•˜ëŠ” SIEM ì²´ê³„ë¥¼ êµ¬ì¶•í•  ìˆ˜ ìˆì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤.