# Research Review: Outside the Closed World: On Using Machine Learning For Network Intrusion Detection
> **Analyzed Date:** 2026.01.20 - 2026.01.21  
> **Keywords:** Anomaly Detection, Machine Learning, Network Intrusion Detection, Operational Deployment, Evaluation Challenges  
> **Source:** IEEE Symposium on Security and Privacy, 2010 [PDF]

---

## Why This Paper?

### 선정 배경
**도메인 탐색 결과:**  
8주간 보안 컨설팅, OT/ICS, 클라우드 등 8개 도메인 논문을 읽은 결과, SOC(Security Operations Center)가 나의 강점과 흥미에 가장 부합함을 확인. 이제부터는 SOC 전문성 심화를 위한 체계적 학습 단계.

**이 논문을 선택한 이유:**  
- DeepLog, UNICORN, DNS Tunneling Detection 등 다양한 탐지 기법을 학습한 후, 왜 이러한 머신러닝 기반 이상 탐지 시스템들이 실제 운영 환경에서는 잘 사용되지 않는지에 대한 근본적인 질문에 답하는 논문
- 학계의 연구 성과와 실무 배포 간의 격차를 분석하여, SOC 실무자 관점에서 머신러닝 기반 탐지 시스템을 어떻게 접근해야 하는지 이해
- 이상 탐지 시스템의 한계를 명확히 인식하고, 실무에서 효과적으로 활용하기 위한 가이드라인 습득

**학습 목표:**  
1. 머신러닝 기반 이상 탐지가 실무 환경에서 성공하지 못하는 구조적 원인 이해
2. 네트워크 침입 탐지 도메인이 다른 머신러닝 적용 분야와 어떻게 다른지 파악
3. 실무에서 이상 탐지 시스템을 효과적으로 활용하기 위한 가이드라인 학습

---

## Day 1 – Research Context & Motivation
*(머신러닝 기반 이상 탐지의 실무 배포 격차 분석)*

### 1. 연구 배경: 학계와 실무 간의 격차

**이상 탐지 연구의 중요성**
네트워크 침입 탐지 시스템(NIDS)은 전통적으로 탐지 방식에 따라 분류된다. Misuse detection은 알려진 악의적 행위를 정확하게 기술하여 모니터링하고, anomaly detection은 정상 활동의 프로필을 가지고 있어 그로부터의 편차를 탐지한다. 두 접근법 모두 연구 커뮤니티에서 오랜 기간 연구되었다.

**현실의 한계**
실제 운영 환경에서는 두 주요 클래스 중 misuse detector만 거의 독점적으로 사용되고 있으며, 가장 일반적으로는 네트워크 트래픽에서 특정 바이트 시퀀스를 스캔하는 시그니처 시스템 형태이다. 머신러닝은 컴퓨터 과학의 많은 다른 영역에서 큰 성공을 거두고 상용 세계에서 대규모 배포로 이어지는 경우가 많지만, 침입 탐지에서는 이러한 성공을 보이지 못하고 있다.

**연구 문제의식**
이 논문은 침입 탐지 도메인과 머신러닝이 더 성공적으로 사용되는 다른 영역 간의 차이점을 조사한다. 주요 주장은 공격을 찾는 작업이 다른 응용 분야와 근본적으로 다르며, 이로 인해 침입 탐지 커뮤니티가 머신러닝을 효과적으로 사용하기가 훨씬 더 어렵다는 것이다.

### 2. 핵심 개념

| 개념 | 정의 | SOC 맥락에서의 의미 |
|------|------|---------------------|
| **Anomaly Detection** | 예상되는 행위로부터의 편차를 찾는 시스템. 정상 활동의 개념을 기반으로 그 프로필로부터의 편차를 경보로 보고 | SOC에서 알려지지 않은 공격을 탐지할 수 있다고 기대되지만, 실제로는 높은 오탐률로 인해 운영 환경에서 제한적으로 사용 |
| **Misuse Detection** | 알려진 악의적 행위를 정확하게 기술하여 활동을 모니터링하는 시스템 | SOC에서 가장 일반적으로 사용되는 접근법으로, 시그니처 기반 탐지가 대표적 |
| **Machine Learning** | 참조 입력으로 먼저 훈련되어 그 특성을 학습한 후(supervised 또는 unsupervised), 실제 탐지 프로세스를 위해 이전에 보지 못한 입력에 배포되는 알고리즘 | 이상 탐지 시스템의 기반이 되지만, 침입 탐지 도메인의 특수성으로 인해 효과적 적용에 어려움 |
| **Closed World Assumption** | 양성 예제만 지정하고 나머지는 음성이라고 가정하는 아이디어 | 실제 문제에서는 모든 경우가 다뤄지는 폐쇄된 세계가 거의 없기 때문에 실용성이 낮음 |

### 3. 이론적 기반: 머신러닝 vs 이상 탐지

```
[전통적 머신러닝 분류 문제]
훈련: 클래스 A 샘플 + 클래스 B 샘플 → 모델 학습
탐지: 새로운 입력 → A 또는 B로 분류

[이상 탐지 문제]
훈련: 정상 트래픽 샘플만 → 정상 모델 학습
탐지: 새로운 입력 → 정상 또는 비정상 판단
```

**핵심 아이디어:**
이상 탐지의 기본 가정은 악의적 활동이 정상 사용에서 관찰되지 않는 특성을 나타낸다는 것이다. 이는 Denning이 1987년 호스트 기반 IDES 시스템에 대한 선구적 연구에서 처음 도입했다. IDES와 그 후속 NIDES는 통계적 메트릭과 프로필의 조합을 사용했다. 이후 정보 이론, 신경망, 서포트 벡터 머신, 유전 알고리즘, 인공 면역 시스템 등 머신러닝 커뮤니티의 다양한 방법들이 추구되었다.

### 4. 연구의 핵심 기여

**학술적 기여:**
- 침입 탐지 도메인이 머신러닝을 효과적으로 적용하기 어렵게 만드는 고유한 특성들을 체계적으로 식별
- 머신러닝 기반 이상 탐지가 새로운 공격을 찾는 데 적합하다는 일반적인 전제가 암시하는 만큼의 일반성을 가지지 않는다는 주장 제시
- 머신러닝 도구의 강점은 이전에 본 것과 유사한 활동을 찾는 것이지, 그 활동을 미리 정확하게 기술할 필요는 없다는 점 명확화

**SOC 실무 기여:**
- 실무 환경에서 이상 탐지 시스템을 효과적으로 사용하기 위한 가이드라인 세트 제공
- 시스템의 능력과 한계에 대한 깊은 의미론적 통찰 획득의 중요성 강조
- 블랙박스로 시스템을 다루는 것의 위험성 지적

**기타 기여:**
- 운영 환경에서 실제로 배포되는 이상 탐지 시스템은 Arbor의 Peakflow, Lanscope의 StealthWatch와 같이 고도로 집계된 트래픽의 통계적 프로필 기반 시스템이며, 학술 논문이 종종 구상하는 일반성보다 훨씬 구체적인 초점으로 작동한다는 관찰 제시

### 5. SOC 관점 인사이트

**실무 적용 가능성:**
논문은 머신러닝을 침입 탐지에 부적절한 도구로 간주하지 않지만, 신중한 사용이 필요하다고 강조한다. 시스템이 작동하는 맥락을 더 명확하게 정의할수록, 그리고 탐지 프로세스의 의미론을 더 잘 이해할수록 결과가 더 운영적으로 관련될 것이다.

**기존 학습과의 연결:**
이전에 학습한 DeepLog, UNICORN 등의 논문들이 머신러닝 기반 탐지 기법의 기술적 우수성을 보여주었다면, 이 논문은 그러한 기법들이 실무에서 왜 널리 채택되지 않는지에 대한 구조적 이유를 제공한다.

**현실적 고려사항:**
논문은 네트워크 침입 탐지에 초점을 맞추지만, 유사한 논점이 호스트 기반 시스템에도 적용될 것으로 본다. 또한 Chandola et al.의 이상 탐지 서베이를 참조하며, 신용카드 지출 패턴 모니터링과 같은 다른 응용 분야에서는 데이터가 훨씬 더 구조화되어 있고 의미론적으로 잘 정의되어 있다고 지적한다.

---

## Day 2 – Research Model, Hypotheses, and Methodology
*(침입 탐지 도메인의 고유한 도전과제 식별)*

### 1. 연구 모델 개요

```
[연구 접근법]
문제 식별: 학계 연구 vs 실무 배포의 격차
    ↓
도메인 특성 분석: 침입 탐지 vs 다른 ML 적용 분야
    ↓
도전과제 식별: 6가지 주요 특성
    ↓
가이드라인 제시: 효과적 사용을 위한 권장사항
```

**설계 철학:**
이 논문은 실험적 연구가 아니라 분석적 연구이다. 저자들은 대규모 운영 환경에서 이상 탐지 시스템을 효과적으로 사용한다는 목표를 중심으로 논의를 구성한다. 네트워크 침입 탐지가 주요 전문 분야이므로 이에 초점을 맞추지만, 유사한 논점이 호스트 기반 시스템에도 적용될 것으로 본다.

### 2. 연구 가설 (또는 핵심 가정)

| 가설/가정 | 내용 | 근거 또는 예상 결과 |
|-----------|------|---------------------|
| **A1** | 성공 불일치는 침입 탐지 도메인이 머신러닝 접근법의 효과적 배포를 근본적으로 더 어렵게 만드는 특정 특성을 나타내기 때문에 발생 | 학계의 광범위한 연구에도 불구하고 운영 배포가 매우 제한적인 현상 설명 |
| **A2** | 이상 탐지가 새로운 공격을 찾는 데 적합하다는 전제는 일반적으로 암시되는 만큼의 일반성을 가지지 않음 | 머신러닝의 강점은 새로운 것을 찾는 것이 아니라 이전에 본 것과 유사한 활동을 찾는 것 |
| **A3** | 시스템이 수행하는 작업에 대한 깊은 의미론적 통찰 없이는 효과적인 배포가 불가능 | 블랙박스로 시스템을 다루는 것은 자주 관찰되지만 부적절함 |

### 3. 연구 방법론

#### A. 데이터 수집

**데이터 소스:**
이 논문은 전통적인 의미의 데이터 수집을 수행하지 않는다. 대신 저자들의 전문 지식과 도메인 경험을 기반으로 분석을 수행한다.

| 소스 | 수집 정보 | 용도 |
|------|-----------|------|
| 문헌 조사 | 기존 이상 탐지 연구, 머신러닝 응용 사례 | 침입 탐지와 다른 도메인 간 비교 |
| 운영 경험 | 실제 네트워크 환경에서의 배포 사례 | 실무 격차의 구체적 증거 |
| 다른 도메인 사례 | Amazon 추천 시스템, OCR, 스팸 탐지 등 | 성공적인 머신러닝 적용 사례와의 대조 |

**데이터 특성 및 문제점:**
논문은 침입 탐지 연구를 위한 적절한 공개 데이터셋의 부족을 주요 문제로 지적한다. DARPA/Lincoln Labs 패킷 트레이스와 KDD Cup 데이터셋은 10년이 지났으며 현재 연구에는 더 이상 적절하지 않다. DARPA 데이터셋은 1998-1999년에 생성된 시뮬레이션된 Air Force 네트워크의 활동을 포함하며, 합성 데이터일 뿐만 아니라 현대 공격을 반영하지 못한다.

#### B. 핵심 분석 기법

**도전과제 1: Outlier Detection**

목적: 머신러닝이 침입 탐지에서 직면하는 근본적인 불일치 식별

방법:
```
1. 머신러닝의 기본 강점 분석
   - 분류 문제에서의 성공 (유사성 찾기)
   - Amazon 추천 시스템 사례: 협업 필터링으로 함께 구매되는 유사 제품 매칭

2. 이상 탐지의 근본적 차이점 식별
   - 의미 있는 이상값(outlier) 발견 필요
   - 모든 클래스의 샘플로 훈련해야 하는 머신러닝 기본 규칙
   - 각 클래스의 대표 샘플 수가 많아야 함

3. Closed World Assumption의 한계
   - 양성 예제만 지정하고 나머지를 음성으로 가정
   - 실제 문제에서는 모든 경우가 다뤄지는 폐쇄된 세계가 거의 없음
```

핵심 발견: 이상 탐지는 찾고자 하는 것의 반대(정상 트래픽)로 훈련되는 설정이며, 이는 이상적이지 않다. 완벽한 정상성 모델이 있어야만 신뢰할 수 있는 결정이 가능하다. 반면 여러 대안 중 선택하는 분류 문제라면 클래스를 분리하기에 충분히 명확한 모델만 있으면 된다.

결론: 이상 탐지는 이전에 알려지지 않은 악의적 활동보다 알려진 공격의 변형을 찾는 데 더 적합할 가능성이 높다. 이러한 설정에서는 알려진 공격의 샘플과 정상 백그라운드 트래픽으로 시스템을 훈련할 수 있어 훨씬 더 신뢰할 수 있는 결정 프로세스를 달성할 수 있다.

**도전과제 2: High Cost of Errors**

목적: 침입 탐지에서 오분류의 높은 비용 분석

방법:
```
1. False Positive의 비용
   - 분석가의 비싼 시간 소비
   - Axelsson 논증: 매우 작은 오탐률도 NIDS를 사용 불가능하게 만들 수 있음

2. False Negative의 비용
   - 단 하나의 침해된 시스템도 IT 인프라 무결성을 심각하게 훼손 가능

3. 다른 도메인과의 비교
   - 제품 추천 시스템: 오류가 직접적인 부정적 영향 없음
   - OCR: 맞춤법/문법 검사기로 명백한 실수 제거, 사용자가 교정 기대
   - 언어 번역: 비교적 높은 오류율에서 작동, 대략적 번역만 기대
   - 스팸 탐지: 불균형한 비용 모델 (FP는 매우 비싸지만 FN은 큰 영향 없음)
```

핵심 발견: 이상 탐지 시스템은 허용할 수 있는 오류 수에 대해 훨씬 더 엄격한 제한에 직면한다. 그러나 논문에서 논의하는 침입 탐지 특유의 도전과제들은 모두 오류율을 증가시키는 경향이 있다. 이 불행한 조합을 운영 환경에서 성공 부족의 주요 원인으로 본다.

**도전과제 3: Semantic Gap**

목적: 탐지 결과와 운영적 해석 간의 간극 분석

방법:
```
1. 문제 정의
   - 많은 연구에서 정상 프로필로부터의 편차를 식별하는 능력 평가에 그침
   - 운영자 관점에서 "무엇을 의미하는가?" 해석하는 다음 단계 필요

2. "비정상 활동"과 "공격"의 차이
   - 이상 탐지는 악의적 행위가 아닌 이전에 보지 못한 것을 보고
   - 배포 목적은 공격을 찾는 것이므로 간극을 메우지 못하면 운영 기대 충족 불가

3. 로컬 보안 정책 통합
   - 운영 네트워크는 크게 다르며 많은 보안 제약은 사이트별 속성
   - 학술 환경에서 괜찮은 활동이 기업 네트워크에서 금지될 수 있음
```

사례 분석:
- P2P 트래픽: 부적절한 콘텐츠에 사용되지 않고 볼륨 측면에서 레이더 아래에 있는 한 허용될 수 있음. 그러나 이상 탐지 시스템이 특정 환경에서 무엇이 적절한지 또는 지나치게 큰지에 대한 개념을 가지는 것은 현재 시스템의 범위를 벗어남
- PII 유출: 많은 위협 모델에서 높은 순위를 차지하지만, 그러한 설명 없이 개발된 이상 탐지 시스템은 PII를 찾을 희망이 거의 없음

핵심 발견: 이상 탐지 시스템이 작동하는 피처가 네트워크 환경의 의미론과 어떻게 관련되는지 이해하는 것이 근본적 과제이다. 주어진 피처 선택에 대해 NIDS가 그것들로부터 개발할 수 있는 결정의 종류에 근본적인 한계가 있다.

**도전과제 4: Diversity of Network Traffic**

목적: 네트워크 트래픽의 다양성이 이상 탐지에 미치는 영향 분석

방법:
```
1. 트래픽 다양성의 실제 양상
   - 단일 네트워크 내에서도 대역폭, 연결 지속 시간, 애플리케이션 믹스 등의 엄청난 변동성
   - 짧은 시간 간격(초~시간)에서 예측 불가능
   - 강한 상관관계와 heavy-tailed 데이터 전송의 광범위한 존재로 인한 대규모 활동 버스트

2. 네트워킹에서 이러한 변동성은 정기적으로 발생하며 특이한 것이 아님
   - 이상 탐지 시스템에게는 안정적인 정상성 개념을 찾기 어렵게 만듦

3. 집계를 통한 다양성 감소
   - 작은~중간 시간 간격에서는 매우 가변적이지만 더 긴 기간(시간~일, 때로 주)에서는 안정성 증가
   - 시간대/요일 효과는 신뢰할 수 있는 패턴 보임
```

핵심 발견: 운영 배포에서 발견되는 이상 탐지 시스템의 한 형태는 시간당 볼륨이나 소스당 연결과 같이 고도로 집계된 정보에서 작동하는 시스템이다. 그러나 이러한 시스템이 찾는 인시던트는 상당히 노이즈가 많으며 종종 다른 접근법(예: 간단한 임계값 방식)으로도 찾기 쉽다.

추가 관찰: 트래픽 다양성은 패킷 수준 피처에만 국한되지 않고 애플리케이션 계층 정보로도 확장된다. 구문론적으로 프로토콜 사양은 종종 의도적으로 해석의 여지를 남기며, 의미론적으로 애플리케이션 프로토콜에서 파생된 피처는 네트워크 계층 패킷만큼 변동할 수 있다.

**도전과제 5: Difficulties with Evaluation**

목적: 이상 탐지 시스템 평가의 고유한 어려움 식별

방법:
```
1. 데이터 문제
   - 적절한 공개 데이터셋 부족
   - DARPA/KDD Cup 데이터: 10년 이상 된 합성 데이터, 더 이상 관심 없음
   - 민감한 정보로 인한 공개의 조직적/법적 장벽

2. 대안적 접근법의 한계
   - 시뮬레이션: 민감성 우려는 없으나 인터넷 트래픽을 현실적으로 시뮬레이션하기 매우 어려움
   - 익명화: 정보 유출 우려, 이상 탐지 시스템은 정확히 익명화 과정에서 제거되는 종류의 아티팩트를 찾음

3. Semantic Gap으로 인한 평가 복잡성
   - 공격을 올바르게 식별하는 것 외에도 운영자가 활동을 이해하고 영향을 빠르게 평가할 수 있도록 지원 필요
   - 다른 도메인에서는 결과가 직관적이지만 침입 탐지에서는 해석 여지 많음

4. 적대적 환경
   - 공격자와 방어자 간의 군비 경쟁
   - 회피(evasion): 공격자가 탐지를 피하기 위해 활동 조정
   - Fogla와 Lee의 자동화된 공격 변형 접근법
   - Barreno et al.의 머신러닝 시스템에 대한 공격 분류체계
```

핵심 발견: 
- 건전한 평가 방식을 고안하는 것이 탐지기 자체를 구축하는 것보다 어렵다
- 탐지 프로세스의 불투명성으로 인해 이상 탐지 시스템의 결과는 misuse detector보다 예측하기 어렵다
- 그러나 실용적 관점에서 적대적 환경의 영향은 처음 믿는 것만큼 중요하지 않을 수 있다. 머신러닝 구현의 세부사항을 악용하는 것은 공격자 측에서 상당한 노력, 시간, 전문성을 필요로 하며, 대부분의 오늘날 공격은 무차별적으로 취약한 사이트를 찾기 때문이다.

**도전과제 6: 기타 고려사항**

추가 분석:
```
1. 연구자들이 자체 데이터셋을 수집해야 하는 어려움
   - 적절한 크기의 네트워크에 대한 접근 부족
   - 작은 실험실 네트워크의 활동은 NIDS가 일반적으로 배포되는 상류의 집계 트래픽과 근본적으로 다름
   - 작은 환경에서 도출된 결론은 더 큰 규모의 설정으로 일반화 불가능

2. 평가에서 사용자 관점으로의 전환 필요성
   - 다른 도메인에서는 암묵적이지만 침입 탐지에서는 명시적 단계 필요
   - 시스템이 이전에 알려지지 않은 웹 서버 익스플로잇을 올바르게 찾았지만 "호스트의 HTTP 트래픽이 정상 프로필과 일치하지 않음"으로만 보고한다면 운영자는 무슨 일이 일어났는지 파악하는 데 상당한 추가 노력 소비
```

### 4. SOC 관점 인사이트

**방법론의 실무 적용성:**

장점:
- 침입 탐지 도메인의 고유한 도전과제를 체계적으로 정리하여 실무자가 이상 탐지 시스템의 한계를 명확히 인식할 수 있게 함
- 머신러닝 기반 탐지가 새로운 공격보다 알려진 공격의 변형 탐지에 더 적합하다는 현실적 기대치 설정
- 시스템의 의미론적 이해 없이 블랙박스로 사용하는 것의 위험성 강조

한계:
- 실험적 검증이 아닌 분석적 접근이므로 구체적인 수치적 증거 부족
- 실무에서 즉시 적용 가능한 구체적 솔루션보다는 문제 인식과 가이드라인 수준의 제안
- 개별 환경의 특수성을 고려한 맞춤형 접근법 개발은 여전히 실무자의 몫

**기존 SOC 툴과의 차별점:**

| 도구/방법 | 탐지 방식 | 강점 | 약점 |
|-----------|-----------|------|------|
| **시그니처 기반 NIDS** | 알려진 공격 패턴 매칭 | 낮은 오탐률, 명확한 결과 해석 | 알려진 공격만 탐지, 변형에 취약 |
| **학계 머신러닝 이상 탐지** | 정상 프로필로부터의 편차 | 이론적으로 새로운 공격 탐지 가능 | 높은 오탐률, 의미론적 간극, 평가 어려움 |
| **실무 통계 기반 이상 탐지 (Peakflow, StealthWatch)** | 고도로 집계된 트래픽 통계 | 트래픽 볼륨 이상 탐지에 효과적 | 세밀한 공격 탐지 한계, 노이즈 많음 |
| **이 논문이 제안하는 접근** | 좁은 범위 + 의미론적 이해 | 명확한 목표, 낮은 오류 비용, 해석 가능성 | 구현 복잡도, 각 환경별 맞춤화 필요 |

**SOC Workflow 통합 전략:**

논문은 Day 5에서 구체적인 가이드라인을 제시할 것으로 예상되지만, Day 1-2에서 제시된 내용을 기반으로 다음과 같은 통합 방향을 고려할 수 있다:

1. 명확한 범위 설정: 모든 공격을 찾으려 하지 않고 특정 유형의 공격이나 행위에 초점
2. 다층 방어: 시그니처 기반 탐지와 이상 탐지를 결합하여 각각의 강점 활용
3. 후처리 전략: 이상 탐지 결과를 추가 정보로 검증하여 오탐률 감소
4. 의미론적 매핑: 탐지 결과를 MITRE ATT&CK와 같은 프레임워크에 매핑하여 운영적 의미 부여

**다음 학습 방향 (Day 3 Preview):**
Day 3에서는 논문의 후반부인 권장사항 섹션을 다룰 것으로 예상된다. 위협 모델 이해, 범위를 좁게 유지하기, 비용 감소, 평가 수행에 대한 구체적인 가이드라인이 제시될 것이며, 이를 통해 실무에서 머신러닝 기반 이상 탐지를 효과적으로 활용하기 위한 실행 가능한 전략을 학습할 수 있을 것이다.