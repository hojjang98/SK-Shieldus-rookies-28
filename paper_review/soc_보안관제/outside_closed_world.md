# Research Review: Outside the Closed World: On Using Machine Learning For Network Intrusion Detection
> **Analyzed Date:** 2026.01.20 - 2026.01.22  
> **Keywords:** Anomaly Detection, Machine Learning, Network Intrusion Detection, Operational Deployment, Evaluation  
> **Source:** IEEE Symposium on Security and Privacy (S&P), 2010  
> **Authors:** Robin Sommer (ICSI, LBNL), Vern Paxson (ICSI, UC Berkeley)

---

## Why This Paper?

### 선정 배경
8주간 보안 컨설팅, 사고 대응, 침투 테스트, 취약점 평가, OT/ICS 보안, 클라우드 보안, 보안 통합 등 8개 도메인을 탐색한 결과, SOC가 나의 강점과 흥미에 가장 부합함을 확인했다. 이제는 SOC 전문성 심화를 위한 체계적 학습 단계이다.

### 이 논문을 선택한 이유
DeepLog, Lou et al.의 invariants mining, Beehive, UNICORN 등 머신러닝 기반 탐지 기법들을 학습했다. 이러한 기법들은 학술적으로 우수한 성능을 보여주지만, 실제 운영 환경에서는 거의 사용되지 않는다. 이 논문은 그 근본적인 이유를 분석한다.

### 학습 목표
1. 머신러닝 기반 이상 탐지가 실무에서 성공하지 못하는 구조적 원인 이해
2. 침입 탐지 도메인의 고유한 특성 파악
3. 실무에서 머신러닝을 효과적으로 활용하기 위한 가이드라인 학습

---

## Day 1 – Research Context & Motivation

### 1. 연구 배경

**NIDS의 분류**
네트워크 침입 탐지 시스템은 전통적으로 탐지 방식에 따라 분류된다. Misuse detection은 알려진 악의적 행위를 정확하게 기술하여 모니터링하고, anomaly detection은 정상 활동의 개념을 가지고 그로부터의 편차를 플래그한다. 두 접근법 모두 연구 커뮤니티에서 오랜 기간 연구되었다.

**운영 환경의 현실**
실제 배포 측면에서는 놀라운 불균형이 관찰된다. 운영 환경에서는 이 두 주요 클래스 중 거의 독점적으로 misuse detector만 사용되고 있다. 가장 일반적으로는 네트워크 트래픽에서 특징적인 바이트 시퀀스를 스캔하는 시그니처 시스템 형태이다.

**성공 격차**
머신러닝은 컴퓨터 과학의 많은 다른 영역에서 큰 성공을 거두며 상용 세계에서 대규모 배포로 이어진다. 예시로는 Amazon과 Netflix의 제품 추천 시스템, OCR 시스템, 자연어 번역, 스팸 탐지 등이 있다.

**논문의 주장**
공격을 찾는 작업이 다른 응용 분야와 근본적으로 다르며, 이로 인해 침입 탐지 커뮤니티가 머신러닝을 효과적으로 사용하기가 훨씬 더 어렵다. 저자들은 이상 탐지가 새로운 공격을 찾는 데 적합하다는 전제가 일반적으로 암시되는 만큼의 일반성을 가지지 않는다고 주장한다. 오히려 머신러닝 도구의 강점은 이전에 본 것과 유사한 활동을 찾는 것이지, 그 활동을 미리 정확하게 기술할 필요는 없다는 점이다.

### 2. 도메인이 제시하는 특성들

논문이 식별한 침입 탐지 도메인의 특성들:
1. 오류의 매우 높은 비용
2. 훈련 데이터의 부족
3. 결과와 운영적 해석 간의 의미론적 간극
4. 입력 데이터의 엄청난 변동성
5. 건전한 평가 수행의 근본적 어려움

### 3. 저자들의 입장

저자들은 머신러닝을 침입 탐지에 부적절한 도구로 간주하지 않는다. 그러나 신중한 사용이 필요하다. 시스템이 작동하는 맥락을 더 명확하게 정의할수록, 그리고 탐지 프로세스의 의미론을 더 잘 이해할수록 결과가 더 운영적으로 관련될 것이다. 효과적인 배포를 위해서는 시스템을 블랙박스로 다루기보다는 시스템의 능력과 한계에 대한 깊은 의미론적 통찰을 획득하는 것이 중요하다.

### 4. 이론적 배경

**이상 탐지의 역사**
이상 탐지 시스템은 예상되는 행위로부터의 편차를 찾는다. 정상 활동의 개념을 기반으로 그 프로필로부터의 편차를 경보로 보고한다. 기본 가정은 악의적 활동이 정상 사용에서 관찰되지 않는 특성을 나타낸다는 것이며, 이는 Denning이 1987년 호스트 기반 IDES 시스템에 대한 선구적 연구에서 처음 도입했다.

**머신러닝 접근법들**
IDES와 후속 NIDES는 통계적 메트릭과 프로필의 조합을 사용했다. 이후 정보 이론, 신경망, 서포트 벡터 머신, 유전 알고리즘, 인공 면역 시스템 등 머신러닝 커뮤니티의 다양한 방법들이 추구되었다.

**다른 도메인과의 차이**
Chandola et al.은 이상 탐지 서베이에서 신용카드 지출 패턴 모니터링과 같은 다른 응용 분야를 다룬다. 그러한 응용에서도 이상값을 찾지만, 데이터가 훨씬 더 구조화되어 있다. 예를 들어, 신용카드 거래를 표현하는 공간은 상대적으로 낮은 차원이며 네트워크 트래픽보다 의미론적으로 훨씬 더 잘 정의되어 있다.

**실무 배포 현황**
광범위한 연구에 비해 이상 탐지는 실세계에서 많은 견인력을 얻지 못했다. 운영 배포에서 발견되는 시스템들은 Arbor의 Peakflow와 Lanscope의 StealthWatch와 같이 고도로 집계된 트래픽의 통계적 프로필에 기반한 것들이 가장 일반적이다. 이러한 장치들은 매우 유용하지만, 연구 논문이 종종 구상하는 일반성보다 훨씬 더 구체적인 초점으로 작동한다.

---

## Day 2 – Challenges of Using Machine Learning

논문의 Section III에서는 머신러닝 사용의 도전과제들을 식별한다. 저자들은 이 성공 불일치가 침입 탐지 도메인이 머신러닝 접근법의 효과적 배포를 근본적으로 더 어렵게 만드는 특정 특성들을 나타내기 때문에 발생한다고 믿는다.

### 1. Challenge A: Outlier Detection

**근본적인 문제**
머신러닝 알고리즘은 근본적으로 속하지 않는 활동을 식별하는 것보다 유사성을 찾는 데 훨씬 더 뛰어나다. 고전적인 머신러닝 응용은 이상 탐지 시스템이 요구하는 의미 있는 이상값 발견이 아니라 분류 문제이다.

**Amazon 추천 시스템 비교**
Amazon이 사용하는 제품 추천 시스템을 고려해보자. 협업 필터링을 사용하여 사용자가 구매하거나 긍정적으로 평가한 각 항목을 다른 유사한 제품과 매칭한다. 여기서 유사성은 함께 구매되는 경향이 있는 제품에 의해 결정된다. 시스템이 이상 탐지 시스템처럼 작동한다면, 일반적으로 함께 구매되지 않는 항목을 찾아야 할 것이다. 이는 훨씬 덜 명확한 답을 가진 다른 종류의 질문이다. 논문에 따르면 많은 제품 쌍은 공통 고객이 없다.

**분류 vs 이상 탐지**
어떤 의미에서 이상값 탐지도 분류 문제이다. 정상과 비정상이라는 두 클래스가 있고, 목표는 관찰이 두 가지 중 어느 것에 더 가능성이 높은지 결정하는 것이다. 그러나 머신러닝의 기본 규칙은 모든 클래스의 샘플로 시스템을 훈련해야 하며, 중요하게도 각 클래스에 대해 훈련 세트에서 발견되는 대표 수가 많아야 한다는 것이다. 그러나 새로운 공격을 찾는 것을 목표로 하는 이상 탐지의 경우, 정의상 관심 있는 공격에 대해 훈련할 수 없고 정상 트래픽에만 훈련할 수 있으므로, 새로운 활동을 비교할 카테고리가 하나만 있다.

**Closed World Assumption**
Witten et al.을 인용하면: 양성 예제만 지정하고 나머지는 음성이라는 가정을 채택하는 아이디어를 closed world assumption이라고 한다. 이 가정은 모든 경우가 다뤄진다고 확신할 수 있는 폐쇄된 세계를 거의 포함하지 않기 때문에 실제 문제에서 실용적으로 많이 사용되지 않는다.

**스팸 탐지의 성공**
스팸 탐지는 보안 도메인에서 머신러닝을 분류 문제에 성공적으로 적용한 예이다. Graham이 원래 제안한 Bayesian 프레임워크는 스팸과 ham의 대규모 말뭉치로 훈련되어 원치 않는 메일을 신뢰성 있게 식별하는 표준 도구로 발전했다.

**결론**
머신러닝이 그러한 진정한 분류 문제에 훨씬 더 잘 작동한다는 관찰은 이상 탐지가 실제로 이전에 알려지지 않은 악의적 활동보다 알려진 공격의 변형을 찾는 데 더 적합할 가능성이 높다는 결론으로 이어진다. 그러한 설정에서는 알려진 공격의 샘플과 정상 백그라운드 트래픽으로 시스템을 훈련할 수 있어 훨씬 더 신뢰할 수 있는 결정 프로세스를 달성할 수 있다.

### 2. Challenge B: High Cost of Errors

**침입 탐지의 오류 비용**
침입 탐지에서 오분류의 상대적 비용은 많은 다른 머신러닝 응용에 비해 극도로 높다. False positive는 보고된 인시던트를 조사하는 데 비싼 분석가 시간을 소비해야 하며, 결국 양성 활동을 반영한다고 결정하게 된다. Axelsson이 주장했듯이, 매우 작은 오탐률조차도 NIDS를 빠르게 사용 불가능하게 만들 수 있다. 반면 false negative는 조직에 심각한 피해를 줄 가능성이 있다. 단 하나의 침해된 시스템도 IT 인프라의 무결성을 심각하게 훼손할 수 있다.

**다른 도메인과의 비교**

제품 추천 시스템:
- 오류가 직접적인 부정적 영향을 미치지 않으므로 쉽게 허용 가능
- 판매자에게 좋은 추천은 판매를 증가시킬 가능성이 있지만, 나쁜 선택은 더 매력적인 추천을 했을 기회를 잃은 것 이상으로 거의 해를 끼치지 않음
- Greg Linden(Amazon 추천 엔진 저자)의 말: 추천은 많은 추측을 포함한다. 우리의 오류율은 항상 높을 것이다.

OCR 기술:
- 이상 탐지 시스템보다 훨씬 쉽게 오류를 허용 가능
- 맞춤법 및 문법 검사기가 명백한 실수를 제거하는 데 일반적으로 사용됨
- 통계적 언어 모델이 결과와 확률을 연관시켜 시스템의 초기 출력에 대한 후처리 허용
- 사용자는 완벽한 문서를 기대하지 않도록 훈련되었으며 정확성이 중요한 경우 교정
- 단어의 철자를 확인하는 것이 웹 서버 침해 보고를 검증하는 것보다 훨씬 빠름
- 현대 자동 언어 번역도 상대적으로 높은 오류율로 작동하며, 최근 진전이 인상적이지만 대략적인 번역 이상을 기대하는 사람은 없음

스팸 탐지:
- 매우 불균형한 비용 모델에 직면
- False positive(ham이 스팸으로 선언됨)는 매우 비쌀 수 있지만, false negative(스팸이 그렇게 식별되지 않음)는 큰 영향을 미치지 않음
- 이러한 불일치는 명백한 스팸을 상당히 신뢰성 있게 찾는 것을 강조하는 시스템으로 이어지는 비대칭 튜닝을 허용하지만, 지금까지 보지 못한 새로운 변형에 대해서는 덜 신뢰성을 보임
- 주로 새로운 공격을 찾는 것을 목표로 하는 이상 탐지 시스템의 경우, 새로운 변형에 대한 그러한 성능은 적절한 트레이드오프를 거의 구성하지 않음

**결론**
전반적으로 이상 탐지 시스템은 허용할 수 있는 오류 수에 대해 훨씬 더 엄격한 제한에 직면한다. 그러나 논문에서 논의하는 침입 탐지 특유의 도전과제들은 모두 오류율을 증가시키는 경향이 있다. 저자들은 이 불행한 조합을 운영 환경에서 성공 부족의 주요 원인으로 간주한다.

### 3. Challenge C: Semantic Gap

**핵심 문제**
이상 탐지 시스템은 결과를 네트워크 운영자를 위한 실행 가능한 보고서로 전환하는 데 핵심 과제에 직면한다. 많은 연구에서 이 중요한 최종 단계의 부족을 관찰하는데, 저자들은 이를 semantic gap이라고 부른다.

**평가의 한계**
침입 탐지 커뮤니티에서는 이상 탐지 시스템의 평가를 정상 프로필로부터의 편차를 신뢰성 있게 식별하는 시스템의 능력 평가로 제한하는 경향을 발견한다. 그렇게 하는 것이 건전한 연구의 중요한 요소이긴 하지만, 다음 단계는 운영자의 관점에서 결과를 해석해야 한다. 무엇을 의미하는가?

**비정상 활동 vs 공격**
이 질문에 답하는 것은 비정상 활동을 찾는 것과 공격을 찾는 것의 차이의 핵심으로 간다. 이상 탐지에 익숙한 사람들은 일반적으로 그러한 시스템이 악의적 행위를 식별하는 것을 목표로 하지 않고 양성이든 아니든 이전에 보지 못한 것을 보고할 뿐이라는 것을 가장 먼저 인정한다. 그러나 저자들은 그 지점에서 멈출 수 없다고 주장한다. 결국 침입 탐지 시스템을 배포하는 목적은 공격을 찾는 것이며, 따라서 이 간극을 메우는 것을 허용하지 않는 탐지기는 운영 기대를 충족시킬 가능성이 낮다.

**로컬 보안 정책**
의미론적 간극을 다룰 때 한 가지 고려사항은 로컬 보안 정책의 통합이다. 학술 연구에서 종종 무시되지만, 운영 네트워크에 대한 근본적인 관찰은 그들이 다른 정도이다. 많은 보안 제약은 사이트별 속성이다. 학술 환경에서 괜찮은 활동이 기업 네트워크에서 금지될 수 있으며, 단일 조직 내에서도 부서 정책이 크게 다를 수 있다.

**P2P 트래픽 사례**
예를 들어, 환경이 부적절한 콘텐츠를 배포하는 데 사용되지 않고 볼륨 측면에서 레이더 아래에 있는 한 P2P 트래픽을 허용할 수 있다. 그러한 정책의 위반을 보고하려면 이상 탐지 시스템이 특정 환경에서 무엇이 적절하거나 지나치게 큰 것으로 간주되는지에 대한 개념을 가져야 하는데, 이는 오늘날 시스템의 범위를 벗어난 결정이다. P2P 애플리케이션의 사용만 보고하는 것은 환경이 그러한 사용을 완전히 금지하지 않는 한 특별히 유용하지 않을 가능성이 높다.

**피처와 의미론의 관계**
의미론적 간극과 관련된 기본 과제는 이상 탐지 시스템이 작동하는 피처가 네트워크 환경의 의미론과 어떻게 관련되는지 이해하는 것이다. 특히 주어진 피처 선택에 대해 NIDS가 그것들로부터 개발할 수 있는 결정 종류에 근본적인 한계가 있을 것이다. P2P 예로 돌아가서, NetFlow 레코드만 검사할 때 부적절한 콘텐츠를 어떻게 발견할 수 있을지 상상하기 어렵다.

**PII 유출 사례**
또 다른 예로 개인 식별 정보(PII) 유출을 고려해보자. 많은 위협 모델에서 PII 손실은 재정적으로 직접적으로든 홍보나 정치적 여파로 인해든 주요 피해를 일으킬 가능성이 있기 때문에 상당히 높은 순위를 차지한다. 기술적 수준에서 일부 형태의 PII는 기술하기 어렵지 않다. 예를 들어, 사회 보장 번호와 은행 계좌 번호는 자동으로 확인할 수 있는 특정 방식을 따른다. 그러나 그러한 설명 없이 개발된 이상 탐지 시스템은 PII를 찾을 희망이 거의 없으며, PII와 비-PII의 예가 주어지더라도 하나를 다른 것과 정확하게 구별하는 규칙을 추출하는 데 어려움을 겪을 가능성이 높다.

### 4. Challenge D: Diversity of Network Traffic

**직관과 현실의 차이**
네트워크 트래픽은 사람들이 직관적으로 기대하는 것보다 훨씬 더 많은 다양성을 나타내며, 이는 이상 탐지 기술이 운영 환경에서 현실적으로 달성할 수 있는 것에 대한 오해로 이어진다.

**트래픽의 변동성**
단일 네트워크 내에서도 네트워크의 가장 기본적인 특성(대역폭, 연결 지속 시간, 애플리케이션 믹스 등)이 엄청난 변동성을 나타낼 수 있어 짧은 시간 간격(초에서 시간)에 걸쳐 예측 불가능하게 만든다. 강한 상관관계와 heavy-tailed 데이터 전송의 광범위한 보급은 정기적으로 대규모 활동 버스트로 이어진다. 네트워킹에서 그러한 변동성은 정기적으로 발생한다는 것을 인정하는 것이 중요하다. 이는 특이한 것을 나타내지 않는다. 그러나 이상 탐지 시스템의 경우, 그러한 변동성은 안정적인 정상성 개념을 찾기 어렵게 만들기 때문에 다루기 어려울 수 있다.

**집계를 통한 다양성 감소**
인터넷 트래픽의 다양성을 줄이는 한 가지 방법은 집계를 사용하는 것이다. 작은-중간 시간 간격에 걸쳐 매우 가변적이지만, 트래픽 속성은 더 긴 시간(시간-일, 때로는 주)에 걸쳐 관찰될 때 더 큰 안정성을 보이는 경향이 있다. 예를 들어, 대부분의 네트워크에서 시간대 및 요일 효과는 신뢰할 수 있는 패턴을 나타낸다. 오늘 점심시간 동안 트래픽 볼륨이 지난주 해당 시간대의 두 배라면, 이는 특이한 일이 발생하고 있음을 반영할 가능성이 높다.

**운영 배포의 현실**
우연이 아니게, 운영 배포에서 발견하는 이상 탐지 시스템의 한 형태는 시간당 볼륨이나 소스당 연결과 같이 고도로 집계된 정보에서 작동하는 것들이다. 반면에 이러한 시스템이 찾는 인시던트는 어쨌든 상당히 노이즈가 많으며, 종종 다른 접근법(예: 간단한 임계값 방식)으로 찾기 쉽다. 이 마지막 관찰은 종종 이상 탐지 연구 노력을 훼손할 수 있는 것의 핵심으로 간다: 더 간단한 비-머신러닝 접근법이 똑같이 잘 작동할 수 있는지 검토하지 않는 것이다.

**애플리케이션 계층의 다양성**
트래픽 다양성은 패킷 수준 피처에만 국한되지 않고 구문론적 및 의미론적 변동성 측면에서 애플리케이션 계층 정보로도 확장된다는 점을 주목한다. 구문론적으로 프로토콜 사양은 종종 의도적으로 해석의 여지를 남기며, 이기종 트래픽 스트림에서는 코너 케이스 상황이 나타날 충분한 기회가 있다. 의미론적으로 애플리케이션 프로토콜에서 파생된 피처는 네트워크 계층 패킷만큼 변동할 수 있다.

### 5. Challenge E: Difficulties with Evaluation

**평가의 중요성과 어려움**
이상 탐지 시스템의 경우 철저한 평가를 수행하는 것이 특히 중요하다. 경험상 많은 유망한 접근법이 실제로 기대에 미치지 못하는 것으로 밝혀지기 때문이다. 그렇긴 하지만 건전한 평가 방식을 고안하는 것은 쉽지 않으며, 실제로 탐지기 자체를 구축하는 것보다 더 어려운 것으로 밝혀진다. 탐지 프로세스의 불투명성으로 인해 이상 탐지 시스템의 결과는 misuse detector보다 예측하기 어렵다.

**데이터 문제**
평가가 직면하는 가장 중요한 과제는 이상 탐지 시스템 평가를 위한 적절한 공개 데이터셋의 부족이다. 다른 도메인에서는 표준화된 테스트 스위트가 있거나 적절한 말뭉치를 수집할 가능성이 있거나 둘 다 있는 경우가 많다.

자동 언어 번역: 자동화하려는 입출력 행동의 대규모 훈련 세트가 야생에서 사용 가능
스팸 탐지기: 전용 스팸 피드가 개인정보 보호 우려 없이 대규모 스팸 컬렉션 제공. 적절한 ham 컬렉션을 얻는 것은 더 어렵지만, 소수의 개인 메일 아카이브만으로도 이미 대규모 말뭉치를 생성할 수 있음
OCR: 자동으로 ground-truth를 생성하기 위한 정교한 방법이 고안됨

그러나 침입 탐지 도메인에서는 표준화된 테스트 세트도, 적절하고 쉽게 사용 가능한 데이터도 없는 경우가 많다.

**DARPA/KDD Cup 데이터셋의 문제**
과거에 표준화된 설정을 제공했던 두 가지 공개 데이터셋인 DARPA/Lincoln Labs 패킷 트레이스와 이로부터 파생된 KDD Cup 데이터셋은 현재 10년이 지났으며 현재 연구에 더 이상 적합하지 않다. DARPA 데이터셋은 1998년에 생성되고 1999년에 개선된 시뮬레이션된 Air Force 네트워크의 여러 주 동안의 네트워크 활동을 포함한다. 이 데이터는 합성일 뿐만 아니라 더 이상 현대 공격을 반영하지 못하며, 수년 동안 광범위하게 연구되어 침입 탐지 커뮤니티의 대부분 구성원은 NIDS가 이제 포함된 공격을 신뢰성 있게 탐지한다면 전혀 흥미롭지 않다고 간주한다. DARPA 데이터는 공개 직후 날카로운 비판에 직면했으며, 특히 시뮬레이션된 데이터가 NIDS 평가에 얼마나 적절할 수 있는지에 관해서였다.

**데이터 부족의 이유**
공개적으로 사용 가능한 데이터의 부족을 고려할 때, 커뮤니티에서 그러한 놀라운 격차를 발견하는 이유를 묻는 것은 당연하다. 주요 이유는 명백히 데이터의 민감한 특성에서 발생한다. 네트워크 트래픽의 검사는 기밀 또는 개인 통신, 조직의 비즈니스 비밀, 사용자의 네트워크 액세스 패턴을 포함한 매우 민감한 정보를 드러낼 수 있다. 그러한 정보의 유출은 조직 자체뿐만 아니라 영향을 받는 제3자에게도 치명적일 수 있다. 그러한 높은 위험에 직면하여 연구자들이 커뮤니티에 데이터셋을 제공하려고 시도할 때 극복할 수 없는 조직적 및 법적 장벽에 자주 직면하는 것은 이해할 만하다.

**대안적 접근법의 한계**

시뮬레이션:
- DARPA 데이터셋이 보여주듯이, 시뮬레이션으로 생성된 네트워크 트래픽은 민감성 우려가 없다는 주요 이점을 가질 수 있음
- 그러나 인터넷 트래픽은 그 자체로 이미 현실적으로 시뮬레이션하기 매우 어려움
- 새로운 공격을 찾으려는 이상 탐지 시스템을 시뮬레이션된 활동만 사용하여 평가하는 것은 종종 그럴듯한 현실성이나 관련성이 부족할 것

익명화:
- 잠재적으로 민감한 정보를 제거하거나 익명화하여 캡처된 데이터를 정리할 수도 있음
- 그러나 집중적인 노력에도 불구하고 그러한 데이터셋의 게시는 지금까지 거의 견인력을 얻지 못했으며, 대부분 정보가 여전히 유출될 수 있다는 두려움 때문으로 의심됨
- 더욱이 스크럽된 데이터셋이 사용 가능하더라도 이상 탐지 시스템과 함께 사용하는 것은 상당히 문제가 될 수 있음. 정의상 그러한 시스템은 익명화 프로세스 중에 제거되는 경향이 있는 종류의 아티팩트를 정확히 찾기 때문

**자체 데이터셋 수집의 어려움**
공개 데이터의 부족으로 인해 연구자들은 자체 데이터셋을 수집해야 한다. 그러나 일반적으로 이는 쉬운 작업이 아니다. 대부분은 적절한 크기의 네트워크에 대한 액세스가 부족하기 때문이다. 작은 실험실 네트워크에서 발견되는 활동이 NIDS가 일반적으로 배포되는 상류에서 보이는 집계 트래픽과 근본적으로 다르다는 것을 인식하는 것이 중요하다. 작은 환경을 분석하여 도출된 결론은 더 큰 규모의 설정으로 일반화될 수 없다.

**Semantic Gap의 평가 측면**
의미론적 간극은 모든 연구가 다른 도메인에서는 암묵적인 경향이 있는 명시적인 최종 단계를 수행하도록 요구한다: 시스템 사용자의 관점으로 전환하는 것. 공격을 올바르게 식별하는 것 외에도 이상 탐지 시스템은 운영자가 활동을 이해하고 그 영향을 빠르게 평가할 수 있도록 지원해야 한다. 시스템이 이전에 알려지지 않은 웹 서버 익스플로잇을 올바르게 찾지만 호스트의 HTTP 트래픽이 정상 프로필과 일치하지 않았다고만 보고한다고 가정해보자. 운영자는 시스템을 진지하게 받아들일 충분한 신뢰가 이미 있더라도 무슨 일이 일어났는지 파악하는 데 상당한 추가 노력을 소비할 것이다.

**적대적 환경**
침입 탐지 도메인 고유의 최종 특성은 그러한 시스템이 작동하는 적대적 환경에 관한 것이다. 대조적으로 OCR 시스템 사용자는 입력에서 문자를 숨기려고 하지 않을 것이며, Amazon 고객도 회사의 추천 시스템을 오도할 동기나 기회가 많지 않을 것이다. 그러나 네트워크 침입 탐지는 고전적인 군비 경쟁과 씨름해야 한다: 공격자와 방어자 각각이 상대방이 새로운 기술을 고안하는 것에 대응하여 도구를 개선한다.

이와 관련하여 한 가지 특별히 심각한 우려는 회피이다: 공격자가 탐지를 피하기 위해 활동을 조정하는 것. 회피는 모든 NIDS에 근본적으로 어려운 문제를 제기하지만, 이상 탐지는 기본 머신러닝의 특성으로 인해 추가적인 위험에 직면한다. Fogla와 Lee는 공격을 시스템의 정상 프로필과 일치하도록 변형하는 자동화된 접근법을 제시한다. 더 일반적으로 Barreno et al.은 머신러닝 시스템에 대한 공격의 분류 체계를 제시한다.

연구 관점에서 회피를 다루는 것은 탐구할 자극적인 주제이다. 이론적 근거에서 이것은 침입 탐지를 다른 도메인과 가장 명확하게 구별하는 것이다. 그러나 저자들은 실용적 관점에서 적대적 환경의 영향이 처음 믿는 것만큼 반드시 중요하지 않을 수 있다고 주장한다. 머신러닝 구현의 세부사항을 악용하는 것은 공격자 측에서 상당한 노력, 시간, 전문성을 필요로 한다. 그러나 오늘날 대부분의 공격은 의도적으로 선별된 피해자를 표적으로 삼지 않고 단순히 취약한 사이트를 무차별적으로 찾아 표적을 찾는다는 점을 고려하면, 이상 탐지기가 정교한 회피 공격의 희생양이 될 위험은 많은 환경에서 작다. 그러한 위협 모델을 가정하면, 시스템의 운영 성능에 더 심각하게 영향을 미치므로 머신러닝을 효과적으로 사용하는 데 있어 다른 많은 과제를 먼저 다루는 것이 신중해 보인다.

---

## Day 3 – Recommendations for Using Machine Learning

Section IV에서 저자들은 이상 탐지에 대한 미래 연구를 강화하는 데 도움이 될 가이드라인을 제시한다. 이러한 가이드라인은 확고한 규칙이 아닌 시금석으로 간주되며, 더 넓은 침입 탐지 커뮤니티 내에서 추가 논의의 여지가 있다.

### 핵심 권장사항

**가장 중요한 한 가지**
이상 탐지 연구의 상태를 개선하는 방법에 대해 단 하나의 권장사항만 줄 수 있다면, 그것은 시스템이 무엇을 하고 있는지 이해하라는 것이다. 침입 탐지 커뮤니티는 DARPA 데이터셋과 같은 것에 적용된 머신러닝 방식과 특정 피처 세트의 이전에 시도되지 않은 조합의 성능을 측정하는 또 다른 연구로부터 더 이상 이익을 얻지 못한다. 도메인의 특성상 특정 설정에서 다른 어떤 것보다 약간 더 잘 작동하는 변형을 항상 찾을 수 있다. 불행히도 도메인에서 한동안 일해온 사람들에게는 명백하지만, 이 사실은 신규 진입자들에게 쉽게 잊힐 수 있다. 직관적으로 동일한 데이터에서 다른 누구보다 더 나은 결과를 달성하면 이것이 분야 발전에 확실한 기여가 될 것으로 기대할 것이다. 그러나 전달하고자 하는 요점은 단순한 수치 결과보다 통찰이 훨씬 더 중요한 영역에서 작업하고 있다는 것이다.

### 1. Understanding the Threat Model

이상 탐지기 개발을 시작하기 전에 예상되는 위협 모델을 고려해야 한다. 이는 트레이드오프를 선택하는 프레임워크를 설정한다. 다루어야 할 질문들:

시스템이 목표로 하는 환경은 어떤 종류인가?
- 소규모 네트워크에서의 운영은 대규모 엔터프라이즈나 백본 네트워크와 매우 다른 도전과제에 직면
- 학술 환경은 상업 기업과 다른 요구사항 부과

놓친 공격의 비용은 얼마인가?
- 가능한 답변은 매우 적음부터 치명적까지 범위
- 사이트의 결정은 보안 요구사항과 배포된 다른 공격 탐지기에 따라 달라짐

공격자가 가질 기술과 자원은 무엇인가?
- 공격자의 명시적 타겟팅에 대한 고위험으로 간주되는 사이트는 무차별적 배경 복사 활동의 잠재적 피해자가 겪는 것보다 훨씬 더 정교한 공격을 예상해야 함

회피가 얼마나 우려되는가?
- 공격자가 방어 기법을 분석하고 우회하려는 정도가 탐지기의 견고성 요구사항을 결정

침입 탐지에는 완벽한 탐지기가 없으므로 항상 이상적이지 않은 솔루션에 만족해야 한다. 그러나 운영자는 시스템의 위협 모델이 명확하게 명시될 때만 정보에 입각한 결정을 내릴 수 있다.

### 2. Keeping The Scope Narrow

시스템이 목표로 하는 문제에 대한 명확한 그림을 갖는 것이 중요하다. 구체적으로 탐지할 공격은 무엇인가? 목표 활동을 더 좁게 정의할수록 그 특성에 맞게 탐지기를 더 잘 조정할 수 있고 오분류 가능성을 줄일 수 있다.

물론 머신러닝이 특정 탐지 작업에 적절히 일치할 것이 보장된 만능은 아니다. 따라서 보고할 활동을 식별한 후 다음 단계는 해당 작업에 적합한 도구가 무엇인지 중립적으로 평가하는 것이다. 일부 경우에는 이상 탐지기가 될 것이지만, 다른 경우에는 규칙 기반 접근법이 더 나은 가능성을 가질 수 있다. 일반적인 함정은 머신러닝 사용을 전제로(또는 더 나쁘게는 특정 머신러닝 접근법을) 시작한 다음 해결할 문제를 찾는 것이다. 저자들은 이러한 출발점이 편향되어 있어 문제에 대한 최선의 솔루션으로 거의 이어지지 않는다고 주장한다.

특정 머신러닝 알고리즘을 적절한 도구로 결정할 때, 왜 특정 선택이 의도된 설정에서 잘 수행될 것으로 예상되는지에 대한 답을 가져야 한다. 이는 순수하게 수학적 근거뿐만 아니라 도메인 특정 속성을 고려해야 한다. Duda et al.이 논의한 바와 같이, 하나의 학습 방법을 다른 것보다 선호할 맥락 독립적인 이유는 없다. 그들은 이것을 no free lunch theorem이라고 부른다.

Why 질문에 답하는 실질적인 부분은 탐지기가 작동할 피처 세트를 식별하는 것이다. 도메인 측면에서 피처의 중요성과 목표 활동을 드러내는 측면에서 피처의 능력에 대한 통찰은 신뢰할 수 있는 탐지로 이어진다. 여기서 일반적인 함정은 평가를 위해 손에 있는 데이터셋을 기반으로 피처 세트를 설정하려는 유혹이다. 그러나 피처와 관심 공격 간의 관계에 대해 확실한 논증을 할 수 없다면, 결과 연구는 심각한 결함에 빠질 위험이 있다.

**Kruegel et al.의 웹 공격 연구**
건전한 이상 탐지 연구에 필수적이라고 생각하는 사고방식의 좋은 예는 Kruegel et al.의 웹 기반 공격 연구이다. 처음부터 저자들은 매우 구체적인 공격 클래스에 초점을 맞춘다: 잘못된 쿼리 매개변수로 웹 서버를 악용하는 것. 논의는 이상 탐지의 필요성을 설득력 있게 주장한다(그러한 공격은 개념적 유사성을 공유하지만 시그니처 작성을 비실용적으로 만들 정도로 세부사항이 충분히 다름). 저자들은 양성 요청과 악성 요청의 특성을 비교하여 피처 선택을 명확하게 동기부여한다. 예를 들어, 쿼리 매개변수의 일반적인 길이는 짧은 경향이 있지만, 성공적인 버퍼 오버플로우 시도는 긴 셸코드 시퀀스와 패딩이 필요할 가능성이 높다. 이렇게 지형을 배치하는 것은 잘 근거 있는 연구를 위한 무대를 설정한다.

### 3. Reducing the Costs

Section III-B의 논의에 따르면, 이상 탐지 시스템 사용과 관련된 비용을 줄이는 것에서 엄청난 이익을 얻을 수 있다. 일화적으로 이상 탐지 시스템에 대한 가장 큰 불만은 일반적으로 보고하는 과도한 오탐 수이다. 우리가 본 바와 같이 이상 탐지 시스템이 다른 도메인에 배포된 머신러닝 시스템보다 반드시 더 많은 실수를 하는 것은 아니다. 그러나 각 오류와 관련된 높은 비용은 종종 효과적인 운영과 충돌한다. 따라서 오탐을 제한하는 것이 모든 이상 탐지 시스템의 최우선 과제여야 한다.

더 적은 실수를 향한 가장 중요한 단계는 Section IV-B에서 논의한 대로 시스템의 범위를 줄이는 것이다. 명확한 목표 없이는 어떤 이상 탐지 시스템도 탐지율을 수용 불가능하게 손상시키지 않으면서 허용 가능한 양의 오탐을 달성할 수 없다.

기본 머신러닝 문제의 설정도 오탐 수에 직접적인 영향을 미친다. Section III-A에 따라 머신러닝은 탐지 대상과 유사한 활동을 사용하여 훈련할 때 가장 잘 작동한다.

이상 탐지 시스템은 또한 네트워크 트래픽의 자연적 다양성을 처리하는 전략이 필요하다(Section III-D). 종종 적절한 시간 간격에 걸쳐 피처를 집계하거나 평균화하는 것이 도움이 되며, 위협 모델이 더 거친 세분성을 허용하는 경우이다. 또 다른 접근법은 피처의 특정 속성을 신중하게 검토하는 것이다. 일부는 다른 것보다 더 불변적일 것이다. 플로우 수준의 간단한 예로서, 특정 내부 호스트가 접촉하는 목적지 포트 세트는 일반적인 클라이언트 시스템에서 상당히 변동할 가능성이 높다. 그러나 들어오는 연결을 수락하는 포트 세트는 장기간에 걸쳐 안정적인 경우가 많다.

마지막으로 추가 정보의 지원으로 오탐을 후처리하여 오탐을 줄일 수 있다. 예를 들어, Gu et al.의 BotHunter 시스템은 통계적 페이로드 이상 탐지 엔진을 다른 도구들(Snort 시그니처, 일반적인 스캔 탐지기) 중 하나로 사용하고, 최종 단계에서 모든 출력의 상관관계를 분석한다. 마찬가지로 Anagnostakis et al.의 Shadow Honeypots는 보호된 시스템의 계측된 복사본으로 이상 탐지기의 결과를 검증한다. 자동 후처리가 불가능한 경우, 수동 검사 프로세스를 가속화하도록 설계된 추가 정보를 분석가에게 제공하여 비용을 줄일 수 있다.

### 4. Evaluation

이상 탐지 시스템을 평가할 때 주요 목표는 시스템의 능력에 대한 통찰을 개발하는 것이어야 한다. 무엇을 탐지할 수 있고 왜 그런가? 무엇을 탐지할 수 없고 왜 그런가? 얼마나 신뢰성 있게 작동하는가? 어디서 고장나는가? 저자들의 경험상 이상 탐지에 대한 학회 제출물이 실패하는 가장 큰 이유는 이러한 문제들을 적절히 탐구하지 못했기 때문이다. 평가를 데이터 작업과 결과 해석 측면에서 별도로 논의한다.

**데이터 작업**

건전한 평가를 위한 가장 중요한 단계는 작업할 적절한 데이터를 얻는 것이다. 여기서 골드 스탠다드는 가능한 한 큰 환경에서 실제 네트워크 트래픽을 포함하는 데이터셋에 대한 접근을 얻는 것이다. 이상적으로는 다른 네트워크에서 여러 개의 이러한 데이터셋을 얻는 것이다. 실제 트래픽으로 작업하면 연구가 크게 강화된다. 평가가 시스템이 실제로 얼마나 잘 작동해야 하는지를 입증할 수 있기 때문이다. 저자들의 경험상 그러한 데이터를 얻는 가장 좋은 방법은 네트워크 운영자에게 명확한 이익을 제공하는 것이다. 이상적으로는 운영 개선에 직접 도움이 되는 연구를 통해서, 또는 운영자에게 중요한 관련 없는 영역의 작업과 접근을 교환하는 방식이다.

데이터를 얻는 옵션은 설정에 따라 다르며, 탐지기를 설계할 때 초기에 잠재적 데이터 소스를 고려하는 것이 종종 도움이 된다. 예를 들어 honeypot은 민감성 우려가 (일반적으로) 없는 데이터를 제공할 수 있지만, 악성 트래픽이 양성 배경 트래픽과 어떻게 다르게 나타나는지에 대한 통찰을 제공할 수 없다. 또는 관심 데이터를 대량으로 통제하는 회사와 작업할 때, 학생이나 직원을 장기 체류를 위해 보내는 등 전략적으로 계획해야 할 수 있다. 대안적으로 mediated trace access가 실행 가능한 전략이 될 수 있다: 데이터를 실험자에게 가져오는 대신 실험을 데이터로 가져감. 즉 연구자가 분석 프로그램을 데이터 제공자에게 보내면 그들이 대신 실행하고 출력을 반환한다.

획득한 후 데이터셋의 특성에 대한 신중한 평가가 필요하다. 결과를 올바르게 해석하려면 데이터에 무엇이 포함되어 있는지뿐만 아니라 어떻게 결함이 있는지도 이해해야 한다. 완벽한 데이터셋은 없다. 종종 측정에는 결과에 영향을 줄 수 있는 아티팩트(필터링이나 의도하지 않은 손실 등)가 포함되거나, 쉽게 식별되면 안전하게 필터링할 수 있는 관련 없는 노이즈(예: 보안 부서에서 실행한 내부 취약점 스캔)가 포함된다.

이상 탐지 시스템을 평가할 때 항상 여러 데이터셋이 필요하다. 첫째, 시스템을 최종 평가에 사용되는 것과 다른 데이터로 훈련해야 한다(이것은 건전한 과학의 기본 요구사항이지만 놀랍게도 자주 간과됨. 그러나 제한된 데이터만 있을 때 적용할 수 있는 표준 기법 세트에 대해서는 Witten et al. 참조). 아마도 덜 명백하게, 학습을 통해 시스템이 다른 환경에 적응할 수 있음을 입증하려면 여러 소스의 데이터를 사용한 평가가 필요하다. Section III-E1에서 언급한 대로 DARPA와 KDD Cup 트레이스는 실행 가능한 데이터셋으로 사용할 수 없음을 강조한다. 현대 연구에서 그들의 유일한 역할은 기본 기능 테스트와 결과 교차 확인(즉, 접근법이 완전히 망가졌는지 테스트)을 위한 것이다.

세분화는 검사된 환경에서 단일 데이터셋만 있을 때도 다른 트래픽에서 훈련과 탐지를 수행하는 표준 접근법이다. 랜덤 샘플링을 통해 사용 가능한 데이터의 부분집합을 선택하여 작동한다. 세분화는 실제 연구 전에 미리 수행되면 잘 작동할 수 있다. 그러나 분할은 이상 탐지 시스템이 검사하는 피처에 대해 편향되지 않아야 한다. 예를 들어 플로우 단위로 작동하는 경우 패킷 샘플링이 아닌 플로우 샘플링을 해야 한다.

**결과 이해**

결과 해석의 가장 중요한 측면은 그 기원을 이해하는 것이다. 건전한 평가는 매우 낮은 수준에서 입력과 출력을 연관시키는 것을 자주 요구한다. 연구자는 오탐을 수동으로 검사해야 한다. 그렇게 할 때 시스템이 특정 인스턴스를 잘못 보고한 이유를 결정할 수 없다면, 이는 이상 탐지 시스템의 작동에 대한 통찰 부족을 나타낸다. 주의할 점은 그러한 오탐을 트래픽의 의미론과 연관시켜야 한다는 것이다. 탐지 로직의 수학적 용어로 프레임화하는 것은 거의 도움이 되지 않는다(활동이 거리 메트릭의 임계값을 초과했다 등). 수동으로 검사하기에 너무 많은 오탐에 직면한 경우, 랜덤 샘플링을 사용하여 직접 검사를 위한 적절한 크기의 부분집합을 선택할 수 있다.

오탐보다 조사하기 더 어려운 경우가 많다. 이전에 보지 못한 활동을 발견하려는 이상 탐지 시스템에 대해 신뢰할 수 있는 ground-truth를 얻는 것이 매우 어렵기 때문이다. 그럼에도 불구하고 그러한 평가는 스토리의 중요한 부분을 구성하며 신중한 주의를 기울일 가치가 있다. 연구 초기에 ground-truth 질문을 고려하는 것이 매우 유익할 수 있다. 평가를 위해 ground-truth를 얻는 건전한 방법을 찾을 수 없다면, 다른 점에서 확실한 기반에 있는 것처럼 보여도 작업을 추구하는 것이 의문스러워진다.

탐지기가 작동하는 방식과 관련 없는(직교하는) 메커니즘을 통해 ground-truth를 수집해야 한다. 한 가지 접근법은 입력을 레이블링하기 위해 다른 메커니즘을 사용하는 것인데, 명백한 단점은 그러한 입력이 이 다른 기법만큼만 좋을 것이라는 점이다(때로는 데이터의 부분집합을 이러한 방식으로 높은 정확도로 레이블링할 수 있다. 그렇다면 부분집합이 개발 중인 탐지기가 작동하는 방식과 독립적으로 형성된다면, 부분집합의 성능에서 더 넓은 성능으로 추정할 수 있다). 또 다른 솔루션은 수동 레이블링인데, 종종 NIDS가 작동하는 대량의 데이터로 인해 불가능하다. 최종 타협은 이상 탐지 시스템이 탐지해야 하는 종류의 대표적인 것으로 간주되는 공격 세트를 주입하는 것이다.

중요하지만 종종 간과되는 추가 고려사항은 평가에 참양성과 참음성의 검사도 포함하는 것이다. 이 필요성은 결정 프로세스의 불투명성에서 발생한다. 머신러닝에서는 시스템이 올바른 결과를 생성할 때도 시스템이 무엇을 학습했는지 명확하지 않은 경우가 많다. 이 문제의 고전적인 예시는 1980년대 Pentagon 프로젝트에서 나온다: 신경망이 사진에서 탱크를 탐지하도록 훈련되었고, 초기 평가에서 실제로 탱크가 있는 사진과 없는 사진을 올바르게 분리할 수 있었다. 그러나 밝혀진 바에 따르면 훈련과 평가에 사용된 데이터셋이 미묘한 속성을 공유했다: 탱크 사진은 흐린 날 촬영되었고, 다른 모든 사진은 푸른 하늘이었다. 나중의 교차 확인에서 밝혀진 바와 같이, 신경망은 단순히 하늘의 색을 탐지하는 법을 학습한 것이었다.

실제로 이상 탐지 결과의 기원을 이해한다는 개념을 뒤집어, 이상 탐지 시스템이 결과를 달성하는 방법에 대한 통찰을 얻는 것에서 문제 공간을 조명하는 것으로 강조를 변경할 수 있다. 즉 머신러닝은 종종 그 자체가 목적이 아니라 목적을 위한 수단을 제공하는 것으로 과소평가된다. 궁극적으로 악의적 활동을 탐지하기 위해서가 아니라, 양성 및 악성 활동의 다른 피처의 중요성을 이해하기 위해 사용하며, 이는 결국 비-머신러닝 탐지기의 기반이 된다.

예를 들어 스팸 분류를 고려해보자. Bayesian 분류기가 가장 효과적으로 사용하는 구문을 검사함으로써 메시지의 특정 부분(예: 제목 줄, Received 헤더, MIME 태그)이 불균형한 탐지 능력을 제공한다는 것을 발견할 수 있다. 이 구성된 예에서, Bayesian 기반 분석을 사용하지 않고 대신 별도의 도메인 지식을 기반으로 구축하여 그러한 구성요소를 직접 검사하는 탐지기가 도메인의 구조적 속성을 활용하여 더 효과적인 분류를 제공할 수 있다는 것을 깨달을 수 있다. 따라서 머신러닝은 때때로 그 자체가 다른 원칙에 기반한 탐지기를 개발하는 방법에 대한 길을 가리키는 데 매우 효과적으로 사용될 수 있다(이 아이디어는 주성분 분석에서 사용되는 것과 유사하며, 이는 광범위한 피처 세트 중 어떤 것이 특정 활동 클러스터에 가장 많이 기여하는지 찾는 것을 목표로 함). 이러한 접근법은 잠재적인 성능 병목 현상을 극복하는 데도 도움이 될 수 있다. 많은 머신러닝 알고리즘은 오프라인 배치 작업에 가장 적합하며, 낮은 지연 실시간 탐지를 요구하는 설정에는 덜 적합하다. 비-머신러닝 탐지기는 높은 데이터 속도에서도 스트리밍 방식으로 구현하기가 훨씬 쉬운 경우가 많다.

평가가 문헌에 있는 다른 시스템과 결과를 비교하는 방법에 관한 별도의 고려사항이 있다. 그렇게 하려면 공정한 대우를 보장하기 위한 주의가 필요하다. 이상 탐지 시스템의 성공적인 운영은 일반적으로 로컬 설정에 맞춰 튜닝되어야 하므로 특정 시스템에 대한 상당한 경험이 필요하다. 근본 목표가 대신 새로운 시스템을 이해하는 것이라면 그러한 경험을 수집하는 것이 번거로울 수 있다. 그럼에도 불구하고 첫 번째 단계로 비교 연구는 외부 시스템에 대해 문헌에 보고된 결과를 재현해야 한다.

마지막으로 모든 이상 탐지 시스템의 가장 설득력 있는 실세계 테스트는 자신의 네트워크에서 시스템을 실행하는 운영자로부터 피드백을 요청하는 것이다. 그들이 일상 업무에서 시스템이 진정으로 도움이 된다고 생각한다면, 그것은 연구에 대한 설득력 있는 지원을 제공한다.

