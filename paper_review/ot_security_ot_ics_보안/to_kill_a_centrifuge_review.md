# Research Review: To Kill a Centrifuge: A Technical Analysis of What Stuxnet's Creators Tried to Achieve
> **Analyzed Date:** 2025.12.15
> **Keywords:** Stuxnet, Cyber-Physical_Attack, ICS_Security, PLC_Exploitation, SCADA
> **Source:** The Langner Group (2013) [Full Text Link](https://www.langner.com/wp-content/uploads/2017/03/to-kill-a-centrifuge.pdf)

---

## Day 1 – Research Context and Stuxnet Overview
*(연구 배경 및 Stuxnet 개요)*

### 1. Stuxnet의 역사적 의의

#### A. 사이버 전쟁의 서막
* **정의:** Stuxnet은 역사상 최초의 사이버-물리 무기(Cyber-Physical Weapon)로 기록됩니다. 2010년 발견 이전까지 사이버 공격은 주로 데이터 탈취, 서비스 거부, 금전적 손실에 초점을 맞췄습니다.
* **패러다임 전환:** Stuxnet은 **디지털 수단으로 물리적 파괴**를 달성한 최초의 사례입니다. 이는 사이버 보안의 범위가 정보 보호를 넘어 물리적 안전까지 확장되어야 함을 입증하였습니다.

| 구분 | 기존 사이버 공격 | Stuxnet |
|------|------------------|---------|
| **목표** | 데이터, 시스템 가용성 | 물리적 장비 파괴 |
| **영향** | 정보 유출, 서비스 중단 | 원심분리기 로터 손상 |
| **대상** | IT 시스템 | 산업제어시스템(ICS) |
| **복잡성** | 단일 레이어 | IT → ICS → 물리적 레이어 |

#### B. 저자 Ralph Langner의 역할
* **기여:** Ralph Langner는 독일의 ICS 보안 전문가로, Stuxnet의 실제 공격 대상(이란 나탄즈 핵시설)을 최초로 규명하였습니다.
* **분석 범위:** 그의 분석은 단순 악성코드 역공학을 넘어 **공격 대상 플랜트의 물리적 설계, 계측 시스템, 제어 로직**까지 포괄합니다.

### 2. 공격 대상: 이란 나탄즈 핵시설

#### A. IR-1 원심분리기의 취약점
* **배경:** 이란의 우라늄 농축 프로그램은 **IR-1 원심분리기**를 사용합니다. 이 설계는 1970년대 유럽 Urenco 설계를 파키스탄 핵 밀매업자 A.Q. Khan이 유출한 것입니다.
* **핵심 취약점:**
    * **로터 취약성:** 63,000 RPM으로 회전하는 로터는 진동, 과압, 과속에 매우 민감합니다.
    * **낮은 신뢰성:** 파키스탄보다 10년 이상 긴 개발 기간에도 불구하고 지속적인 고장이 발생하였습니다.
    * **보상 설계:** 신뢰성 문제를 극복하기 위한 과도한 계측/제어 시스템이 도입되었습니다.

#### B. 캐스케이드 보호 시스템 (CPS)
* **목적:** 이란은 원심분리기의 낮은 신뢰성을 보상하기 위해 캐스케이드 보호 시스템(Cascade Protection System)을 구축하였습니다.
* **핵심 기능:**

```
┌─────────────────────────────────────────────────────────────┐
│                   Cascade Protection System                  │
├─────────────────────────────────────────────────────────────┤
│  기능 1: 개별 원심분리기 격리                                │
│  - 진동 감지 시 해당 원심분리기를 밸브로 차단                │
│  - 프로세스 중단 없이 고장 장비 교체 가능                    │
├─────────────────────────────────────────────────────────────┤
│  기능 2: 스테이지 배기 밸브                                  │
│  - 다수 원심분리기 격리 시 발생하는 과압 해소                │
│  - 압력 컨트롤러가 자동으로 배기 밸브 제어                   │
└─────────────────────────────────────────────────────────────┘
```

* **전략적 중요성:** CPS는 이란 핵 프로그램의 **핵심 기술 자산**입니다. 이것 없이는 신뢰성 낮은 IR-1으로 지속적인 우라늄 농축이 불가능합니다. Stuxnet은 바로 이 시스템을 공격하였습니다.

### 3. 사이버-물리 공격의 3단계 모델

Langner가 제시한 정교한 사이버-물리 공격의 3단계 모델은 다음과 같습니다:

```
┌─────────────────────────────────────────────────────────────┐
│                    Layer 3: Physical Layer                   │
│         밸브, 전기 드라이브 등 → 물리적 취약점 악용          │
│                         ↑ 피해 발생                          │
├─────────────────────────────────────────────────────────────┤
│           Layer 2: Industrial Control System Layer           │
│   PLC, 주파수 변환기, 압력 컨트롤러 → 프로세스 조작          │
│                         ↑ 조작                               │
├─────────────────────────────────────────────────────────────┤
│                    Layer 1: IT Layer                         │
│        네트워크, OS, IT 애플리케이션 → 전파/침투             │
└─────────────────────────────────────────────────────────────┘
```

* **핵심 통찰:** 정교한 사이버-물리 공격을 이해하려면 **세 레이어 모두**와 그 상호작용을 이해해야 합니다. IT 보안 관점만으로는 Stuxnet의 본질을 파악할 수 없습니다.

### 4. 개인 인사이트 (Personal Insight)

Day 1 분석을 통해 Stuxnet이 단순한 악성코드가 아니라 **새로운 형태의 무기**임을 이해하였습니다. 주요 통찰은 다음과 같습니다:

* **패러다임 전환:** "사이버 공격 = 데이터 유출"이라는 기존 관념이 완전히 깨졌습니다.
* **도메인 지식의 중요성:** 공격자는 IT뿐 아니라 **핵공학, 제어공학, 플랜트 설계**까지 이해해야 했습니다.
* **실무적 함의:** OT/ICS 보안 컨설팅 시, 물리적 프로세스의 취약점이 사이버 공격의 목표가 될 수 있음을 반드시 고려해야 합니다.

---


# Research Review: To Kill a Centrifuge: A Technical Analysis of What Stuxnet's Creators Tried to Achieve
> **Analyzed Date:** 2025.12.16
> **Keywords:** Overpressure_Attack, Rotor_Speed_Attack, S7-417, S7-315, MITM_ICS
> **Source:** The Langner Group (2013) [Full Text Link](https://www.langner.com/wp-content/uploads/2017/03/to-kill-a-centrifuge.pdf)

---

## Day 2 – Attack Vector Analysis
*(공격 벡터 분석)*

### 1. 두 가지 공격 루틴

Stuxnet에는 **두 가지 완전히 다른 공격 루틴**이 포함되어 있습니다. 대부분의 분석이 두 번째(로터 속도) 공격에 집중하였으나, 첫 번째(과압) 공격이 훨씬 더 복잡하고 정교합니다.

| 구분 | 과압 공격 (2007~) | 로터 속도 공격 (2009~) |
|------|-------------------|------------------------|
| **대상 컨트롤러** | Siemens S7-417 | Siemens S7-315 |
| **공격 대상** | 캐스케이드 보호 시스템 | 원심분리기 구동 시스템 |
| **복잡도** | 극도로 복잡 | 상대적으로 단순 |
| **은닉성** | 매우 높음 (MITM) | 낮음 (탐지 위험 수용) |
| **물리적 메커니즘** | 과압으로 로터 응력 증가 | 과속 및 공진 주파수 통과 |

### 2. 과압 공격 (Overpressure Attack) - S7-417

#### A. 공격 메커니즘
* **원리:** 캐스케이드의 첫 번째와 마지막 스테이지를 격리하여 UF6 가스의 유출을 차단하고, 동시에 배기 밸브를 닫아 과압을 유발합니다.

```
정상 상태:
[Feed] → [Stage 1] → [Stage 2] → ... → [Stage 15] → [Product/Tails]
          ↓            ↓                   ↓
       [배기밸브]   [배기밸브]          [배기밸브]
          ↓            ↓                   ↓
       ─────────── [Dump System] ───────────

공격 상태:
[Feed] → [Stage 1] ✗ [Stage 2] → ... → [Stage 14] ✗ [Stage 15]
         (격리)                            (격리)
          ↓ 차단       ↓ 차단               ↓ 차단
       [배기밸브]   [배기밸브]          [배기밸브]
       
→ UF6 가스 유입은 계속되나 유출 차단 → 압력 상승 → 로터 응력 증가
```

#### B. Man-in-the-Middle (MITM) 구현
Stuxnet의 가장 정교한 부분은 **제어 시스템 레벨에서의 MITM 공격**입니다:

1. **Prime (녹화):** 공격 전 21초간 정상 운영 센서 값을 캡처합니다.
2. **Replay (재생):** 공격 중 녹화된 데이터를 SCADA 화면에 반복 재생합니다.
3. **Isolate (격리):** 정상 제어 로직을 실제 입출력과 분리하여 가짜 데이터만 전달합니다.
4. **Manipulate (조작):** 압력 컨트롤러의 센서 캘리브레이션을 조작하여 배기 밸브를 비활성화합니다.

* **핵심 통찰:** 운영자는 화면에서 **완전히 정상적인 값**을 보지만, 실제로는 공격이 진행 중입니다. 이것이 무결성 공격(Integrity Attack)의 본질입니다.

#### C. 저수율(Low-Yield) 무기 설계
* **설계 의도:** Stuxnet은 **파국적 파괴를 의도적으로 회피**하였습니다.
* **전략적 목표:**
    * 원심분리기 상태를 지속적으로 모니터링하며 임계점 직전에 공격을 중단합니다.
    * 갑작스러운 대량 파괴보다 **수명 단축**을 목표로 합니다.
    * 이란 엔지니어들이 원인을 파악하지 못하게 하여 **심리적 좌절감**을 유발합니다.

---

### 3. 로터 속도 공격 (Rotor Speed Attack) - S7-315

#### A. 공격 메커니즘
* **정상 운영:** 63,000 RPM (일정)
* **공격 시퀀스:**

| 시퀀스 | 동작 | 효과 |
|--------|------|------|
| **시퀀스 1** (매월) | 63,000 → 84,600 RPM (15분) | 로터 벽 압력 증가, 재료 피로 누적 |
| **시퀀스 2** (다음 달) | 63,000 → 120 RPM → 63,000 RPM (50분) | 공진 주파수 반복 통과, 진동으로 로터 파손 |

#### B. 은닉성 감소
로터 속도 공격은 과압 공격보다 **훨씬 덜 은밀**합니다:

| 과압 공격 | 로터 속도 공격 |
|-----------|----------------|
| 센서 값 녹화/재생 | 단순히 제어 로직 일시 중단 |
| 정교한 MITM | SCADA에 정적 값 표시 |
| 탐지 거의 불가능 | 숙련 엔지니어가 진단 시 탐지 가능 |
| 청각적 변화 없음 | 164개 원심분리기 동시 감속 시 **청각적 탐지 가능** |

* **핵심 통찰:** 공격자들은 **OPSEC(작전 보안)을 의도적으로 완화**하였습니다. Langner는 이를 "탐지 위험을 수용하며 한계를 밀어붙이기(pushing the envelope)"로 해석합니다.

### 4. 캠페인 전략의 변화

#### A. 이해관계자 변화 추정

| 초기 (2007~2008) | 후기 (2009~2010) |
|------------------|------------------|
| 핵 비확산 전문가 중심 | InfoSec/사이버전 전문가 합류 |
| 극도의 은밀성 중시 | 제로데이, 도난 인증서 적극 활용 |
| 나탄즈 특화 | 자가 복제로 전 세계 전파 |
| 단일 목표 집중 | 사이버 무기 기술 실험장 |

#### B. 전략적 함의
* **핵심 분석:** Stuxnet은 **이란 핵 프로그램 지연**이라는 원래 목표를 넘어서, **사이버 무기의 실효성을 입증**하는 역사적 실험이 되었습니다.

### 5. 개인 인사이트 (Personal Insight)

Day 2 분석을 통해 Stuxnet의 **기술적 정교함**을 파악하였습니다. 주요 통찰은 다음과 같습니다:

* **두 공격의 대조:** 과압 공격의 극도의 정교함 vs 로터 속도 공격의 단순함은 캠페인 중 **전략 변화**를 시사합니다.
* **MITM의 ICS 적용:** IT 보안의 MITM 개념이 **제어시스템 레벨**에서 구현되었습니다.
* **실무적 함의:** 공격자도 은닉성과 효과 사이에서 트레이드오프에 직면합니다. 이는 방어자에게 탐지 기회가 존재함을 의미합니다.

---

# Research Review: To Kill a Centrifuge: A Technical Analysis of What Stuxnet's Creators Tried to Achieve
> **Analyzed Date:** 2025.12.17
> **Keywords:** Air_Gap_Bypass, Defense_in_Depth, IEC_62443, Supply_Chain_Attack, Contractor_Security
> **Source:** The Langner Group (2013) [Full Text Link](https://www.langner.com/wp-content/uploads/2017/03/to-kill-a-centrifuge.pdf)

---

## Day 3 – Defensive Implications and Framework Integration
*(방어적 시사점 및 프레임워크 연계)*

### 1. Stuxnet에 대한 일반적 오해

Langner는 Stuxnet에 대한 여러 **오해**를 지적합니다:

| 오해 | 실제 |
|------|------|
| "Air Gap이면 안전" | Stuxnet은 **USB와 계약업체**를 통해 Air Gap 우회 |
| "안티바이러스로 방어 가능" | 2007년 버전은 **6년간 미탐지**, 맞춤형 악성코드는 시그니처 없음 |
| "보안 패치 적용이 해결책" | ICS 레벨 취약점은 기능(Feature)이지 버그가 아님 |
| "국가 수준 자원만 가능" | 공격 **전술과 기법**은 복제 가능, 규모 확장으로 정교함 대체 가능 |
| "단일 목표 특화라 재사용 불가" | 공격 방법론은 **범용적**, 다른 목표에 적용 가능 |

### 2. 효과 없는 방어 수단

#### A. Air Gap의 한계
* **침투 경로:** 공격자는 네트워크가 아닌 **물리적 접근 권한을 가진 계약업체**를 통해 침투하였습니다.

```
[공격자] → [계약업체 노트북 감염] → [USB/물리적 접근] → [나탄즈 내부]

※ Air Gap은 네트워크 수준에서만 유효
※ 물리적 접근 권한을 가진 신뢰된 내부자(계약업체)를 통해 우회
```

#### B. 안티바이러스/IDS의 한계
* **시그니처 기반:** 알려지지 않은 맞춤형 악성코드는 탐지가 불가능합니다.
* **네트워크 모니터링:** 정상 트래픽으로 위장한 공격은 탐지가 어렵습니다.
* **행위 분석:** ICS 환경의 "정상" 행위 정의 자체가 어렵습니다.

#### C. 보안 패치의 한계
Stuxnet이 악용한 ICS 레벨 취약점들은 버그가 아닌 **정상 기능**입니다:

| 악용된 기능 | 설명 | 패치 가능 여부 |
|-------------|------|----------------|
| 드라이버 DLL 하이재킹 | Step7 소프트웨어의 정상 로딩 메커니즘 | 패치 대상 아님 |
| 입력 프로세스 이미지 조작 | PLC 메모리 쓰기 기능 | 패치 불가 |
| PROFIBUS 직접 통신 | 정상 산업 프로토콜 기능 | 패치 불가 |

### 3. 효과적인 방어 전략

#### A. 플랜트 레벨 취약점 분석
Langner가 제안하는 **사이버-물리 공격 엔지니어링 방법론의 역적용**입니다:

1. **1단계 - 물리적 취약점 식별:** HAZOP(위험/운전성 분석) 검토, 보호/안전 시스템 식별
2. **2단계 - 사이버 공격 경로 분석:** 해당 물리적 취약점을 악용할 수 있는 제어시스템 식별
3. **3단계 - 플랜트 레벨 취약점 도출:** IT → ICS → 물리적 피해의 전체 체인 문서화

#### B. 계약업체 보안 강화
Stuxnet의 침투 경로는 **계약업체**였습니다:

| 취약점 | 대응 |
|--------|------|
| 계약업체 노트북/USB | 반입 전 검사, 전용 장비 제공 |
| 물리적 접근 권한 | 최소 권한 원칙, 동반 감시 |
| 원격 접속 | VPN 터널의 세그먼테이션 |

#### C. 심층 방어 (Defense in Depth)
Purdue 모델 기반의 계층적 방어 구조입니다:

```
┌─────────────────────────────────────────────────────────────┐
│                    Level 5: Enterprise                       │
│                    (인터넷, 기업 네트워크)                   │
├─────────────────────────────────────────────────────────────┤
│                    Level 4: Business                         │
│                    (ERP, 이메일 등)                          │
├─────────────── DMZ / Firewall ──────────────────────────────┤
│                    Level 3: Operations                       │
│                    (SCADA 서버, 히스토리안)                  │
├─────────────── Industrial Firewall ─────────────────────────┤
│                    Level 2: Control                          │
│                    (HMI, Engineering Station)                │
├─────────────────────────────────────────────────────────────┤
│                    Level 1: Field Control                    │
│                    (PLC, RTU)                                │
├─────────────────────────────────────────────────────────────┤
│                    Level 0: Process                          │
│                    (센서, 액추에이터, 밸브)                  │
└─────────────────────────────────────────────────────────────┘
```

### 4. 프레임워크 연계

#### A. IEC 62443과의 연계

| IEC 62443 영역 | Stuxnet 교훈 적용 |
|----------------|-------------------|
| **62443-2-1 (보안 프로그램)** | 계약업체/공급망 보안 정책 필수 |
| **62443-3-2 (위험 평가)** | 사이버-물리 시나리오 기반 위험 평가 |
| **62443-3-3 (시스템 보안 요건)** | 영역(Zone)/도관(Conduit) 기반 네트워크 분리 |
| **62443-4-1 (제품 개발)** | 보안 기능이 아닌 보안 "기능"의 오용 방지 |

#### B. NIST SP 800-82와의 연계

| NIST 800-82 권고 | Stuxnet 관점 |
|------------------|--------------|
| 네트워크 아키텍처 | Air Gap만으로 불충분, 물리적 접근 통제 병행 |
| 침입 탐지 | 제어 레이어 이상 탐지 필요, 네트워크만으론 부족 |
| 인시던트 대응 | 제어시스템 포렌식 역량 필수 |
| 보안 인식 | 계약업체까지 확대, 사이버-물리 위협 교육 |

#### C. MITRE ATT&CK for ICS 연계

| Tactic | Technique | Stuxnet 적용 |
|--------|-----------|--------------|
| Initial Access | Replication Through Removable Media | USB를 통한 전파 |
| Execution | Execution through API | Step7 DLL 하이재킹 |
| Persistence | Module Firmware | PLC 코드 주입 |
| Evasion | Rootkit | 센서 값 위조 (MITM) |
| Impact | Manipulation of Control | 밸브/속도 조작 |
| Impact | Damage to Property | 원심분리기 로터 손상 |

### 5. 개인 인사이트 (Personal Insight)

Day 3 분석을 통해 Stuxnet이 **방어 전략에 주는 교훈**을 정리하였습니다. 주요 통찰은 다음과 같습니다:

* **Air Gap 신화의 붕괴:** 네트워크 격리만으로는 물리적 접근 경로를 차단할 수 없습니다.
* **기능이 취약점:** ICS 환경에서는 버그가 아닌 **정상 기능**이 악용될 수 있습니다.
* **실무적 함의:** OT/ICS 보안 컨설팅 시, 네트워크 분리 상태뿐 아니라 **물리적 접근 경로, 계약업체 보안, 제어 로직 무결성 검증**까지 점검해야 합니다.



